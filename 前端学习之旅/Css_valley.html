<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS冒险岛 - 前端学习游戏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0ff;
            position: relative;
            overflow-x: hidden;
        }

        /* 赛博朋克网格背景 */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(rgba(16, 1, 32, 0.7) 1px, transparent 1px),
                linear-gradient(90deg, rgba(16, 1, 32, 0.7) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(16, 1, 32, 0.85);
            border-radius: 15px;
            box-shadow: 
                0 0 20px rgba(0, 200, 255, 0.5),
                0 0 40px rgba(0, 200, 255, 0.3),
                inset 0 0 20px rgba(0, 200, 255, 0.2);
            overflow: hidden;
            border: 1px solid #00c8ff;
            position: relative;
        }

        .main-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 50%, rgba(0, 200, 255, 0.1) 50%),
                linear-gradient(transparent 50%, rgba(0, 200, 255, 0.1) 50%);
            background-size: 10px 10px;
            pointer-events: none;
            z-index: 1;
        }

        .main-header {
            background: linear-gradient(135deg, #00c8ff, #0099cc);
            color: #fff;
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #00ffaa;
            position: relative;
            overflow: hidden;
        }

        .main-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            position: relative;
            z-index: 2;
        }

        .player-stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(0, 200, 255, 0.5);
            box-shadow: 0 0 10px rgba(0, 200, 255, 0.3);
        }

        .game-navigation {
            display: flex;
            background: rgba(16, 1, 32, 0.7);
            border-bottom: 1px solid #00c8ff;
        }

        .nav-btn {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            color: #b8b8ff;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 200, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .nav-btn:hover::before {
            left: 100%;
        }

        .nav-btn:hover {
            background: rgba(0, 200, 255, 0.1);
            color: #00c8ff;
        }

        .nav-btn.active {
            background: rgba(0, 200, 255, 0.2);
            color: #00ffaa;
            border-bottom: 3px solid #00ffaa;
        }

        .game-content {
            display: none;
            padding: 20px;
            min-height: 700px;
        }

        .game-content.active {
            display: block;
        }

        /* CSS谷游戏样式 */
        .css-valley-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .css-valley-body {
                grid-template-columns: 1fr;
            }
        }

        .scene-container {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #00c8ff;
            box-shadow: 0 0 15px rgba(0, 200, 255, 0.4);
            position: relative;
            overflow: hidden;
        }

        .scene-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(0, 200, 255, 0.1) 50%, transparent 51%),
                linear-gradient(transparent 49%, rgba(0, 200, 255, 0.1) 50%, transparent 51%);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 1;
        }

        .pixel-scene {
            background: #0a0014;
            border-radius: 8px;
            padding: 15px;
            min-height: 300px;
            position: relative;
            overflow: hidden;
            border: 1px solid #00ffaa;
            box-shadow: inset 0 0 20px rgba(0, 255, 170, 0.3);
        }

        .character-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 20px;
            height: 120px;
        }

        .css-wizard {
            font-size: 60px;
            filter: drop-shadow(0 0 10px #00c8ff);
            animation: wizardFloat 4s infinite;
        }

        .css-creature {
            font-size: 50px;
            filter: drop-shadow(0 0 10px #00ffaa);
            animation: creaturePulse 3s infinite;
        }

        @keyframes wizardFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes creaturePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .pixel-art {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 2px;
            margin-bottom: 15px;
        }

        .pixel {
            width: 20px;
            height: 20px;
            background: #1a3a5f;
            border-radius: 2px;
            transition: all 0.3s;
        }

        .pixel.active {
            background: #00c8ff;
            box-shadow: 0 0 10px #00c8ff;
        }

        .layout-demo {
            background: linear-gradient(135deg, #00c8ff, #0099cc);
            width: 120px;
            height: 80px;
            margin: 10px auto;
            position: relative;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0, 200, 255, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.8em;
            text-align: center;
        }

        .task-container {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #00ffaa;
            box-shadow: 0 0 15px rgba(0, 255, 170, 0.3);
        }

        .task-title {
            color: #00ffaa;
            margin-bottom: 10px;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(0, 200, 255, 0.5);
            padding-bottom: 8px;
            text-shadow: 0 0 10px rgba(0, 255, 170, 0.7);
        }

        .task-description {
            background: rgba(26, 58, 95, 0.5);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid rgba(0, 200, 255, 0.3);
            font-size: 0.95em;
        }

        .task-steps {
            margin: 10px 0;
            padding-left: 18px;
            font-size: 0.9em;
        }

        .task-steps li {
            margin: 6px 0;
            color: #b8b8ff;
        }

        .code-editor {
            background: #0a0014;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            color: #00ffaa;
            border: 1px solid #00ffaa;
            box-shadow: 0 0 15px rgba(0, 255, 170, 0.3);
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #b8b8ff;
            font-size: 0.9em;
        }

        textarea.code-area {
            width: 100%;
            height: 400px;
            background: #050010;
            border: 1px solid #00c8ff;
            border-radius: 5px;
            padding: 15px;
            color: #00ffaa;
            font-family: 'Courier New', monospace;
            resize: vertical;
            font-size: 14px;
            line-height: 1.5;
            box-shadow: inset 0 0 10px rgba(0, 200, 255, 0.3);
        }

        .fairy-assistant {
            background: linear-gradient(135deg, #00c8ff, #0099cc);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: white;
            border: 1px solid #aaffee;
            box-shadow: 0 0 15px rgba(170, 255, 238, 0.5);
            position: relative;
            overflow: hidden;
        }

        .fairy-assistant::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.2) 0%, transparent 50%);
            pointer-events: none;
        }

        .fairy-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }

        .fairy-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #aaffee, #00c8ff);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1a3a5f;
            box-shadow: 0 0 15px #aaffee;
            font-size: 1.2em;
        }

        .help-levels {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }

        .help-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .help-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .help-btn:hover::before {
            left: 100%;
        }

        .help-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .help-btn.level-1 { 
            border-left: 3px solid #aaffaa;
            box-shadow: 0 0 10px rgba(170, 255, 170, 0.5);
        }
        .help-btn.level-2 { 
            border-left: 3px solid #ffffaa;
            box-shadow: 0 0 10px rgba(255, 255, 170, 0.5);
        }
        .help-btn.level-3 { 
            border-left: 3px solid #ffaaaa;
            box-shadow: 0 0 10px rgba(255, 170, 170, 0.5);
        }

        .fairy-response {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9em;
            display: none;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 2;
        }

        .code-snippet {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            line-height: 1.4;
            white-space: pre-wrap;
            color: #aaffee;
            border: 1px solid rgba(170, 255, 238, 0.3);
        }

        .insert-code-btn {
            background: linear-gradient(135deg, #00c8ff, #0099cc);
            color: white;
            border: none;
            border-radius: 3px;
            padding: 5px 10px;
            margin-top: 8px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0, 200, 255, 0.5);
        }

        .insert-code-btn:hover {
            background: linear-gradient(135deg, #33d6ff, #33aacc);
            box-shadow: 0 0 15px rgba(0, 200, 255, 0.8);
            transform: translateY(-2px);
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: #00c8ff;
            color: white;
            box-shadow: 0 0 15px rgba(0, 200, 255, 0.5);
        }

        .btn-success {
            background: #00ffaa;
            color: #0a0014;
            box-shadow: 0 0 15px rgba(0, 255, 170, 0.5);
        }

        .btn-warning {
            background: #ffcc00;
            color: #0a0014;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.5);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .completion-badge {
            background: linear-gradient(135deg, #00ffaa, #00cc88);
            color: #0a0014;
            padding: 10px 20px;
            border-radius: 20px;
            text-align: center;
            margin-top: 15px;
            display: none;
            animation: pulse 2s infinite;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(0, 255, 170, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 15px rgba(0, 255, 170, 0.5); }
            50% { transform: scale(1.05); box-shadow: 0 0 25px rgba(0, 255, 170, 0.8); }
            100% { transform: scale(1); box-shadow: 0 0 15px rgba(0, 255, 170, 0.5); }
        }

        .gold-coin {
            color: #ffcc00;
            font-weight: bold;
            text-shadow: 0 0 10px #ffcc00;
        }

        .feedback-message {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            display: none;
            font-weight: bold;
        }

        .feedback-success {
            background: rgba(0, 255, 170, 0.2);
            color: #00ffaa;
            border: 1px solid #00ffaa;
            box-shadow: 0 0 10px rgba(0, 255, 170, 0.3);
        }

        .feedback-error {
            background: rgba(255, 0, 0, 0.2);
            color: #ff0000;
            border: 1px solid #ff0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
        }

        .scene-content {
            color: #b8b8ff;
            text-align: center;
            padding: 20px;
        }

        .css-preview {
            background: rgba(10, 0, 20, 0.7);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            min-height: 150px;
            border: 1px solid #00c8ff;
            color: #b8b8ff;
            text-align: left;
            font-size: 0.9em;
            overflow: auto;
            box-shadow: inset 0 0 10px rgba(0, 200, 255, 0.3);
        }

        /* 霓虹文字效果 */
        .neon-text {
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 15px #00c8ff,
                0 0 20px #00c8ff,
                0 0 25px #00c8ff;
            animation: neon-flicker 2s infinite alternate;
        }

        @keyframes neon-flicker {
            0%, 18%, 22%, 25%, 53%, 57%, 100% {
                text-shadow: 
                    0 0 5px #fff,
                    0 0 10px #fff,
                    0 0 15px #00c8ff,
                    0 0 20px #00c8ff,
                    0 0 25px #00c8ff;
            }
            20%, 24%, 55% {
                text-shadow: none;
            }
        }

        /* 赛博朋克扫描线效果 */
        .scanlines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 0, 0, 0.1) 51%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 2;
        }

        .fairy-sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 10px white;
            animation: sparkle 2s infinite;
            z-index: 1;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }

        .layout-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .layout-box {
            width: 80px;
            height: 60px;
            background: rgba(0, 200, 255, 0.3);
            border: 1px solid #00c8ff;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            text-align: center;
            transition: all 0.3s;
        }

        .layout-box:hover {
            background: rgba(0, 200, 255, 0.5);
            transform: scale(1.05);
        }

        /* 选择器迷宫游戏样式 */
        .selector-maze-body {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 15px;
        }

        @media (max-width: 768px) {
            .selector-maze-body {
                grid-template-columns: 1fr;
            }
        }

        .maze-container {
            background: rgba(16, 22, 58, 0.7);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #4a6baf;
            box-shadow: 0 0 15px rgba(74, 107, 175, 0.4);
            position: relative;
            overflow: hidden;
        }

        .maze-scene {
            background: #0a1428;
            border-radius: 8px;
            padding: 15px;
            height: 650px;
            position: relative;
            overflow: hidden;
            border: 1px solid #6f9eff;
            box-shadow: inset 0 0 20px rgba(111, 158, 255, 0.3);
            display: flex;
            flex-direction: column;
        }

        .matching-area {
            display: flex;
            flex: 1;
            gap: 20px;
            height: 100%;
        }

        .spirits-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .selectors-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .spirits-column::-webkit-scrollbar,
        .selectors-column::-webkit-scrollbar {
            width: 8px;
        }

        .spirits-column::-webkit-scrollbar-track,
        .selectors-column::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .spirits-column::-webkit-scrollbar-thumb,
        .selectors-column::-webkit-scrollbar-thumb {
            background: #6f9eff;
            border-radius: 4px;
        }

        .spirit {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-height: 80px;
        }

        .spirit.correct {
            border-color: #4dff88;
            box-shadow: 0 0 15px rgba(77, 255, 136, 0.5);
            animation: pulse 1.5s infinite;
        }

        .spirit.incorrect {
            border-color: #ff4d4d;
            box-shadow: 0 0 15px rgba(255, 77, 77, 0.5);
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .spirit-icon {
            font-size: 24px;
            margin-right: 12px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
        }

        .spirit-info {
            flex: 1;
        }

        .spirit-name {
            font-weight: bold;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .spirit-code {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #b8b8ff;
            background: rgba(0, 0, 0, 0.3);
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .spirit-dropzone {
            width: 100px;
            height: 40px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 12px;
            transition: all 0.3s ease;
            font-size: 10px;
            text-align: center;
            padding: 4px;
        }

        .spirit-dropzone.hover {
            border-color: #6f9eff;
            background: rgba(111, 158, 255, 0.1);
        }

        .spirit-dropzone.correct {
            border-color: #4dff88;
            background: rgba(77, 255, 136, 0.1);
        }

        .selector-card {
            padding: 12px;
            background: rgba(42, 58, 114, 0.5);
            border-radius: 8px;
            border: 2px solid rgba(111, 158, 255, 0.5);
            cursor: grab;
            transition: all 0.3s ease;
            user-select: none;
            min-height: 70px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .selector-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .selector-card:active {
            cursor: grabbing;
        }

        .selector-card.dragging {
            opacity: 0.7;
            transform: scale(1.03);
        }

        .selector-name {
            font-weight: bold;
            margin-bottom: 4px;
            color: #6f9eff;
            font-size: 12px;
        }

        .selector-code {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            background: rgba(0, 0, 0, 0.3);
            padding: 6px 10px;
            border-radius: 4px;
            display: inline-block;
        }

        .selector-task-container {
            background: rgba(16, 22, 58, 0.7);
            border-radius: 10px;
            padding: 15px;
            border-left: 5px solid #6f9eff;
            box-shadow: 0 0 15px rgba(111, 158, 255, 0.3);
            display: flex;
            flex-direction: column;
        }

        .selector-task-title {
            color: #6f9eff;
            margin-bottom: 8px;
            font-size: 1.2em;
            border-bottom: 2px solid rgba(111, 158, 255, 0.5);
            padding-bottom: 6px;
            text-shadow: 0 0 10px rgba(111, 158, 255, 0.7);
        }

        .target-styles {
            background: rgba(42, 58, 114, 0.5);
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #6f9eff;
            flex: 1;
            overflow-y: auto;
        }

        .target-item {
            display: flex;
            align-items: center;
            margin: 6px 0;
            padding: 6px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            font-size: 12px;
        }

        .target-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 8px;
            flex-shrink: 0;
        }

        .target-color.red {
            background: #ff4d4d;
            box-shadow: 0 0 8px #ff4d4d;
        }

        .target-color.blue {
            background: #4d79ff;
            box-shadow: 0 0 8px #4d79ff;
        }

        .target-color.green {
            background: #4dff88;
            box-shadow: 0 0 8px #4dff88;
        }

        .target-color.orange {
            background: #ffa64d;
            box-shadow: 0 0 8px #ffa64d;
        }

        .target-color.purple {
            background: #b84dff;
            box-shadow: 0 0 8px #b84dff;
        }

        .selector-controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }

        .selector-completion-badge {
            background: linear-gradient(135deg, #4dff88, #00cc66);
            color: #0a1428;
            padding: 8px 15px;
            border-radius: 15px;
            text-align: center;
            margin-top: 10px;
            display: none;
            animation: pulse 2s infinite;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(77, 255, 136, 0.5);
            font-size: 12px;
        }

        .selector-feedback-message {
            padding: 8px;
            border-radius: 4px;
            margin: 8px 0;
            text-align: center;
            display: none;
            font-weight: bold;
            font-size: 12px;
        }

        .selector-feedback-success {
            background: rgba(77, 255, 136, 0.2);
            color: #4dff88;
            border: 1px solid #4dff88;
            box-shadow: 0 0 8px rgba(77, 255, 136, 0.3);
        }

        .selector-feedback-error {
            background: rgba(255, 77, 77, 0.2);
            color: #ff4d4d;
            border: 1px solid #ff4d4d;
            box-shadow: 0 0 8px rgba(255, 77, 77, 0.3);
        }

        .hint-panel {
            background: rgba(42, 58, 114, 0.5);
            border-radius: 6px;
            padding: 8px;
            margin: 8px 0;
            border: 1px solid #6f9eff;
            text-align: center;
        }

        .hint-panel .hint-text {
            color: #b8b8ff;
            font-size: 11px;
        }

        .selector-info {
            background: rgba(42, 58, 114, 0.5);
            border-radius: 6px;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #6f9eff;
            flex: 1;
            overflow-y: auto;
        }

        .selector-info h3 {
            color: #6f9eff;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .selector-info ul {
            padding-left: 15px;
        }

        .selector-info li {
            margin: 4px 0;
            color: #b8b8ff;
            font-size: 11px;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4d79ff, #6f9eff);
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .match-feedback {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 8px 15px;
            border-radius: 15px;
            font-weight: bold;
            z-index: 10;
            display: none;
            animation: floatUp 1.5s ease;
            font-size: 12px;
        }

        @keyframes floatUp {
            0% { opacity: 0; transform: translate(-50%, -30%); }
            50% { opacity: 1; transform: translate(-50%, -50%); }
            100% { opacity: 0; transform: translate(-50%, -70%); }
        }

        .match-success {
            background: rgba(77, 255, 136, 0.9);
            color: #0a1428;
            box-shadow: 0 0 12px rgba(77, 255, 136, 0.7);
        }

        .match-error {
            background: rgba(255, 77, 77, 0.9);
            color: white;
            box-shadow: 0 0 12px rgba(255, 77, 77, 0.7);
        }

        .level-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(111, 158, 255, 0.3);
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: bold;
            border: 1px solid #6f9eff;
            box-shadow: 0 0 8px #6f9eff;
            font-size: 12px;
        }

        .section-title {
            color: #6f9eff;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: bold;
        }

        /* 验证模块样式 */
        .validation-temple-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .validation-temple-body {
                grid-template-columns: 1fr;
            }
        }

        .temple-scene {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #ff6b6b;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.4);
            position: relative;
            overflow: hidden;
        }

        .temple-scene::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(255, 107, 107, 0.1) 50%, transparent 51%),
                linear-gradient(transparent 49%, rgba(255, 107, 107, 0.1) 50%, transparent 51%);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 1;
        }

        .temple-interior {
            background: #0a0014;
            border-radius: 8px;
            padding: 15px;
            min-height: 300px;
            position: relative;
            overflow: hidden;
            border: 1px solid #ff6b6b;
            box-shadow: inset 0 0 20px rgba(255, 107, 107, 0.3);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }

        .temple-guardian {
            font-size: 80px;
            filter: drop-shadow(0 0 10px #ff6b6b);
            animation: guardianFloat 4s infinite;
            margin-bottom: 20px;
        }

        @keyframes guardianFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(5deg); }
            75% { transform: translateY(5px) rotate(-5deg); }
        }

        .temple-content {
            color: #b8b8ff;
            text-align: center;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .temple-task-container {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #ff6b6b;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.3);
        }

        .temple-task-title {
            color: #ff6b6b;
            margin-bottom: 10px;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(255, 107, 107, 0.5);
            padding-bottom: 8px;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.7);
        }

        /* 验证面板样式 */
        .validation-panel {
            background: rgba(26, 58, 95, 0.5);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 107, 107, 0.3);
        }

        .validation-panel h3 {
            color: #ff6b6b;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .validation-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .validation-tab {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 5px;
            color: #b8b8ff;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .validation-tab:hover {
            background: rgba(255, 107, 107, 0.1);
        }

        .validation-tab.active {
            background: rgba(255, 107, 107, 0.2);
            border-color: #ff6b6b;
            color: #ff6b6b;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }

        .validation-content {
            display: none;
        }

        .validation-content.active {
            display: block;
        }

        .validation-checklist {
            list-style: none;
            margin: 10px 0;
        }

        .validation-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            padding: 8px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.05);
            transition: all 0.3s;
        }

        .validation-item:hover {
            background: rgba(255, 107, 107, 0.1);
        }

        .validation-item input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            accent-color: #ff6b6b;
        }

        .validation-item label {
            flex: 1;
            color: #b8b8ff;
            font-size: 0.95em;
        }

        .validation-item.completed label {
            color: #4dff88;
            text-decoration: line-through;
        }

        .validation-fairy {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: white;
            border: 1px solid #ffcccc;
            box-shadow: 0 0 15px rgba(255, 204, 204, 0.5);
            position: relative;
            overflow: hidden;
        }

        .validation-fairy::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.2) 0%, transparent 50%);
            pointer-events: none;
        }

        .validation-fairy-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }

        .validation-fairy-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ffcccc, #ff6b6b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1a3a5f;
            box-shadow: 0 0 15px #ffcccc;
            font-size: 1.2em;
        }

        .validation-help-levels {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin: 10px 0;
        }

        .validation-help-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .validation-help-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .validation-help-btn:hover::before {
            left: 100%;
        }

        .validation-help-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateX(5px);
        }

        .validation-help-btn.level-1 { 
            border-left: 3px solid #aaffaa;
            box-shadow: 0 0 10px rgba(170, 255, 170, 0.5);
        }
        .validation-help-btn.level-2 { 
            border-left: 3px solid #ffffaa;
            box-shadow: 0 0 10px rgba(255, 255, 170, 0.5);
        }
        .validation-help-btn.level-3 { 
            border-left: 3px solid #ffaaaa;
            box-shadow: 0 0 10px rgba(255, 170, 170, 0.5);
        }

        .validation-fairy-response {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9em;
            display: none;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 2;
        }

        .validation-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .validation-completion-badge {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: #0a0014;
            padding: 10px 20px;
            border-radius: 20px;
            text-align: center;
            margin-top: 15px;
            display: none;
            animation: pulse 2s infinite;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
        }

        .validation-feedback-message {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            display: none;
            font-weight: bold;
        }

        .validation-feedback-success {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
            border: 1px solid #ff6b6b;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
        }

        .validation-feedback-error {
            background: rgba(255, 0, 0, 0.2);
            color: #ff0000;
            border: 1px solid #ff0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
        }

        /* 新手引导样式 */
        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            display: none;
        }

        .tutorial-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(16, 1, 32, 0.95);
            border-radius: 15px;
            padding: 25px;
            max-width: 500px;
            width: 90%;
            border: 2px solid #00c8ff;
            box-shadow: 0 0 30px rgba(0, 200, 255, 0.7);
            z-index: 1001;
            display: none;
        }

        .tutorial-title {
            color: #00ffaa;
            margin-bottom: 15px;
            font-size: 1.5em;
            text-align: center;
            text-shadow: 0 0 10px #00ffaa;
        }

        .tutorial-content {
            color: #b8b8ff;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .tutorial-highlight {
            position: absolute;
            border: 2px solid #00ffaa;
            border-radius: 8px;
            box-shadow: 0 0 20px #00ffaa;
            z-index: 999;
            pointer-events: none;
            animation: highlightPulse 2s infinite;
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 20px #00ffaa; }
            50% { box-shadow: 0 0 30px #00ffaa; }
            100% { box-shadow: 0 0 20px #00ffaa; }
        }

        .tutorial-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .tutorial-progress {
            color: #b8b8ff;
            font-size: 0.9em;
        }

        .tutorial-skip {
            background: transparent;
            border: 1px solid #ff6b6b;
            color: #ff6b6b;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tutorial-skip:hover {
            background: rgba(255, 107, 107, 0.1);
        }

        .tutorial-next {
            background: #00c8ff;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 0 10px rgba(0, 200, 255, 0.5);
        }

        .tutorial-next:hover {
            background: #33d6ff;
            box-shadow: 0 0 15px rgba(0, 200, 255, 0.8);
        }

        .next-game-btn {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
            margin-top: 15px;
            display: inline-block;
        }

        .next-game-btn:hover {
            background: linear-gradient(135deg, #ff8e8e, #ff6b6b);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.8);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- 新手引导 -->
    <div class="tutorial-overlay" id="tutorial-overlay"></div>
    <div class="tutorial-popup" id="tutorial-popup">
        <h2 class="tutorial-title" id="tutorial-title">欢迎来到CSS冒险岛！</h2>
        <div class="tutorial-content" id="tutorial-content">
            在这里，你将学习CSS知识，解决各种有趣的挑战！
        </div>
        <div class="tutorial-navigation">
            <button class="tutorial-skip" id="tutorial-skip">跳过引导</button>
            <div class="tutorial-progress" id="tutorial-progress">1/6</div>
            <button class="tutorial-next" id="tutorial-next">下一步</button>
        </div>
    </div>
    <div class="tutorial-highlight" id="tutorial-highlight"></div>

    <div class="main-container">
        <div class="scanlines"></div>
        <div class="main-header">
            <div class="header-content">
                <h1 class="neon-text">🏞️ CSS冒险岛</h1>
                <div class="player-stats">
                    <div class="stat">游戏: <span id="current-game">CSS谷</span></div>
                    <div class="stat">金币: <span class="gold-coin" id="gold-count">10</span> 🪙</div>
                    <div class="stat">进度: <span id="progress">0%</span></div>
                </div>
            </div>
        </div>

        <div class="game-navigation">
            <button class="nav-btn active" data-game="css-valley">🏞️ CSS谷</button>
            <button class="nav-btn" data-game="selector-maze">🌲 选择器迷宫</button>
            <button class="nav-btn" data-game="validation-temple">🏛️ 验证神殿</button>
        </div>

        <!-- CSS谷游戏 -->
        <div class="game-content active" id="css-valley">
            <div class="css-valley-body">
                <!-- 左侧：游戏场景 -->
                <div class="scene-container">
                    <h2>🖼️ 布局预览</h2>
                    <div class="pixel-scene">
                        <div class="character-container">
                            <div class="css-wizard">🧙‍♂️</div>
                            <div class="css-creature">🐙</div>
                        </div>
                        <div class="pixel-art">
                            <div class="pixel"></div><div class="pixel"></div><div class="pixel active"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div>
                        </div>
                        <div class="layout-demo">Flex布局演示</div>
                        <div class="scene-content">
                            <h3>欢迎来到CSS谷！</h3>
                            <p>CSS魔法出现了混乱！使用CSS布局修复样式问题...</p>
                        </div>
                        <div class="layout-preview">
                            <div class="layout-box">Box 1</div>
                            <div class="layout-box">Box 2</div>
                            <div class="layout-box">Box 3</div>
                            <div class="layout-box">Box 4</div>
                        </div>
                        <div class="css-preview" id="css-preview">
                            <!-- CSS预览将在这里显示 -->
                        </div>
                    </div>
                </div>

                <!-- 右侧：任务和代码编辑 -->
                <div class="task-container">
                    <h2 class="task-title">📝 任务目标</h2>
                    <div class="task-description">
                        <p>CSS谷的样式系统出现了混乱！请使用CSS修复以下布局问题：</p>
                        <ul class="task-steps">
                            <li>使用Flexbox创建导航栏布局</li>
                            <li>实现卡片组件的等分布局</li>
                            <li>添加响应式设计（移动端适配）</li>
                            <li>创建交互动画效果</li>
                            <li>确保色彩搭配协调</li>
                        </ul>
                    </div>

                    <div class="code-editor">
                        <div class="editor-header">
                            <span>🎨 style.css</span>
                            <span>CSS样式</span>
                        </div>
                        <textarea class="code-area" id="css-code" placeholder="在这里编写你的CSS代码...">
/* CSS谷样式挑战 */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* 导航栏样式 - 使用Flexbox布局 */
.navbar {
    /* 在这里添加Flexbox样式 */
}

.nav-links {
    /* 导航链接样式 */
}

.nav-links a {
    /* 链接样式 */
}

/* 卡片布局 */
.cards {
    /* 卡片容器布局 */
}

.card {
    /* 单个卡片样式 */
}

.card:hover {
    /* 卡片悬停效果 */
}

/* 响应式设计 */
@media (max-width: 768px) {
    /* 移动端样式 */
}</textarea>
                    </div>

                    <div class="fairy-assistant">
                        <div class="fairy-header">
                            <div class="fairy-avatar">🧚‍♀️</div>
                            <h3>仙女下凡</h3>
                        </div>
                        <p>🧚‍♀️ 遇到困难吗？请你支付金币给我</p>
                        <div class="help-levels">
                            <button class="help-btn level-1" onclick="getHelp(1)">
                                💡 线索提示 (1🪙)
                            </button>
                            <button class="help-btn level-2" onclick="getHelp(2)">
                                🎯 思路指导 (2🪙)
                            </button>
                            <button class="help-btn level-3" onclick="getHelp(3)">
                                🔧 完整代码 (3🪙)
                            </button>
                        </div>
                        <div class="fairy-response" id="fairy-response">
                            <!-- 仙女回复内容 -->
                        </div>
                    </div>

                    <div class="controls">
                        <button class="btn btn-warning" onclick="resetCode()">🔄 重置代码</button>
                        <button class="btn btn-primary" onclick="testCode()">🧪 测试代码</button>
                        <button class="btn btn-success" onclick="submitCode()">🚀 提交关卡</button>
                    </div>

                    <div class="completion-badge" id="completion-badge">
                        ✅ 样式修复完成！准备前往下一关...
                    </div>
                </div>
            </div>
        </div>

        <!-- 选择器迷宫游戏 -->
        <div class="game-content" id="selector-maze">
            <div class="selector-maze-body">
                <!-- 左侧：匹配区域 -->
                <div class="maze-container">
                    <h2>🌲 HTML森林迷宫</h2>
                    <div class="maze-scene">
                        <div class="level-indicator">关卡 <span id="level-display">1</span></div>
                        <div class="matching-area">
                            <div class="spirits-column">
                                <div class="section-title">标签精灵 (5个)</div>
                                <div class="spirit-container" id="spirit-container">
                                    <!-- 精灵将通过JavaScript动态生成 -->
                                </div>
                            </div>
                            <div class="selectors-column">
                                <div class="section-title">选择器卡片</div>
                                <div class="selector-cards" id="selector-cards">
                                    <!-- 选择器卡片将通过JavaScript动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右侧：任务和说明 -->
                <div class="selector-task-container">
                    <h2 class="selector-task-title">🎯 任务目标</h2>
                    <div class="task-description">
                        <p style="font-size: 12px; margin-bottom: 8px;">将正确的选择器拖到对应的标签精灵上</p>
                        
                        <div class="target-styles" id="target-styles">
                            <!-- 目标样式将通过JavaScript动态生成 -->
                        </div>

                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                    </div>

                    <div class="hint-panel">
                        <div class="hint-text" id="current-hint">观察精灵的HTML代码，选择正确的选择器</div>
                    </div>

                    <div class="selector-info">
                        <h3>📚 选择器知识</h3>
                        <ul>
                            <li><strong>元素选择器</strong>：p { } - 选择所有 &lt;p&gt; 元素</li>
                            <li><strong>类选择器</strong>：.active { } - 选择所有 class="active" 的元素</li>
                            <li><strong>ID选择器</strong>：#logo { } - 选择 id="logo" 的元素</li>
                            <li><strong>属性选择器</strong>：[type="text"] { } - 选择具有特定属性的元素</li>
                            <li><strong>伪类选择器</strong>：:hover { } - 选择特定状态的元素</li>
                        </ul>
                    </div>

                    <div class="selector-controls">
                        <button class="btn btn-warning" onclick="resetSelectorGame()">🔄 重置</button>
                        <button class="btn btn-primary" onclick="nextSelectorLevel()">➡️ 下一关</button>
                        <button class="btn btn-success" onclick="checkAllSelectorMatches()">✅ 检查</button>
                    </div>

                    <div class="selector-completion-badge" id="selector-completion-badge">
                        ✅ 恭喜！获得"选择器捕网"道具！
                    </div>

                    <div class="selector-feedback-message" id="selector-feedback-message">
                        <!-- 反馈消息将在这里显示 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 验证神殿游戏 -->
        <div class="game-content" id="validation-temple">
            <div class="validation-temple-body">
                <!-- 左侧：游戏场景 -->
                <div class="temple-scene">
                    <h2>🏛️ 验证神殿</h2>
                    <div class="temple-interior">
                        <div class="temple-guardian">🗿</div>
                        <div class="temple-content">
                            <h3>知识验证中心</h3>
                            <p>在这里，你将验证在CSS谷和选择器迷宫中学到的知识</p>
                            <p>证明你已经掌握了关键的CSS概念！</p>
                            <div class="progress-bar" style="margin: 15px 0;">
                                <div class="progress-fill" id="validation-progress-fill" style="background: linear-gradient(90deg, #ff6b6b, #ff8e8e);"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                                <div>关注: <span id="validation-focus">1/3</span></div>
                                <div>金币: <span class="gold-coin">10</span> 🪙</div>
                                <div>进度: <span id="validation-progress">0%</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右侧：验证面板 -->
                <div class="temple-task-container">
                    <h2 class="temple-task-title">📝 知识验证</h2>
                    
                    <div class="validation-tabs">
                        <div class="validation-tab active" data-tab="css-valley-validation">CSS谷验证</div>
                        <div class="validation-tab" data-tab="selector-maze-validation">选择器迷宫验证</div>
                    </div>

                    <!-- CSS谷验证内容 -->
                    <div class="validation-content active" id="css-valley-validation">
                        <div class="validation-panel">
                            <h3>CSS布局知识验证</h3>
                            <p>验证你在CSS谷中学到的布局知识</p>
                            
                            <ul class="validation-checklist" id="css-valley-checklist">
                                <li class="validation-item">
                                    <input type="checkbox" id="css-check1">
                                    <label for="css-check1">Flexbox布局：理解display: flex的使用</label>
                                </li>
                                <li class="validation-item">
                                    <input type="checkbox" id="css-check2">
                                    <label for="css-check2">响应式设计：掌握@media查询的使用</label>
                                </li>
                                <li class="validation-item">
                                    <input type="checkbox" id="css-check3">
                                    <label for="css-check3">CSS动画：理解transition和transform</label>
                                </li>
                                <li class="validation-item">
                                    <input type="checkbox" id="css-check4">
                                    <label for="css-check4">布局属性：掌握justify-content和align-items</label>
                                </li>
                                <li class="validation-item">
                                    <input type="checkbox" id="css-check5">
                                    <label for="css-check5">盒子模型：理解margin、padding和border</label>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- 选择器迷宫验证内容 -->
                    <div class="validation-content" id="selector-maze-validation">
                        <div class="validation-panel">
                            <h3>CSS选择器知识验证</h3>
                            <p>验证你在选择器迷宫中学到的选择器知识</p>
                            
                            <ul class="validation-checklist" id="selector-maze-checklist">
                                <li class="validation-item">
                                    <input type="checkbox" id="selector-check1">
                                    <label for="selector-check1">元素选择器：理解p、div等基本选择器</label>
                                </li>
                                <li class="validation-item">
                                    <input type="checkbox" id="selector-check2">
                                    <label for="selector-check2">类选择器：掌握.classname的使用</label>
                                </li>
                                <li class="validation-item">
                                    <input type="checkbox" id="selector-check3">
                                    <label for="selector-check3">ID选择器：理解#idname的使用</label>
                                </li>
                                <li class="validation-item">
                                    <input type="checkbox" id="selector-check4">
                                    <label for="selector-check4">属性选择器：掌握[attribute=value]的使用</label>
                                </li>
                                <li class="validation-item">
                                    <input type="checkbox" id="selector-check5">
                                    <label for="selector-check5">伪类选择器：理解:hover、:first-child等</label>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="validation-fairy">
                        <div class="validation-fairy-header">
                            <div class="validation-fairy-avatar">🧚‍♀️</div>
                            <h3>仙女下凡</h3>
                        </div>
                        <p>🧚‍♀️ 遇到困难吗？请你支付金币给我</p>
                        <div class="validation-help-levels">
                            <button class="validation-help-btn level-1" onclick="getValidationHelp(1)">
                                <span>💡 线索提示</span>
                                <span>(1🪙)</span>
                            </button>
                            <button class="validation-help-btn level-2" onclick="getValidationHelp(2)">
                                <span>🎯 思路指导</span>
                                <span>(2🪙)</span>
                            </button>
                            <button class="validation-help-btn level-3" onclick="getValidationHelp(3)">
                                <span>🔧 完整代码</span>
                                <span>(3🪙)</span>
                            </button>
                        </div>
                        <div class="validation-fairy-response" id="validation-fairy-response">
                            <!-- 仙女回复内容 -->
                        </div>
                    </div>

                    <div class="validation-controls">
                        <button class="btn btn-warning" onclick="resetValidationGame()">🔄 重置验证</button>
                        <button class="btn btn-primary" onclick="runValidation()">🧪 运行验证</button>
                        <button class="btn btn-success" onclick="completeValidation()">✅ 完成验证</button>
                    </div>

                    <div class="validation-completion-badge" id="validation-completion-badge">
                        ✅ 验证完成！恭喜你掌握了CSS核心知识！
                    </div>

                    <div class="validation-feedback-message" id="validation-feedback-message">
                        <!-- 反馈消息将在这里显示 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全局游戏状态
        const globalState = {
            goldCoins: 10,
            currentGame: 'css-valley',
            cssValleyProgress: 0,
            selectorMazeProgress: 0,
            validationTempleProgress: 0,
            tutorialCompleted: false
        };

        // CSS谷游戏状态
        const cssValleyState = {
            progress: 0
        };

        // 选择器迷宫游戏状态
        const selectorMazeState = {
            matchedSpirits: 0,
            totalSpirits: 5,
            score: 0,
            currentLevel: 1,
            maxLevels: 5,
            spiritMatches: {},
            currentSpirits: [],
            currentSelectors: []
        };

        // 验证神殿游戏状态
        const validationTempleState = {
            completedChecks: 0,
            totalChecks: 10,
            focus: "1/3",
            progress: 0,
            currentTab: 'css-valley-validation'
        };

        // 新手引导状态
        const tutorialState = {
            currentStep: 0,
            totalSteps: 6,
            steps: [
                {
                    title: "欢迎来到CSS冒险岛！",
                    content: "在这里，你将学习CSS知识，解决各种有趣的挑战！准备好开始冒险了吗？",
                    highlight: null
                },
                {
                    title: "游戏界面介绍",
                    content: "这是游戏的主界面，你可以看到金币数量、游戏进度和当前游戏模块。",
                    highlight: ".player-stats"
                },
                {
                    title: "CSS谷 - 布局学习",
                    content: "在CSS谷中，你将学习如何使用CSS创建响应式布局，包括Flexbox和Grid布局。",
                    highlight: ".nav-btn[data-game='css-valley']"
                },
                {
                    title: "选择器迷宫 - CSS选择器",
                    content: "在选择器迷宫中，你将学习不同类型的CSS选择器，以及如何正确使用它们。",
                    highlight: ".nav-btn[data-game='selector-maze']"
                },
                {
                    title: "验证神殿 - 知识验证",
                    content: "在验证神殿中，你可以验证在CSS谷和选择器迷宫中学到的知识，确保你已经掌握了关键概念。",
                    highlight: ".nav-btn[data-game='validation-temple']"
                },
                {
                    title: "仙女帮助系统",
                    content: "遇到困难时，可以使用仙女帮助系统。但请注意，帮助需要消耗金币！",
                    highlight: ".fairy-assistant"
                }
            ]
        };

        // 所有可能的选择器和精灵类型
        const allSelectors = [
            { type: 'element', code: 'p', name: '元素选择器', color: '#ff4d4d' },
            { type: 'element', code: 'h1', name: '元素选择器', color: '#ff4d4d' },
            { type: 'element', code: 'div', name: '元素选择器', color: '#ff4d4d' },
            { type: 'element', code: 'span', name: '元素选择器', color: '#ff4d4d' },
            { type: 'element', code: 'a', name: '元素选择器', color: '#ff4d4d' },
            { type: 'class', code: '.active', name: '类选择器', color: '#4d79ff' },
            { type: 'class', code: '.container', name: '类选择器', color: '#4d79ff' },
            { type: 'class', code: '.button', name: '类选择器', color: '#4d79ff' },
            { type: 'id', code: '#logo', name: 'ID选择器', color: '#4dff88' },
            { type: 'id', code: '#main', name: 'ID选择器', color: '#4dff88' },
            { type: 'attribute', code: '[type="text"]', name: '属性选择器', color: '#ffa64d' },
            { type: 'attribute', code: '[href="#"]', name: '属性选择器', color: '#ffa64d' },
            { type: 'pseudo', code: ':hover', name: '伪类选择器', color: '#b84dff' },
            { type: 'pseudo', code: ':first-child', name: '伪类选择器', color: '#b84dff' }
        ];

        const allSpirits = [
            { type: 'element', name: '&lt;p&gt;标签精灵', code: '&lt;p&gt;文本内容&lt;/p&gt;', icon: '📄', selector: 'p' },
            { type: 'element', name: '&lt;h1&gt;标签精灵', code: '&lt;h1&gt;标题&lt;/h1&gt;', icon: '🔤', selector: 'h1' },
            { type: 'element', name: '&lt;div&gt;标签精灵', code: '&lt;div&gt;区块&lt;/div&gt;', icon: '📦', selector: 'div' },
            { type: 'element', name: '&lt;span&gt;标签精灵', code: '&lt;span&gt;内联&lt;/span&gt;', icon: '🔗', selector: 'span' },
            { type: 'element', name: '&lt;a&gt;标签精灵', code: '&lt;a href="#"&gt;链接&lt;/a&gt;', icon: '🔗', selector: 'a' },
            { type: 'class', name: '.active类精灵', code: '&lt;div class="active"&gt;区块&lt;/div&gt;', icon: '🔷', selector: '.active' },
            { type: 'class', name: '.container类精灵', code: '&lt;div class="container"&gt;容器&lt;/div&gt;', icon: '📦', selector: '.container' },
            { type: 'class', name: '.button类精灵', code: '&lt;button class="button"&gt;按钮&lt;/button&gt;', icon: '🔘', selector: '.button' },
            { type: 'id', name: '#logo ID精灵', code: '&lt;img id="logo" src="..."&gt;', icon: '🆔', selector: '#logo' },
            { type: 'id', name: '#main ID精灵', code: '&lt;main id="main"&gt;主体&lt;/main&gt;', icon: '📄', selector: '#main' },
            { type: 'attribute', name: '[type="text"]精灵', code: '&lt;input type="text"&gt;', icon: '⌨️', selector: '[type="text"]' },
            { type: 'attribute', name: '[href="#"]精灵', code: '&lt;a href="#"&gt;链接&lt;/a&gt;', icon: '🔗', selector: '[href="#"]' },
            { type: 'pseudo', name: ':hover状态精灵', code: '&lt;button&gt;悬停按钮&lt;/button&gt;', icon: '🖱️', selector: ':hover' },
            { type: 'pseudo', name: ':first-child精灵', code: '&lt;li&gt;第一个子项&lt;/li&gt;', icon: '1️⃣', selector: ':first-child' }
        ];

        // 导航切换
        function setupNavigation() {
            const navButtons = document.querySelectorAll('.nav-btn');
            const gameContents = document.querySelectorAll('.game-content');
            
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const gameId = button.dataset.game;
                    
                    // 更新按钮状态
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // 更新游戏内容显示
                    gameContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(gameId).classList.add('active');
                    
                    // 更新全局状态
                    globalState.currentGame = gameId;
                    updateGlobalUI();
                    
                    // 更新当前游戏显示
                    document.getElementById('current-game').textContent = 
                        gameId === 'css-valley' ? 'CSS谷' : 
                        gameId === 'selector-maze' ? '选择器迷宫' : '验证神殿';
                        
                    // 如果切换到选择器迷宫，确保游戏已初始化
                    if (gameId === 'selector-maze') {
                        initSelectorGame();
                    }
                    // 如果切换到验证神殿，确保游戏已初始化
                    else if (gameId === 'validation-temple') {
                        initValidationGame();
                    }
                });
            });
        }

        // 更新全局UI
        function updateGlobalUI() {
            document.getElementById('gold-count').textContent = globalState.goldCoins;
            
            // 计算总进度
            const totalProgress = (cssValleyState.progress + selectorMazeState.progress + validationTempleState.progress) / 3;
            document.getElementById('progress').textContent = Math.round(totalProgress) + '%';
        }

        // 创建仙女闪烁效果
        function createSparkles() {
            const fairyAssistant = document.querySelector('.fairy-assistant');
            for (let i = 0; i < 5; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'fairy-sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                fairyAssistant.appendChild(sparkle);
            }
        }

        // 更新CSS预览
        function updatePreview() {
            const code = document.getElementById('css-code').value;
            const preview = document.getElementById('css-preview');
            
            try {
                // 创建一个临时div来安全地渲染CSS
                const tempDiv = document.createElement('div');
                
                // 创建示例HTML结构
                const htmlStructure = `
                    <div class="container">
                        <nav class="navbar">
                            <div class="logo">CSS谷</div>
                            <ul class="nav-links">
                                <li><a href="#">首页</a></li>
                                <li><a href="#">关于</a></li>
                                <li><a href="#">服务</a></li>
                                <li><a href="#">联系</a></li>
                            </ul>
                        </nav>
                        
                        <div class="cards">
                            <div class="card">
                                <h3>Flexbox布局</h3>
                                <p>一维布局解决方案</p>
                            </div>
                            <div class="card">
                                <h3>响应式设计</h3>
                                <p>多设备适配</p>
                            </div>
                            <div class="card">
                                <h3>CSS动画</h3>
                                <p>生动的交互效果</p>
                            </div>
                        </div>
                    </div>
                `;
                
                // 清理预览区域
                preview.innerHTML = htmlStructure;
                
                // 添加CSS样式
                const style = document.createElement('style');
                style.textContent = code;
                preview.appendChild(style);
                
                // 添加一些基础样式使预览更美观
                const baseStyle = document.createElement('style');
                baseStyle.textContent = `
                    #css-preview * {
                        box-sizing: border-box;
                        margin: 0;
                        padding: 0;
                    }
                    #css-preview .container {
                        font-family: Arial, sans-serif;
                    }
                    #css-preview .navbar {
                        background: #1a3a5f;
                        padding: 15px;
                        margin-bottom: 20px;
                    }
                    #css-preview .logo {
                        color: white;
                        font-weight: bold;
                        font-size: 1.2em;
                    }
                    #css-preview .nav-links {
                        list-style: none;
                        margin-top: 10px;
                    }
                    #css-preview .nav-links li {
                        display: inline-block;
                        margin-right: 15px;
                    }
                    #css-preview .nav-links a {
                        color: #b8b8ff;
                        text-decoration: none;
                    }
                    #css-preview .cards {
                        display: flex;
                        gap: 15px;
                    }
                    #css-preview .card {
                        background: rgba(255, 255, 255, 0.1);
                        padding: 15px;
                        border-radius: 5px;
                        flex: 1;
                    }
                    #css-preview .card h3 {
                        color: #00ffaa;
                        margin-bottom: 8px;
                    }
                    #css-preview .card p {
                        color: #b8b8ff;
                        font-size: 0.9em;
                    }
                `;
                preview.appendChild(baseStyle);
                
            } catch (error) {
                preview.innerHTML = `<p style="color: #ff0000;">预览渲染错误: ${error.message}</p>`;
            }
        }

        // 仙女帮助系统
        function getHelp(level) {
            if (globalState.goldCoins < level) {
                alert('金币不足！请完成更多任务来获取金币。');
                return;
            }

            globalState.goldCoins -= level;
            updateGlobalUI();

            const response = document.getElementById('fairy-response');
            let helpMessage = '';

            switch(level) {
                case 1:
                    helpMessage = `
                    💡 <strong>CSS布局提示：</strong>
                    <ul>
                        <li>Flexbox: display: flex, justify-content, align-items</li>
                        <li>响应式: @media (max-width: 768px) { ... }</li>
                        <li>动画: transition, transform, @keyframes</li>
                        <li>卡片布局: flex-wrap, gap, flex-basis</li>
                    </ul>
                    `;
                    break;
                case 2:
                    helpMessage = `
                    🎯 <strong>布局思路：</strong>
                    <ol>
                        <li>导航栏使用flex布局实现水平排列</li>
                        <li>卡片容器使用flex-wrap实现响应式换行</li>
                        <li>使用媒体查询适配移动端布局变化</li>
                        <li>添加hover效果增强交互性</li>
                        <li>确保颜色搭配符合赛博朋克风格</li>
                    </ol>
                    `;
                    break;
                case 3:
                    helpMessage = `
                    🔧 <strong>完整CSS代码示例：</strong>
                    <div class="code-snippet">
/* CSS谷样式挑战 */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* 导航栏样式 - 使用Flexbox布局 */
.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #1a3a5f;
    padding: 15px 20px;
    border-radius: 8px;
}

.nav-links {
    display: flex;
    list-style: none;
    gap: 20px;
}

.nav-links a {
    color: #b8b8ff;
    text-decoration: none;
    transition: color 0.3s;
}

.nav-links a:hover {
    color: #00ffaa;
    text-shadow: 0 0 10px #00ffaa;
}

/* 卡片布局 */
.cards {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 30px;
}

.card {
    flex: 1 1 300px;
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #00c8ff;
    transition: transform 0.3s, box-shadow 0.3s;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0, 200, 255, 0.5);
}

.card h3 {
    color: #00ffaa;
    margin-bottom: 10px;
}

.card p {
    color: #b8b8ff;
}

/* 响应式设计 */
@media (max-width: 768px) {
    .navbar {
        flex-direction: column;
        gap: 15px;
    }
    
    .nav-links {
        flex-direction: column;
        text-align: center;
        gap: 10px;
    }
    
    .card {
        flex: 1 1 100%;
    }
}
                    </div>
                    <button class="insert-code-btn" onclick="insertFullCode()">插入完整代码</button>
                    `;
                    break;
            }

            response.innerHTML = helpMessage;
            response.style.display = 'block';
            
            // 添加仙女特效
            createSparkles();
        }

        // 插入完整代码
        function insertFullCode() {
            const fullCode = `/* CSS谷样式挑战 */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* 导航栏样式 - 使用Flexbox布局 */
.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #1a3a5f;
    padding: 15px 20px;
    border-radius: 8px;
}

.nav-links {
    display: flex;
    list-style: none;
    gap: 20px;
}

.nav-links a {
    color: #b8b8ff;
    text-decoration: none;
    transition: color 0.3s;
}

.nav-links a:hover {
    color: #00ffaa;
    text-shadow: 0 0 10px #00ffaa;
}

/* 卡片布局 */
.cards {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 30px;
}

.card {
    flex: 1 1 300px;
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #00c8ff;
    transition: transform 0.3s, box-shadow 0.3s;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0, 200, 255, 0.5);
}

.card h3 {
    color: #00ffaa;
    margin-bottom: 10px;
}

.card p {
    color: #b8b8ff;
}

/* 响应式设计 */
@media (max-width: 768px) {
    .navbar {
        flex-direction: column;
        gap: 15px;
    }
    
    .nav-links {
        flex-direction: column;
        text-align: center;
        gap: 10px;
    }
    
    .card {
        flex: 1 1 100%;
    }
}`;
            
            document.getElementById('css-code').value = fullCode;
            updatePreview();
            
            // 隐藏仙女响应
            document.getElementById('fairy-response').style.display = 'none';
            
            // 显示成功消息
            showCssFeedback('完整代码已插入到编辑器中！', 'success');
        }

        // 测试代码
        function testCode() {
            const code = document.getElementById('css-code').value;
            updatePreview();
            
            try {
                // 验证CSS特性
                let score = 0;
                const features = [
                    { test: 'display:\\s*flex', points: 20, name: 'Flexbox布局' },
                    { test: '@media', points: 20, name: '响应式设计' },
                    { test: 'flex-wrap', points: 20, name: 'Flex换行' },
                    { test: 'transition', points: 20, name: '过渡动画' },
                    { test: 'transform', points: 20, name: '变换效果' }
                ];
                
                features.forEach(feature => {
                    if (new RegExp(feature.test).test(code)) {
                        score += feature.points;
                    }
                });
                
                cssValleyState.progress = Math.max(cssValleyState.progress, score);
                updateGlobalUI();
                
                if (score >= 60) {
                    // 更新场景预览
                    const sceneContent = document.querySelector('.scene-content');
                    sceneContent.innerHTML = `
                        <h3>✅ 代码验证通过！</h3>
                        <p>CSS样式基本正确，布局开始恢复秩序...</p>
                        <p>CSS生物的力量正在增强！</p>
                    `;
                    showCssFeedback('代码验证通过！CSS样式正确。', 'success');
                } else {
                    showCssFeedback(`代码还需完善，当前检测到 ${score}% 的关键特性`, 'error');
                }
                
            } catch (error) {
                showCssFeedback(`❌ 发现错误：${error.message}`, 'error');
            }
        }

        // 提交代码
        function submitCode() {
            const code = document.getElementById('css-code').value;
            
            // 综合验证
            const requiredFeatures = [
                'display:\\s*flex',
                'justify-content',
                '@media',
                'flex-wrap',
                'transition'
            ];
            
            let featureCount = 0;
            requiredFeatures.forEach(feature => {
                if (new RegExp(feature).test(code)) featureCount++;
            });

            if (featureCount >= 3 && cssValleyState.progress >= 60) {
                cssValleyState.progress = 100;
                updateGlobalUI();
                document.getElementById('completion-badge').innerHTML = `
                    ✅ 样式修复完成！准备前往下一关...
                    <br>
                    <button class="next-game-btn" onclick="window.location.href='JavaScript.html'">
                        🚀 前往 JavaScript 冒险
                    </button>
                `;
                document.getElementById('completion-badge').style.display = 'block';
                
                // 更新场景，显示胜利
                const sceneContent = document.querySelector('.scene-content');
                sceneContent.innerHTML = `
                    <h3 style="color: #00ffaa;">🎉 恭喜！CSS谷恢复秩序！</h3>
                    <p>你成功修复了CSS布局，所有元素都恢复了正常！</p>
                    <p>CSS生物现在非常开心！</p>
                    <button class="next-game-btn" onclick="window.location.href='JavaScript.html'">
                        🚀 前往 JavaScript 冒险
                    </button>
                `;
                
                // 更新角色容器，显示胜利场景
                const characterContainer = document.querySelector('.character-container');
                characterContainer.innerHTML = `
                    <div class="css-wizard" style="filter: drop-shadow(0 0 15px #00ffaa);">🧙‍♂️✨</div>
                    <div class="css-creature" style="filter: drop-shadow(0 0 15px #00c8ff);">🐙🌟</div>
                `;
                
                // 奖励金币
                globalState.goldCoins += 5;
                updateGlobalUI();
                
                showCssFeedback('🎉 恭喜！你成功完成了CSS谷的挑战！', 'success');
                
                setTimeout(() => {
                    alert('🎉 恭喜！你成功完成了CSS谷的挑战！\n获得5金币奖励！\n\n点击"前往 JavaScript 冒险"按钮继续学习！');
                }, 2000);
            } else {
                showCssFeedback(`还需要完善代码！当前进度: ${cssValleyState.progress}%\n确保实现主要CSS特性。`, 'error');
            }
        }

        // 重置代码
        function resetCode() {
            if (confirm('确定要重置CSS代码吗？')) {
                document.getElementById('css-code').value = `/* CSS谷样式挑战 */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* 导航栏样式 - 使用Flexbox布局 */
.navbar {
    /* 在这里添加Flexbox样式 */
}

.nav-links {
    /* 导航链接样式 */
}

.nav-links a {
    /* 链接样式 */
}

/* 卡片布局 */
.cards {
    /* 卡片容器布局 */
}

.card {
    /* 单个卡片样式 */
}

.card:hover {
    /* 卡片悬停效果 */
}

/* 响应式设计 */
@media (max-width: 768px) {
    /* 移动端样式 */
}`;
                cssValleyState.progress = 0;
                updateGlobalUI();
                updatePreview();
                document.querySelector('.scene-content').innerHTML = `
                    <h3>欢迎来到CSS谷！</h3>
                    <p>CSS魔法出现了混乱！使用CSS布局修复样式问题...</p>
                `;
                
                // 重置角色容器
                const characterContainer = document.querySelector('.character-container');
                characterContainer.innerHTML = `
                    <div class="css-wizard">🧙‍♂️</div>
                    <div class="css-creature">🐙</div>
                `;
                
                showCssFeedback('代码已重置，可以重新开始挑战！', 'success');
            }
        }

        // 显示CSS谷反馈消息
        function showCssFeedback(message, type) {
            // 创建或获取反馈元素
            let feedback = document.getElementById('action-feedback');
            if (!feedback) {
                feedback = document.createElement('div');
                feedback.id = 'action-feedback';
                feedback.className = 'feedback-message';
                document.querySelector('.controls').parentNode.insertBefore(feedback, document.querySelector('.controls'));
            }
            
            feedback.textContent = message;
            feedback.className = 'feedback-message';
            feedback.classList.add(type === 'success' ? 'feedback-success' : 'feedback-error');
            feedback.style.display = 'block';
            
            setTimeout(() => {
                feedback.style.display = 'none';
            }, 3000);
        }

        // 选择器迷宫游戏函数
        // 初始化选择器迷宫游戏
        function initSelectorGame() {
            // 确保DOM元素存在
            if (!document.getElementById('spirit-container') || 
                !document.getElementById('selector-cards') || 
                !document.getElementById('target-styles')) {
                console.log('等待DOM元素加载...');
                setTimeout(initSelectorGame, 100);
                return;
            }
            
            console.log('初始化选择器迷宫游戏...');
            generateSelectorLevel();
            updateSelectorUI();
            setupSelectorDragAndDrop();
        }

        // 生成选择器迷宫关卡
        function generateSelectorLevel() {
            // 清空现有内容
            const spiritContainer = document.getElementById('spirit-container');
            const selectorCards = document.getElementById('selector-cards');
            const targetStyles = document.getElementById('target-styles');
            
            if (!spiritContainer || !selectorCards || !targetStyles) {
                console.error('DOM元素未找到');
                return;
            }
            
            spiritContainer.innerHTML = '';
            selectorCards.innerHTML = '';
            targetStyles.innerHTML = '<p style="font-size: 12px; margin-bottom: 6px;"><strong>目标样式：</strong></p>';
            
            // 重置匹配状态
            selectorMazeState.matchedSpirits = 0;
            selectorMazeState.spiritMatches = {};
            selectorMazeState.currentSpirits = [];
            selectorMazeState.currentSelectors = [];
            
            // 随机选择5个精灵
            const shuffledSpirits = [...allSpirits].sort(() => Math.random() - 0.5);
            const selectedSpirits = shuffledSpirits.slice(0, 5);
            
            // 生成精灵和对应的选择器
            selectedSpirits.forEach((spirit, index) => {
                selectorMazeState.currentSpirits.push(spirit);
                selectorMazeState.spiritMatches[spirit.selector] = false;
                
                // 创建精灵元素
                const spiritElement = document.createElement('div');
                spiritElement.className = 'spirit';
                spiritElement.id = `spirit-${index}`;
                spiritElement.dataset.type = spirit.type;
                spiritElement.innerHTML = `
                    <div class="spirit-icon">${spirit.icon}</div>
                    <div class="spirit-info">
                        <div class="spirit-name">${spirit.name}</div>
                        <div class="spirit-code">${spirit.code}</div>
                    </div>
                    <div class="spirit-dropzone" data-target="${spirit.selector}"></div>
                `;
                spiritContainer.appendChild(spiritElement);
                
                // 添加目标样式
                const targetItem = document.createElement('div');
                targetItem.className = 'target-item';
                const colorClass = getColorClass(spirit.type);
                targetItem.innerHTML = `
                    <div class="target-color ${colorClass}"></div>
                    <div>${spirit.name}</div>
                `;
                targetStyles.appendChild(targetItem);
                
                // 添加对应的选择器卡片
                const selector = allSelectors.find(s => s.code === spirit.selector);
                if (selector) {
                    selectorMazeState.currentSelectors.push(selector);
                    const selectorCard = document.createElement('div');
                    selectorCard.className = 'selector-card';
                    selectorCard.draggable = true;
                    selectorCard.dataset.selector = selector.code;
                    selectorCard.innerHTML = `
                        <div class="selector-name">${selector.name}</div>
                        <div class="selector-code">${selector.code} { ... }</div>
                    `;
                    selectorCards.appendChild(selectorCard);
                }
            });
            
            // 添加干扰选择器（5个）
            const shuffledAllSelectors = [...allSelectors].sort(() => Math.random() - 0.5);
            const extraSelectors = shuffledAllSelectors
                .filter(s => !selectorMazeState.currentSelectors.some(cs => cs.code === s.code))
                .slice(0, 5);
            
            extraSelectors.forEach(selector => {
                const selectorCard = document.createElement('div');
                selectorCard.className = 'selector-card';
                selectorCard.draggable = true;
                selectorCard.dataset.selector = selector.code;
                selectorCard.innerHTML = `
                    <div class="selector-name">${selector.name}</div>
                    <div class="selector-code">${selector.code} { ... }</div>
                `;
                selectorCards.appendChild(selectorCard);
            });
            
            // 打乱选择器顺序
            const cards = Array.from(selectorCards.children);
            cards.sort(() => Math.random() - 0.5);
            cards.forEach(card => selectorCards.appendChild(card));
        }

        // 获取颜色类名
        function getColorClass(type) {
            const colorMap = {
                'element': 'red',
                'class': 'blue',
                'id': 'green',
                'attribute': 'orange',
                'pseudo': 'purple'
            };
            return colorMap[type] || 'cyan';
        }

        // 更新选择器迷宫UI
        function updateSelectorUI() {
            const matchCount = document.getElementById('match-count');
            const scoreDisplay = document.getElementById('score');
            const currentLevel = document.getElementById('current-level');
            const levelDisplay = document.getElementById('level-display');
            const progressFill = document.getElementById('progress-fill');
            
            // 检查元素是否存在
            if (!matchCount || !scoreDisplay || !currentLevel || !levelDisplay || !progressFill) {
                console.log('更新UI时找不到DOM元素，等待重试...');
                return;
            }
            
            matchCount.textContent = `${selectorMazeState.matchedSpirits}/${selectorMazeState.totalSpirits}`;
            scoreDisplay.textContent = selectorMazeState.score;
            currentLevel.textContent = selectorMazeState.currentLevel;
            levelDisplay.textContent = selectorMazeState.currentLevel;
            
            // 更新进度条
            const progress = (selectorMazeState.matchedSpirits / selectorMazeState.totalSpirits) * 100;
            progressFill.style.width = `${progress}%`;
            
            // 更新全局进度
            selectorMazeState.progress = progress;
            updateGlobalUI();
        }

        // 设置选择器拖拽功能
        function setupSelectorDragAndDrop() {
            const cards = document.querySelectorAll('.selector-card');
            const dropzones = document.querySelectorAll('.spirit-dropzone');
            
            // 设置卡片可拖拽
            cards.forEach(card => {
                card.addEventListener('dragstart', handleSelectorDragStart);
                card.addEventListener('dragend', handleSelectorDragEnd);
            });
            
            // 设置放置区域
            dropzones.forEach(zone => {
                zone.addEventListener('dragover', handleSelectorDragOver);
                zone.addEventListener('dragenter', handleSelectorDragEnter);
                zone.addEventListener('dragleave', handleSelectorDragLeave);
                zone.addEventListener('drop', handleSelectorDrop);
            });
        }

        // 选择器拖拽事件处理
        function handleSelectorDragStart(e) {
            this.classList.add('dragging');
            e.dataTransfer.setData('text/plain', this.dataset.selector);
        }

        function handleSelectorDragEnd() {
            this.classList.remove('dragging');
        }

        function handleSelectorDragOver(e) {
            e.preventDefault();
        }

        function handleSelectorDragEnter(e) {
            e.preventDefault();
            this.classList.add('hover');
        }

        function handleSelectorDragLeave() {
            this.classList.remove('hover');
        }

        function handleSelectorDrop(e) {
            e.preventDefault();
            this.classList.remove('hover');
            
            const selector = e.dataTransfer.getData('text/plain');
            const targetSpirit = this.dataset.target;
            
            // 检查匹配是否正确
            checkSelectorMatch(selector, targetSpirit, this);
        }

        // 检查选择器匹配
        function checkSelectorMatch(selector, targetSpirit, dropzone) {
            const spiritElement = dropzone.closest('.spirit');
            const isCorrect = selector === targetSpirit;
            
            // 显示匹配反馈
            showSelectorMatchFeedback(isCorrect, spiritElement);
            
            if (isCorrect) {
                // 正确匹配
                spiritElement.classList.add('correct');
                spiritElement.classList.remove('incorrect');
                dropzone.classList.add('correct');
                dropzone.textContent = selector;
                
                // 更新游戏状态
                if (!selectorMazeState.spiritMatches[targetSpirit]) {
                    selectorMazeState.spiritMatches[targetSpirit] = true;
                    selectorMazeState.matchedSpirits++;
                    selectorMazeState.score += 30;
                }
                
                // 检查是否完成所有匹配
                if (selectorMazeState.matchedSpirits === selectorMazeState.totalSpirits) {
                    setTimeout(() => {
                        showSelectorFeedback('🎉 恭喜！你成功完成了这一关！', 'success');
                    }, 1000);
                }
            } else {
                // 错误匹配
                spiritElement.classList.add('incorrect');
                spiritElement.classList.remove('correct');
                
                // 短暂显示错误后恢复
                setTimeout(() => {
                    spiritElement.classList.remove('incorrect');
                }, 1000);
                
                // 扣分
                selectorMazeState.score = Math.max(0, selectorMazeState.score - 10);
            }
            
            updateSelectorUI();
        }

        // 显示选择器匹配反馈
        function showSelectorMatchFeedback(isCorrect, spiritElement) {
            const feedback = document.createElement('div');
            feedback.className = `match-feedback ${isCorrect ? 'match-success' : 'match-error'}`;
            feedback.textContent = isCorrect ? '匹配成功！' : '匹配错误！';
            
            spiritElement.appendChild(feedback);
            feedback.style.display = 'block';
            
            setTimeout(() => {
                feedback.remove();
            }, 1500);
        }

        // 检查所有选择器匹配
        function checkAllSelectorMatches() {
            if (selectorMazeState.matchedSpirits === selectorMazeState.totalSpirits) {
                selectorMazeState.score += 50;
                showSelectorFeedback('🎉 恭喜！你成功完成了这一关！', 'success');
            } else {
                const remaining = selectorMazeState.totalSpirits - selectorMazeState.matchedSpirits;
                showSelectorFeedback(`还需要匹配 ${remaining} 个精灵才能通关！', 'error`);
            }
            
            updateSelectorUI();
        }

        // 选择器迷宫下一关
        function nextSelectorLevel() {
            if (selectorMazeState.matchedSpirits === selectorMazeState.totalSpirits) {
                if (selectorMazeState.currentLevel < selectorMazeState.maxLevels) {
                    selectorMazeState.currentLevel++;
                    generateSelectorLevel();
                    setupSelectorDragAndDrop();
                    showSelectorFeedback(`进入第 ${selectorMazeState.currentLevel} 关！', 'success`);
                } else {
                    const completionBadge = document.getElementById('selector-completion-badge');
                    if (completionBadge) {
                        completionBadge.innerHTML = `
                            ✅ 恭喜！你通关了所有关卡！获得了"选择器捕网"道具！
                            <br>
                            <button class="next-game-btn" onclick="window.location.href='JavaScript.html'">
                                🚀 前往 JavaScript 冒险
                            </button>
                        `;
                        completionBadge.style.display = 'block';
                    }
                    showSelectorFeedback('🎉 恭喜！你通关了所有关卡！获得了"选择器捕网"道具！', 'success');
                    
                    // 奖励金币
                    globalState.goldCoins += 10;
                    updateGlobalUI();
                }
            } else {
                showSelectorFeedback('请先完成当前关卡的所有匹配！', 'error');
            }
        }

        // 重置选择器游戏
        function resetSelectorGame() {
            if (confirm('确定要重置游戏吗？')) {
                // 重置所有精灵状态
                const spirits = document.querySelectorAll('.spirit');
                spirits.forEach(spirit => {
                    spirit.classList.remove('correct', 'incorrect');
                });
                
                // 重置所有放置区域
                const dropzones = document.querySelectorAll('.spirit-dropzone');
                dropzones.forEach(zone => {
                    zone.classList.remove('correct', 'hover');
                    zone.textContent = '';
                });
                
                // 重置游戏状态
                selectorMazeState.matchedSpirits = 0;
                selectorMazeState.score = 0;
                selectorMazeState.currentLevel = 1;
                selectorMazeState.spiritMatches = {};
                
                const completionBadge = document.getElementById('selector-completion-badge');
                if (completionBadge) {
                    completionBadge.style.display = 'none';
                }
                generateSelectorLevel();
                setupSelectorDragAndDrop();
                showSelectorFeedback('游戏已重置，重新开始挑战！', 'success');
                updateSelectorUI();
            }
        }

        // 显示选择器迷宫反馈消息
        function showSelectorFeedback(message, type) {
            const feedbackMessage = document.getElementById('selector-feedback-message');
            if (!feedbackMessage) {
                console.error('反馈消息元素未找到');
                return;
            }
            
            feedbackMessage.textContent = message;
            feedbackMessage.className = 'selector-feedback-message';
            feedbackMessage.classList.add(type === 'success' ? 'selector-feedback-success' : 'selector-feedback-error');
            feedbackMessage.style.display = 'block';
            
            setTimeout(() => {
                feedbackMessage.style.display = 'none';
            }, 3000);
        }

        // 验证神殿游戏函数
        // 初始化验证神殿游戏
        function initValidationGame() {
            // 设置验证选项卡
            setupValidationTabs();
            
            // 更新验证UI
            updateValidationUI();
            
            // 设置验证复选框事件监听
            setupValidationCheckboxes();
        }

        // 设置验证选项卡
        function setupValidationTabs() {
            const tabs = document.querySelectorAll('.validation-tab');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    // 更新选项卡状态
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 更新内容显示
                    document.querySelectorAll('.validation-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(tabId).classList.add('active');
                    
                    // 更新当前选项卡状态
                    validationTempleState.currentTab = tabId;
                });
            });
        }

        // 设置验证复选框事件监听
        function setupValidationCheckboxes() {
            const checkboxes = document.querySelectorAll('.validation-item input[type="checkbox"]');
            
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const listItem = this.closest('.validation-item');
                    
                    if (this.checked) {
                        listItem.classList.add('completed');
                        validationTempleState.completedChecks++;
                    } else {
                        listItem.classList.remove('completed');
                        validationTempleState.completedChecks--;
                    }
                    
                    // 更新验证进度
                    validationTempleState.progress = (validationTempleState.completedChecks / validationTempleState.totalChecks) * 100;
                    updateValidationUI();
                });
            });
        }

        // 更新验证UI
        function updateValidationUI() {
            // 更新进度条
            document.getElementById('validation-progress-fill').style.width = `${validationTempleState.progress}%`;
            
            // 更新进度文本
            document.getElementById('validation-progress').textContent = `${Math.round(validationTempleState.progress)}%`;
            
            // 更新关注状态
            document.getElementById('validation-focus').textContent = validationTempleState.focus;
            
            // 更新全局进度
            globalState.validationTempleProgress = validationTempleState.progress;
            updateGlobalUI();
        }

        // 运行验证
        function runValidation() {
            // 模拟验证过程
            const progressFill = document.getElementById('validation-progress-fill');
            progressFill.style.width = '0%';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                progressFill.style.width = `${progress}%`;
                
                if (progress >= validationTempleState.progress) {
                    clearInterval(interval);
                    
                    if (validationTempleState.progress === 100) {
                        showValidationFeedback('✅ 所有验证通过！恭喜你掌握了CSS核心知识！', 'success');
                    } else {
                        showValidationFeedback(`⚠️ 验证完成！${validationTempleState.completedChecks}/${validationTempleState.totalChecks} 项通过`, 'success');
                    }
                }
            }, 100);
        }

        // 完成验证任务
        function completeValidation() {
            if (validationTempleState.progress === 100) {
                const completionBadge = document.getElementById('validation-completion-badge');
                completionBadge.innerHTML = `
                    ✅ 验证完成！恭喜你掌握了CSS核心知识！
                    <br>
                    <button class="next-game-btn" onclick="window.location.href='JavaScript.html'">
                        🚀 前往 JavaScript 冒险
                    </button>
                `;
                completionBadge.style.display = 'block';
                
                // 更新神殿场景
                const templeContent = document.querySelector('.temple-content');
                templeContent.innerHTML = `
                    <h3 style="color: #ff6b6b;">🎉 恭喜！知识验证通过！</h3>
                    <p>你成功验证了在CSS谷和选择器迷宫中学到的知识！</p>
                    <p>所有CSS核心概念都已掌握！</p>
                    <button class="next-game-btn" onclick="window.location.href='JavaScript.html'">
                        🚀 前往 JavaScript 冒险
                    </button>
                `;
                
                // 更新守护者
                const templeGuardian = document.querySelector('.temple-guardian');
                templeGuardian.textContent = '🗿✨';
                templeGuardian.style.filter = 'drop-shadow(0 0 15px #ff6b6b)';
                
                // 奖励金币
                globalState.goldCoins += 15;
                updateGlobalUI();
                
                showValidationFeedback('🎉 恭喜！你成功完成了知识验证！获得15金币奖励！', 'success');
            } else {
                showValidationFeedback(`请先完成所有验证项目！当前完成 ${validationTempleState.completedChecks}/${validationTempleState.totalChecks}`, 'error');
            }
        }

        // 重置验证游戏
        function resetValidationGame() {
            if (confirm('确定要重置验证游戏吗？')) {
                // 重置所有复选框
                const checkboxes = document.querySelectorAll('.validation-item input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                    checkbox.closest('.validation-item').classList.remove('completed');
                });
                
                // 重置游戏状态
                validationTempleState.completedChecks = 0;
                validationTempleState.progress = 0;
                
                // 更新UI
                updateValidationUI();
                
                // 隐藏完成徽章
                document.getElementById('validation-completion-badge').style.display = 'none';
                
                // 重置神殿场景
                const templeContent = document.querySelector('.temple-content');
                templeContent.innerHTML = `
                    <h3>知识验证中心</h3>
                    <p>在这里，你将验证在CSS谷和选择器迷宫中学到的知识</p>
                    <p>证明你已经掌握了关键的CSS概念！</p>
                    <div class="progress-bar" style="margin: 15px 0;">
                        <div class="progress-fill" id="validation-progress-fill" style="background: linear-gradient(90deg, #ff6b6b, #ff8e8e);"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                        <div>关注: <span id="validation-focus">1/3</span></div>
                        <div>金币: <span class="gold-coin">10</span> 🪙</div>
                        <div>进度: <span id="validation-progress">0%</span></div>
                    </div>
                `;
                
                // 重置守护者
                const templeGuardian = document.querySelector('.temple-guardian');
                templeGuardian.textContent = '🗿';
                templeGuardian.style.filter = 'drop-shadow(0 0 10px #ff6b6b)';
                
                showValidationFeedback('验证游戏已重置，重新开始挑战！', 'success');
            }
        }

        // 验证仙女帮助系统
        function getValidationHelp(level) {
            if (globalState.goldCoins < level) {
                alert('金币不足！请完成更多任务来获取金币。');
                return;
            }

            globalState.goldCoins -= level;
            updateGlobalUI();

            const response = document.getElementById('validation-fairy-response');
            let helpMessage = '';

            // 根据当前选项卡提供不同的帮助
            if (validationTempleState.currentTab === 'css-valley-validation') {
                switch(level) {
                    case 1:
                        helpMessage = `
                        💡 <strong>CSS布局提示：</strong>
                        <ul>
                            <li>Flexbox布局使用display: flex创建灵活的布局</li>
                            <li>使用justify-content和align-items控制对齐方式</li>
                            <li>响应式设计使用@media查询适配不同屏幕尺寸</li>
                            <li>CSS动画使用transition和transform创建平滑效果</li>
                        </ul>
                        `;
                        break;
                    case 2:
                        helpMessage = `
                        🎯 <strong>CSS布局思路：</strong>
                        <ol>
                            <li>确定布局类型：Flexbox、Grid或传统布局</li>
                            <li>设置容器属性：display、flex-direction等</li>
                            <li>设置项目属性：flex、order等</li>
                            <li>添加响应式断点：使用@media查询</li>
                            <li>测试不同屏幕尺寸的显示效果</li>
                        </ol>
                        `;
                        break;
                    case 3:
                        helpMessage = `
                        🔧 <strong>CSS布局示例：</strong>
                        <div class="code-snippet">
/* Flexbox布局示例 */
.container {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
}

.item {
    flex: 1 1 200px;
    margin: 10px;
}

/* 响应式设计示例 */
@media (max-width: 768px) {
    .container {
        flex-direction: column;
    }
    
    .item {
        flex: 1 1 100%;
    }
}

/* CSS动画示例 */
.button {
    transition: all 0.3s ease;
    transform: scale(1);
}

.button:hover {
    transform: scale(1.1);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}
                        </div>
                        `;
                        break;
                }
            } else {
                switch(level) {
                    case 1:
                        helpMessage = `
                        💡 <strong>CSS选择器提示：</strong>
                        <ul>
                            <li>元素选择器：p、div、h1等HTML元素</li>
                            <li>类选择器：.classname，选择具有特定类的元素</li>
                            <li>ID选择器：#idname，选择具有特定ID的元素</li>
                            <li>属性选择器：[attribute=value]，选择具有特定属性的元素</li>
                            <li>伪类选择器：:hover、:first-child等，选择特定状态的元素</li>
                        </ul>
                        `;
                        break;
                    case 2:
                        helpMessage = `
                        🎯 <strong>选择器使用思路：</strong>
                        <ol>
                            <li>确定要选择的元素类型</li>
                            <li>选择最具体的选择器类型</li>
                            <li>考虑选择器的优先级</li>
                            <li>测试选择器是否准确选中目标元素</li>
                            <li>优化选择器以提高性能</li>
                        </ol>
                        `;
                        break;
                    case 3:
                        helpMessage = `
                        🔧 <strong>CSS选择器示例：</strong>
                        <div class="code-snippet">
/* 元素选择器 */
p {
    color: blue;
}

/* 类选择器 */
.button {
    background: #ff6b6b;
    color: white;
}

/* ID选择器 */
#header {
    height: 80px;
    background: #1a3a5f;
}

/* 属性选择器 */
input[type="text"] {
    border: 1px solid #ccc;
    padding: 5px;
}

/* 伪类选择器 */
a:hover {
    color: #ff6b6b;
    text-decoration: underline;
}

li:first-child {
    font-weight: bold;
}
                        </div>
                        `;
                        break;
                }
            }

            response.innerHTML = helpMessage;
            response.style.display = 'block';
        }

        // 显示验证反馈消息
        function showValidationFeedback(message, type) {
            const feedbackMessage = document.getElementById('validation-feedback-message');
            if (!feedbackMessage) {
                console.error('验证反馈消息元素未找到');
                return;
            }
            
            feedbackMessage.textContent = message;
            feedbackMessage.className = 'validation-feedback-message';
            feedbackMessage.classList.add(type === 'success' ? 'validation-feedback-success' : 'validation-feedback-error');
            feedbackMessage.style.display = 'block';
            
            setTimeout(() => {
                feedbackMessage.style.display = 'none';
            }, 3000);
        }

        // 新手引导函数
        function startTutorial() {
            // 显示引导覆盖层和弹出窗口
            document.getElementById('tutorial-overlay').style.display = 'block';
            document.getElementById('tutorial-popup').style.display = 'block';
            
            // 显示第一步
            showTutorialStep(0);
        }

        function showTutorialStep(stepIndex) {
            const step = tutorialState.steps[stepIndex];
            
            // 更新引导内容
            document.getElementById('tutorial-title').textContent = step.title;
            document.getElementById('tutorial-content').textContent = step.content;
            document.getElementById('tutorial-progress').textContent = `${stepIndex + 1}/${tutorialState.totalSteps}`;
            
            // 更新高亮
            const highlight = document.getElementById('tutorial-highlight');
            if (step.highlight) {
                const element = document.querySelector(step.highlight);
                if (element) {
                    const rect = element.getBoundingClientRect();
                    highlight.style.width = `${rect.width + 20}px`;
                    highlight.style.height = `${rect.height + 20}px`;
                    highlight.style.top = `${rect.top - 10 + window.scrollY}px`;
                    highlight.style.left = `${rect.left - 10 + window.scrollX}px`;
                    highlight.style.display = 'block';
                }
            } else {
                highlight.style.display = 'none';
            }
            
            // 更新当前步骤
            tutorialState.currentStep = stepIndex;
        }

        function nextTutorialStep() {
            if (tutorialState.currentStep < tutorialState.totalSteps - 1) {
                showTutorialStep(tutorialState.currentStep + 1);
            } else {
                // 完成引导
                completeTutorial();
            }
        }

        function skipTutorial() {
            if (confirm('确定要跳过新手引导吗？')) {
                completeTutorial();
            }
        }

        function completeTutorial() {
            // 隐藏引导元素
            document.getElementById('tutorial-overlay').style.display = 'none';
            document.getElementById('tutorial-popup').style.display = 'none';
            document.getElementById('tutorial-highlight').style.display = 'none';
            
            // 更新状态
            globalState.tutorialCompleted = true;
            
            // 保存到本地存储
            localStorage.setItem('cssAdventureTutorialCompleted', 'true');
        }

        // 初始化
        function init() {
            setupNavigation();
            updateGlobalUI();
            updatePreview();
            createSparkles();
            
            // 添加代码更改监听
            document.getElementById('css-code').addEventListener('input', function() {
                updatePreview();
            });
            
            // 初始化验证游戏
            initValidationGame();
            
            // 检查是否需要显示新手引导
            const tutorialCompleted = localStorage.getItem('cssAdventureTutorialCompleted');
            if (!tutorialCompleted) {
                // 延迟显示引导，让页面完全加载
                setTimeout(startTutorial, 1000);
            }
            
            // 设置引导按钮事件
            document.getElementById('tutorial-next').addEventListener('click', nextTutorialStep);
            document.getElementById('tutorial-skip').addEventListener('click', skipTutorial);
        }

        // 启动游戏
        init();
    </script>
</body>
</html>