<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTMLé•‡ - è¯­ä¹‰åŒ–å†’é™©ä¹‹æ—…</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0ff;
            position: relative;
            overflow-x: hidden;
        }

        /* èµ›åšæœ‹å…‹ç½‘æ ¼èƒŒæ™¯ */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(rgba(16, 1, 32, 0.7) 1px, transparent 1px),
                linear-gradient(90deg, rgba(16, 1, 32, 0.7) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(16, 1, 32, 0.85);
            border-radius: 15px;
            box-shadow: 
                0 0 20px rgba(111, 0, 255, 0.5),
                0 0 40px rgba(111, 0, 255, 0.3),
                inset 0 0 20px rgba(111, 0, 255, 0.2);
            overflow: hidden;
            border: 1px solid #6f00ff;
            position: relative;
        }

        .game-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 50%, rgba(111, 0, 255, 0.1) 50%),
                linear-gradient(transparent 50%, rgba(111, 0, 255, 0.1) 50%);
            background-size: 10px 10px;
            pointer-events: none;
            z-index: 1;
        }

        .game-header {
            background: linear-gradient(135deg, #6f00ff, #8e2de2);
            color: #fff;
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #ff00ff;
            position: relative;
            overflow: hidden;
        }

        .game-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            position: relative;
            z-index: 2;
        }

        .player-stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(111, 0, 255, 0.5);
            box-shadow: 0 0 10px rgba(111, 0, 255, 0.3);
        }

        .game-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            min-height: 700px;
        }

        @media (max-width: 768px) {
            .game-body {
                grid-template-columns: 1fr;
            }
        }

        .scene-container {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #6f00ff;
            box-shadow: 0 0 15px rgba(111, 0, 255, 0.4);
            position: relative;
            overflow: hidden;
        }

        .scene-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(111, 0, 255, 0.1) 50%, transparent 51%),
                linear-gradient(transparent 49%, rgba(111, 0, 255, 0.1) 50%, transparent 51%);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 1;
        }

        .pixel-scene {
            background: #0a0014;
            border-radius: 8px;
            padding: 15px;
            min-height: 300px;
            position: relative;
            overflow: hidden;
            border: 1px solid #ff00ff;
            box-shadow: inset 0 0 20px rgba(255, 0, 255, 0.3);
        }

        .character-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 20px;
            height: 120px;
        }

        .dragon {
            font-size: 60px;
            filter: drop-shadow(0 0 10px #ff0000);
            animation: dragonBreath 3s infinite;
            transform: scaleX(-1);
        }

        .princess {
            font-size: 50px;
            filter: drop-shadow(0 0 10px #00ffff);
            animation: princessFloat 4s infinite;
        }

        @keyframes dragonBreath {
            0%, 100% { transform: scaleX(-1) translateY(0); }
            50% { transform: scaleX(-1) translateY(-10px); }
        }

        @keyframes princessFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .task-container {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #ff00ff;
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.3);
        }

        .task-title {
            color: #ff00ff;
            margin-bottom: 10px;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(111, 0, 255, 0.5);
            padding-bottom: 8px;
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.7);
        }

        /* å®ˆå«æˆ˜ç‰¹å®šæ ·å¼ */
        .defense-area {
            background: rgba(10, 0, 20, 0.7);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            min-height: 200px;
            border: 1px solid #6f00ff;
            position: relative;
            overflow: hidden;
        }

        .shield-meter {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 15px 0;
            overflow: hidden;
            border: 1px solid #6f00ff;
        }

        .shield-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #00cc00);
            border-radius: 10px;
            width: 100%;
            transition: width 0.5s ease;
        }

        .tag-attack {
            position: absolute;
            right: -200px;
            padding: 10px 15px;
            background: rgba(111, 0, 255, 0.3);
            border-radius: 5px;
            border: 1px solid #6f00ff;
            box-shadow: 0 0 10px rgba(111, 0, 255, 0.5);
            animation: attackMove 5s linear;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        @keyframes attackMove {
            0% { right: -200px; }
            100% { right: 100%; }
        }

        .correct-tag {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            padding: 10px 15px;
            background: rgba(111, 0, 255, 0.3);
            border-radius: 5px;
            border: 1px solid #6f00ff;
            box-shadow: 0 0 10px rgba(111, 0, 255, 0.5);
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .correct-tag.protected {
            animation: glow 1s infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(111, 0, 255, 0.5); }
            to { box-shadow: 0 0 20px rgba(111, 0, 255, 1); }
        }

        .code-editor {
            background: #0a0014;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            color: #00ffff;
            border: 1px solid #00ffff;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #b8b8ff;
            font-size: 0.9em;
        }

        textarea.code-area {
            width: 100%;
            height: 400px;
            background: #050010;
            border: 1px solid #6f00ff;
            border-radius: 5px;
            padding: 15px;
            color: #00ffff;
            font-family: 'Courier New', monospace;
            resize: vertical;
            font-size: 14px;
            line-height: 1.5;
            box-shadow: inset 0 0 10px rgba(111, 0, 255, 0.3);
        }

        .fairy-assistant {
            background: linear-gradient(135deg, #ff66cc, #cc00ff);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: white;
            border: 1px solid #ffccff;
            box-shadow: 0 0 15px rgba(255, 204, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .fairy-assistant::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.2) 0%, transparent 50%);
            pointer-events: none;
        }

        .fairy-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }

        .fairy-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ffccff, #ff66cc);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #8e2de2;
            box-shadow: 0 0 15px #ffccff;
            font-size: 1.2em;
        }

        .help-levels {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }

        .help-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .help-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .help-btn:hover::before {
            left: 100%;
        }

        .help-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .help-btn.level-1 { 
            border-left: 3px solid #aaffaa;
            box-shadow: 0 0 10px rgba(170, 255, 170, 0.5);
        }
        .help-btn.level-2 { 
            border-left: 3px solid #ffffaa;
            box-shadow: 0 0 10px rgba(255, 255, 170, 0.5);
        }
        .help-btn.level-3 { 
            border-left: 3px solid #ffaaaa;
            box-shadow: 0 0 10px rgba(255, 170, 170, 0.5);
        }

        .fairy-response {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9em;
            display: none;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 2;
        }

        .code-snippet {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            line-height: 1.4;
            white-space: pre-wrap;
            color: #ffccff;
            border: 1px solid rgba(255, 204, 255, 0.3);
        }

        .insert-code-btn {
            background: linear-gradient(135deg, #ff66cc, #cc00ff);
            color: white;
            border: none;
            border-radius: 3px;
            padding: 5px 10px;
            margin-top: 8px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(255, 102, 204, 0.5);
        }

        .insert-code-btn:hover {
            background: linear-gradient(135deg, #ff99dd, #dd33ff);
            box-shadow: 0 0 15px rgba(255, 102, 204, 0.8);
            transform: translateY(-2px);
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: #6f00ff;
            color: white;
            box-shadow: 0 0 15px rgba(111, 0, 255, 0.5);
        }

        .btn-success {
            background: #00ff00;
            color: #0a0014;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
        }

        .btn-warning {
            background: #ffcc00;
            color: #0a0014;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.5);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .completion-badge {
            background: linear-gradient(135deg, #00ff00, #00cc00);
            color: #0a0014;
            padding: 10px 20px;
            border-radius: 20px;
            text-align: center;
            margin-top: 15px;
            display: none;
            animation: pulse 2s infinite;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 15px rgba(0, 255, 0, 0.5); }
            50% { transform: scale(1.05); box-shadow: 0 0 25px rgba(0, 255, 0, 0.8); }
            100% { transform: scale(1); box-shadow: 0 0 15px rgba(0, 255, 0, 0.5); }
        }

        .feedback-message {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            display: none;
            font-weight: bold;
        }

        .feedback-success {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            border: 1px solid #00ff00;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
        }

        .feedback-error {
            background: rgba(255, 0, 0, 0.2);
            color: #ff0000;
            border: 1px solid #ff0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
        }

        .scene-content {
            color: #b8b8ff;
            text-align: center;
            padding: 20px;
        }

        /* éœ“è™¹æ–‡å­—æ•ˆæœ */
        .neon-text {
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 15px #ff00ff,
                0 0 20px #ff00ff,
                0 0 25px #ff00ff;
            animation: neon-flicker 2s infinite alternate;
        }

        @keyframes neon-flicker {
            0%, 18%, 22%, 25%, 53%, 57%, 100% {
                text-shadow: 
                    0 0 5px #fff,
                    0 0 10px #fff,
                    0 0 15px #ff00ff,
                    0 0 20px #ff00ff,
                    0 0 25px #ff00ff;
            }
            20%, 24%, 55% {
                text-shadow: none;
            }
        }

        /* èµ›åšæœ‹å…‹æ‰«æçº¿æ•ˆæœ */
        .scanlines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 0, 0, 0.1) 51%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 2;
        }

        .wave-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(111, 0, 255, 0.3);
            padding: 5px 10px;
            border-radius: 15px;
            font-weight: bold;
            border: 1px solid #6f00ff;
            box-shadow: 0 0 10px #6f00ff;
        }

        .guide-panel {
            background: rgba(42, 10, 74, 0.5);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid #6f00ff;
            display: none;
        }

        .guide-panel h3 {
            color: #ff00ff;
            margin-bottom: 10px;
        }

        .guide-panel ul {
            padding-left: 20px;
        }

        .guide-panel li {
            margin: 5px 0;
            color: #b8b8ff;
        }

        .score-display {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(111, 0, 255, 0.3);
            padding: 5px 10px;
            border-radius: 15px;
            font-weight: bold;
            border: 1px solid #6f00ff;
            box-shadow: 0 0 10px #6f00ff;
        }

        .hint-panel {
            background: rgba(42, 10, 74, 0.5);
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #6f00ff;
            text-align: center;
        }

        .hint-panel .hint-text {
            color: #b8b8ff;
            font-size: 0.9em;
        }

        .tab-container {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
            border-bottom: 1px solid #6f00ff;
        }

        .tab {
            padding: 8px 15px;
            background: rgba(111, 0, 255, 0.3);
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab.active {
            background: #6f00ff;
            box-shadow: 0 0 10px #6f00ff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .gold-coin {
            color: #ffcc00;
            font-weight: bold;
            text-shadow: 0 0 10px #ffcc00;
        }

        .html-preview {
            background: rgba(10, 0, 20, 0.7);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            min-height: 150px;
            border: 1px solid #6f00ff;
            color: #b8b8ff;
            text-align: left;
            font-size: 0.9em;
            overflow: auto;
            box-shadow: inset 0 0 10px rgba(111, 0, 255, 0.3);
        }

        .validation-panel {
            background: rgba(42, 10, 74, 0.5);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid #6f00ff;
        }

        .validation-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            padding: 8px;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.3);
        }

        .validation-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: bold;
        }

        .validation-icon.pass {
            background: #00ff00;
            color: #0a0014;
        }

        .validation-icon.fail {
            background: #ff0000;
            color: white;
        }

        .validation-text {
            flex: 1;
            font-size: 0.9em;
        }

        .tag-fragment {
            display: inline-block;
            padding: 5px 10px;
            margin: 5px;
            background: rgba(111, 0, 255, 0.3);
            border-radius: 5px;
            cursor: pointer;
            border: 1px solid #6f00ff;
            transition: all 0.3s;
        }

        .tag-fragment:hover {
            background: rgba(111, 0, 255, 0.5);
            transform: translateY(-2px);
        }

        .tag-fragment.correct {
            background: rgba(0, 255, 0, 0.3);
            border-color: #00ff00;
        }

        .tag-fragment.incorrect {
            background: rgba(255, 0, 0, 0.3);
            border-color: #ff0000;
        }

        .game-mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .mode-btn {
            flex: 1;
            padding: 10px;
            background: rgba(111, 0, 255, 0.3);
            border: 1px solid #6f00ff;
            border-radius: 5px;
            color: #e0e0ff;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .mode-btn.active {
            background: #6f00ff;
            box-shadow: 0 0 10px #6f00ff;
        }

        .mode-btn:hover {
            background: rgba(111, 0, 255, 0.5);
        }
        
        /* æ–°æ‰‹æŒ‡å¯¼æ ·å¼ */
        #tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .tutorial-container {
            max-width: 800px;
            width: 90%;
            background: rgba(16, 1, 32, 0.95);
            border-radius: 15px;
            border: 2px solid #6f00ff;
            box-shadow: 
                0 0 30px rgba(111, 0, 255, 0.7),
                inset 0 0 20px rgba(111, 0, 255, 0.3);
            overflow: hidden;
            position: relative;
        }

        .tutorial-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(111, 0, 255, 0.1) 50%, transparent 51%),
                linear-gradient(transparent 49%, rgba(111, 0, 255, 0.1) 50%, transparent 51%);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 1;
        }

        .tutorial-content {
            position: relative;
            z-index: 2;
            padding: 20px;
        }

        .tutorial-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(111, 0, 255, 0.5);
        }

        .tutorial-header h2 {
            margin: 0;
            font-size: 1.8em;
        }

        .tutorial-skip {
            background: rgba(255, 0, 0, 0.3);
            color: #ff6666;
            border: 1px solid #ff6666;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .tutorial-skip:hover {
            background: rgba(255, 0, 0, 0.5);
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }

        .tutorial-body {
            min-height: 300px;
            margin-bottom: 20px;
        }

        .tutorial-step h3 {
            color: #ff00ff;
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.7);
        }

        .tutorial-step p, .tutorial-step li {
            color: #b8b8ff;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .tutorial-step ul, .tutorial-step ol {
            padding-left: 20px;
            margin: 15px 0;
        }

        .tutorial-step li {
            margin-bottom: 8px;
        }

        .tutorial-step strong {
            color: #00ffff;
        }

        .tutorial-controls {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .tutorial-controls .btn {
            flex: 1;
        }
    </style>
</head>
<body>
    <!-- æ–°æ‰‹æŒ‡å¯¼é®ç½©å±‚ -->
    <div id="tutorial-overlay" style="display: none;">
        <div class="tutorial-container">
            <div class="tutorial-content">
                <div class="tutorial-header">
                    <h2 class="neon-text">ğŸ° HTMLé•‡æ–°æ‰‹æŒ‡å¯¼</h2>
                    <button class="tutorial-skip" onclick="skipTutorial()">è·³è¿‡æŒ‡å¯¼</button>
                </div>
                <div class="tutorial-body">
                    <div class="tutorial-step" id="tutorial-step-1">
                        <h3>æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼</h3>
                        <p>è¿™æ˜¯ä¸€ä¸ªå­¦ä¹ HTMLè¯­ä¹‰åŒ–çš„å†’é™©æ¸¸æˆã€‚ä½ å°†é€šè¿‡ä¿®å¤ç½‘é¡µç»“æ„å’Œé˜²å¾¡è¯­ä¹‰æ”»å‡»æ¥å­¦ä¹ HTMLçŸ¥è¯†ã€‚</p>
                        <p>æ¸¸æˆåˆ†ä¸ºä¸‰ä¸ªä¸»è¦æ¨¡å¼ï¼š</p>
                        <ul>
                            <li><strong>ä¸»çº¿ä»»åŠ¡</strong> - ä¿®å¤è¢«ç ´åçš„ç½‘é¡µç»“æ„</li>
                            <li><strong>è¯­ä¹‰å®ˆå«æˆ˜</strong> - é˜²å¾¡å°æ¶é­”çš„è¯­ä¹‰æ±¡æŸ“æ”»å‡»</li>
                            <li><strong>éªŒè¯é¢æ¿</strong> - æ£€æŸ¥ä½ çš„ä»£ç æ˜¯å¦ç¬¦åˆæ ‡å‡†</li>
                        </ul>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-2" style="display: none;">
                        <h3>æ¸¸æˆç•Œé¢ä»‹ç»</h3>
                        <p>å·¦ä¾§æ˜¯<strong>åœºæ™¯é¢„è§ˆåŒº</strong>ï¼Œæ˜¾ç¤ºæ¸¸æˆåœºæ™¯å’ŒHTMLé¢„è§ˆã€‚</p>
                        <p>å³ä¾§æ˜¯<strong>ä»»åŠ¡åŒº</strong>ï¼ŒåŒ…å«ä»»åŠ¡è¯´æ˜ã€ä»£ç ç¼–è¾‘å™¨å’Œæ§åˆ¶æŒ‰é’®ã€‚</p>
                        <p>å³ä¸Šè§’æ˜¾ç¤ºä½ çš„<strong>æ¸¸æˆè¿›åº¦å’Œé‡‘å¸æ•°é‡</strong>ã€‚</p>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-3" style="display: none;">
                        <h3>ä¸»çº¿ä»»åŠ¡æ¨¡å¼</h3>
                        <p>åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œä½ éœ€è¦ä¿®å¤è¢«ç ´åçš„HTMLä»£ç ï¼š</p>
                        <ol>
                            <li>æ‰¾åˆ°å¹¶ä¿®æ­£æ ‡ç­¾æ‹¼å†™é”™è¯¯</li>
                            <li>æ·»åŠ æ­£ç¡®çš„è¯­ä¹‰åŒ–æ ‡ç­¾</li>
                            <li>å®Œå–„ARIAå±æ€§</li>
                            <li>é€šè¿‡æ‰€æœ‰éªŒè¯æµ‹è¯•</li>
                        </ol>
                        <p>ä½¿ç”¨<strong>æµ‹è¯•ä»£ç </strong>æŒ‰é’®æ£€æŸ¥è¿›åº¦ï¼Œ<strong>æäº¤å…³å¡</strong>å®Œæˆä»»åŠ¡ã€‚</p>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-4" style="display: none;">
                        <h3>è¯­ä¹‰å®ˆå«æˆ˜</h3>
                        <p>åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œä½ éœ€è¦é˜²å¾¡å°æ¶é­”çš„è¯­ä¹‰æ±¡æŸ“æ”»å‡»ï¼š</p>
                        <ul>
                            <li>ç‚¹å‡»<strong>æ±¡æŸ“æ ‡ç­¾</strong>è¿›è¡Œå‡€åŒ–</li>
                            <li>ä¿æŠ¤<strong>æ­£ç¡®æ ‡ç­¾</strong>ä¸è¢«è¯¯åˆ </li>
                            <li>ä¿æŒæŠ¤ç›¾å€¼â‰¥80%æ‰èƒ½é€šå…³</li>
                        </ul>
                        <p>è®°ä½æ¯ä¸ªæ³¢æ¬¡çš„è¯­ä¹‰è§„åˆ™ï¼Œæ­£ç¡®åˆ¤æ–­å“ªäº›æ ‡ç­¾éœ€è¦å‡€åŒ–ã€‚</p>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-5" style="display: none;">
                        <h3>ä»™å¥³å¸®åŠ©ç³»ç»Ÿ</h3>
                        <p>å½“ä½ é‡åˆ°å›°éš¾æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»™å¥³å¸®åŠ©ç³»ç»Ÿï¼š</p>
                        <ul>
                            <li><strong>çº¿ç´¢æç¤º</strong> (1é‡‘å¸) - è·å¾—è§£å†³é—®é¢˜çš„å…³é”®çº¿ç´¢</li>
                            <li><strong>æ€è·¯æŒ‡å¯¼</strong> (2é‡‘å¸) - è·å¾—è¯¦ç»†çš„è§£å†³æ€è·¯</li>
                            <li><strong>å®Œæ•´ä»£ç </strong> (3é‡‘å¸) - è·å¾—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆ</li>
                        </ul>
                        <p>é€šè¿‡å®Œæˆä»»åŠ¡å’Œå®ˆå«æˆ˜å¯ä»¥è·å¾—æ›´å¤šé‡‘å¸ã€‚</p>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-6" style="display: none;">
                        <h3>å¼€å§‹å†’é™©ï¼</h3>
                        <p>ç°åœ¨ä½ å·²ç»äº†è§£äº†æ¸¸æˆçš„åŸºæœ¬ç©æ³•ï¼Œå¯ä»¥å¼€å§‹ä½ çš„HTMLè¯­ä¹‰åŒ–å†’é™©äº†ï¼</p>
                        <p>è®°ä½ï¼šè¯­ä¹‰åŒ–HTMLä¸ä»…èƒ½è®©ä»£ç æ›´æ¸…æ™°ï¼Œè¿˜èƒ½æé«˜ç½‘ç«™çš„å¯è®¿é—®æ€§å’ŒSEOæ•ˆæœã€‚</p>
                        <p>ç¥ä½ åœ¨HTMLé•‡çš„å†’é™©æ„‰å¿«ï¼</p>
                    </div>
                </div>
                <div class="tutorial-controls">
                    <button class="btn btn-warning" id="tutorial-prev" onclick="prevTutorialStep()" style="display: none;">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-primary" id="tutorial-next" onclick="nextTutorialStep()">ä¸‹ä¸€æ­¥</button>
                    <button class="btn btn-success" id="tutorial-finish" onclick="finishTutorial()" style="display: none;">å¼€å§‹æ¸¸æˆ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="game-container">
        <div class="scanlines"></div>
        <div class="game-header">
            <div class="header-content">
                <h1 class="neon-text">ğŸ° HTMLé•‡ - è¯­ä¹‰åŒ–å†’é™©ä¹‹æ—…</h1>
                <div class="player-stats">
                    <div class="stat">å…³å¡: <span id="current-level">1/3</span></div>
                    <div class="stat">é‡‘å¸: <span class="gold-coin" id="gold-count">10</span> ğŸª™</div>
                    <div class="stat">è¿›åº¦: <span id="progress">0%</span></div>
                </div>
            </div>
        </div>

        <div class="game-body">
            <!-- å·¦ä¾§ï¼šæ¸¸æˆåœºæ™¯ -->
            <div class="scene-container">
                <h2>ğŸ–¼ï¸ åœºæ™¯é¢„è§ˆ</h2>
                <div class="pixel-scene">
                    <div class="character-container">
                        <div class="dragon">ğŸ‰</div>
                        <div class="princess">ğŸ‘¸</div>
                    </div>
                    <div class="scene-content" id="scene-content">
                        <h3>æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼</h3>
                        <p>é¡µé¢å…¬ä¸»çš„æ ‡é¢˜è¢«æ¶é¾™å·èµ°äº†ï¼è¯·ä¿®å¤ç½‘é¡µç»“æ„...</p>
                    </div>
                    
                    <!-- è¯­ä¹‰å®ˆå«æˆ˜åŒºåŸŸ -->
                    <div class="defense-area" id="defense-area" style="display: none;">
                        <div class="wave-indicator" id="wave-indicator">ç¬¬1æ³¢æ”»å‡»</div>
                        <div class="score-display" id="score-display">å¾—åˆ†: 0</div>
                        <div class="shield-meter">
                            <div class="shield-fill" id="shield-fill" style="width: 100%;"></div>
                        </div>
                        <div class="correct-tag" id="correct-tag">&lt;h1&gt;HTMLé•‡æ¬¢è¿ä½ &lt;/h1&gt;</div>
                        <!-- æ”»å‡»æ ‡ç­¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    
                    <!-- HTMLé¢„è§ˆåŒºåŸŸ -->
                    <div class="html-preview" id="html-preview">
                        <!-- HTMLé¢„è§ˆå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šä»»åŠ¡å’Œä»£ç ç¼–è¾‘ -->
            <div class="task-container">
                <div class="game-mode-selector">
                    <div class="mode-btn active" data-mode="main">ä¸»çº¿ä»»åŠ¡</div>
                    <div class="mode-btn" data-mode="defense">è¯­ä¹‰å®ˆå«æˆ˜</div>
                    <div class="mode-btn" data-mode="validation">éªŒè¯é¢æ¿</div>
                </div>

                <!-- ä¸»çº¿ä»»åŠ¡ -->
                <div class="tab-content active" id="main-tab">
                    <h2 class="task-title">ğŸ“ ä¸»çº¿ä»»åŠ¡ - æ‰¾å›å¤±è¸ªçš„æ ‡é¢˜</h2>
                    <div class="task-description">
                        <p>é¡µé¢å…¬ä¸»çš„æ‹›ç‰Œ&lt;h1&gt;æ ‡é¢˜è¢«å°æ¶é­”å·èµ°äº†ï¼è¯·å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š</p>
                        <ul class="task-steps">
                            <li>åœ¨ä»£ç æ£®æ—ä¸­æ‰¾åˆ°æ­£ç¡®çš„&lt;h1&gt;æ ‡ç­¾ç¢ç‰‡</li>
                            <li>å°†ç¢ç‰‡æ‹–å…¥index.htmlçš„&lt;body&gt;æœ€é¡¶éƒ¨</li>
                            <li>è¡¥å…¨&lt;title&gt;æ ‡ç­¾å†…å®¹</li>
                            <li>æ·»åŠ è¯­ä¹‰åŒ–æ ‡ç­¾å’ŒARIAå±æ€§</li>
                            <li>é€šè¿‡ç»“æ„æ£€æŸ¥ä»ªå’Œå±å¹•é˜…è¯»å™¨æµ‹è¯•</li>
                        </ul>
                    </div>

                    <div class="code-editor">
                        <div class="editor-header">
                            <span>ğŸ“„ index.html</span>
                            <span>HTML5</span>
                        </div>
                        <textarea class="code-area" id="html-code" placeholder="åœ¨è¿™é‡Œç¼–å†™ä½ çš„HTMLä»£ç ...">
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <<tittle>HTMLé•‡</tittle>
</head>
<body>
    <!-- åœ¨è¿™é‡Œæ·»åŠ æ ‡é¢˜ -->
    
    <p>æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼è¿™é‡Œæ›¾ç»æœ‰ä¸€ä¸ªæ¼‚äº®çš„æ ‡é¢˜...</p>
</body>
</html></textarea>
                    </div>
                </div>

                <!-- è¯­ä¹‰å®ˆå«æˆ˜ -->
                <div class="tab-content" id="defense-tab">
                    <h2 class="task-title">ğŸ›¡ï¸ è¯­ä¹‰å®ˆå«æˆ˜</h2>
                    <div class="task-description">
                        <p>å°æ¶é­”æ­£åœ¨å‘åŠ¨è¯­ä¹‰æ±¡æŸ“æ”»å‡»ï¼ä½ éœ€è¦ï¼š</p>
                        <ul class="task-steps">
                            <li>ç‚¹å‡»<strong>æ±¡æŸ“æ ‡ç­¾</strong>è¿›è¡Œå‡€åŒ–</li>
                            <li>ä¿æŠ¤<strong>æ­£ç¡®æ ‡ç­¾</strong>ä¸è¢«è¯¯åˆ </li>
                            <li>ä¿æŒæŠ¤ç›¾å€¼â‰¥80%æ‰èƒ½é€šå…³</li>
                        </ul>
                        
                        <div class="hint-panel">
                            <div class="hint-text" id="current-hint">å½“å‰è§„åˆ™ï¼šä¸€ä¸ªé¡µé¢åªèƒ½æœ‰ä¸€ä¸ª&lt;h1&gt;æ ‡ç­¾</div>
                        </div>

                        <p><strong>æ”»å‡»æ³¢æ¬¡ï¼š</strong></p>
                        <ol>
                            <li>ç¬¬ä¸€æ³¢ï¼šé‡å¤h1æ ‡ç­¾ + å…¶ä»–æ­£ç¡®æ ‡é¢˜</li>
                            <li>ç¬¬äºŒæ³¢ï¼šä¼ªè£…æ ‡ç­¾ + æ­£ç¡®è¯­ä¹‰æ ‡ç­¾</li>
                            <li>ç¬¬ä¸‰æ³¢ï¼šé”™è¯¯åµŒå¥— + æ­£ç¡®åµŒå¥—</li>
                        </ol>
                    </div>

                    <div class="guide-panel" id="guide-panel">
                        <h3>é˜²å¾¡æŒ‡å— - è¯­ä¹‰åŒ–è§„åˆ™</h3>
                        <ul>
                            <li><strong>ä¸€ä¸ªé¡µé¢åªèƒ½æœ‰ä¸€ä¸ª&lt;h1&gt;æ ‡ç­¾</strong></li>
                            <li>ä¸è¦ç”¨divã€pç­‰æ ‡ç­¾ä¼ªè£…æˆæ ‡é¢˜</li>
                            <li>é¿å…åœ¨æ®µè½å†…åµŒå¥—æ ‡é¢˜æ ‡ç­¾</li>
                            <li>h2-h6å¯ä»¥ç”¨äºå‰¯æ ‡é¢˜</li>
                            <li>ä¿æŒè¯­ä¹‰åŒ–ç»“æ„çš„æ¸…æ™°å’Œå”¯ä¸€æ€§</li>
                        </ul>
                    </div>
                </div>

                <!-- éªŒè¯é¢æ¿ -->
                <div class="tab-content" id="validation-tab">
                    <h2 class="task-title">ğŸ”§ éªŒè¯é¢æ¿</h2>
                    <div class="validation-panel">
                        <div class="validation-item">
                            <div class="validation-icon fail">âŒ</div>
                            <div class="validation-text">ç»“æ„æ£€æŸ¥ï¼š&lt;h1&gt;æ ‡ç­¾ä½ç½®</div>
                        </div>
                        <div class="validation-item">
                            <div class="validation-icon fail">âŒ</div>
                            <div class="validation-text">æ ‡é¢˜å†…å®¹ï¼šé•¿åº¦å’Œå…³é”®è¯æ£€æŸ¥</div>
                        </div>
                        <div class="validation-item">
                            <div class="validation-icon fail">âŒ</div>
                            <div class="validation-text">ARIAå±æ€§ï¼šroleå’Œaria-label</div>
                        </div>
                        <div class="validation-item">
                            <div class="validation-icon fail">âŒ</div>
                            <div class="validation-text">å±å¹•é˜…è¯»å™¨ï¼šå®Œæ•´æ’­æŠ¥æµ‹è¯•</div>
                        </div>
                        <div class="validation-item">
                            <div class="validation-icon fail">âŒ</div>
                            <div class="validation-text">æ ‡ç­¾æ‹¼å†™ï¼š&lt;title&gt;ä¿®æ­£</div>
                        </div>
                    </div>
                </div>

                <div class="fairy-assistant">
                    <div class="fairy-header">
                        <div class="fairy-avatar">ğŸ§šâ€â™€ï¸</div>
                        <h3>ä»™å¥³ä¸‹å‡¡</h3>
                    </div>
                    <p>ğŸ§šâ€â™€ï¸ é‡åˆ°å›°éš¾å—ï¼Ÿè¯·ä½ æ”¯ä»˜é‡‘å¸ç»™æˆ‘</p>
                    <div class="help-levels">
                        <button class="help-btn level-1" onclick="getHelp(1)">
                            ğŸ’¡ çº¿ç´¢æç¤º (1ğŸª™)
                        </button>
                        <button class="help-btn level-2" onclick="getHelp(2)">
                            ğŸ¯ æ€è·¯æŒ‡å¯¼ (2ğŸª™)
                        </button>
                        <button class="help-btn level-3" onclick="getHelp(3)">
                            ğŸ”§ å®Œæ•´ä»£ç  (3ğŸª™)
                        </button>
                    </div>
                    <div class="fairy-response" id="fairy-response">
                        <!-- ä»™å¥³å›å¤å†…å®¹ -->
                    </div>
                </div>

                <div class="controls">
                    <button class="btn btn-warning" onclick="resetCode()">ğŸ”„ é‡ç½®ä»£ç </button>
                    <button class="btn btn-primary" onclick="testCode()">ğŸ§ª æµ‹è¯•ä»£ç </button>
                    <button class="btn btn-success" onclick="submitCode()">ğŸš€ æäº¤å…³å¡</button>
                    <button class="btn btn-primary" id="defense-btn" onclick="startDefense()">ğŸ›¡ï¸ å¼€å§‹å®ˆå«</button>
                </div>

                <div class="completion-badge" id="completion-badge">
                    âœ… ä»»åŠ¡å®Œæˆï¼å…¬ä¸»å·²è·æ•‘ï¼Œå‡†å¤‡å‰å¾€ä¸‹ä¸€å…³...
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ–°æ‰‹æŒ‡å¯¼çŠ¶æ€
        const tutorialState = {
            currentStep: 1,
            totalSteps: 6,
            completed: false
        };

        // æ˜¾ç¤ºæ–°æ‰‹æŒ‡å¯¼
        function showTutorial() {
            // æ£€æŸ¥æ˜¯å¦å·²ç»å®Œæˆè¿‡æŒ‡å¯¼
            const tutorialCompleted = localStorage.getItem('htmlTownTutorialCompleted');
            
            if (tutorialCompleted === 'true') {
                return; // å¦‚æœå·²ç»å®Œæˆè¿‡ï¼Œåˆ™ä¸æ˜¾ç¤º
            }
            
            document.getElementById('tutorial-overlay').style.display = 'flex';
            updateTutorialStep();
        }

        // æ›´æ–°æ–°æ‰‹æŒ‡å¯¼æ­¥éª¤
        function updateTutorialStep() {
            // éšè—æ‰€æœ‰æ­¥éª¤
            for (let i = 1; i <= tutorialState.totalSteps; i++) {
                document.getElementById(`tutorial-step-${i}`).style.display = 'none';
            }
            
            // æ˜¾ç¤ºå½“å‰æ­¥éª¤
            document.getElementById(`tutorial-step-${tutorialState.currentStep}`).style.display = 'block';
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const prevBtn = document.getElementById('tutorial-prev');
            const nextBtn = document.getElementById('tutorial-next');
            const finishBtn = document.getElementById('tutorial-finish');
            
            if (tutorialState.currentStep === 1) {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'block';
                finishBtn.style.display = 'none';
            } else if (tutorialState.currentStep === tutorialState.totalSteps) {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'none';
                finishBtn.style.display = 'block';
            } else {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'block';
                finishBtn.style.display = 'none';
            }
        }

        // ä¸‹ä¸€æ­¥
        function nextTutorialStep() {
            if (tutorialState.currentStep < tutorialState.totalSteps) {
                tutorialState.currentStep++;
                updateTutorialStep();
            }
        }

        // ä¸Šä¸€æ­¥
        function prevTutorialStep() {
            if (tutorialState.currentStep > 1) {
                tutorialState.currentStep--;
                updateTutorialStep();
            }
        }

        // å®ŒæˆæŒ‡å¯¼
        function finishTutorial() {
            document.getElementById('tutorial-overlay').style.display = 'none';
            tutorialState.completed = true;
            
            // å°†å®ŒæˆçŠ¶æ€ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('htmlTownTutorialCompleted', 'true');
            
            // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
            showFeedback('ğŸ‰ æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼å¼€å§‹ä½ çš„è¯­ä¹‰åŒ–å†’é™©å§ï¼', 'success');
        }

        // è·³è¿‡æŒ‡å¯¼
        function skipTutorial() {
            if (confirm('ç¡®å®šè¦è·³è¿‡æ–°æ‰‹æŒ‡å¯¼å—ï¼Ÿä½ å¯ä»¥åœ¨è®¾ç½®ä¸­é‡æ–°æŸ¥çœ‹æŒ‡å¯¼ã€‚')) {
                finishTutorial();
            }
        }

        // æ¸¸æˆçŠ¶æ€
        const gameState = {
            currentMode: 'main',
            goldCoins: 10,
            progress: 0,
            currentLevel: 1,
            maxLevels: 3,
            
            // è¯­ä¹‰å®ˆå«æˆ˜çŠ¶æ€
            shieldValue: 100,
            currentWave: 0,
            maxWaves: 3,
            isDefending: false,
            defenseScore: 0,
            correctTag: '<h1>HTMLé•‡æ¬¢è¿ä½ </h1>',
            attacks: {
                1: [
                    { type: 'pollution', html: '<h1>å‡æ ‡é¢˜1</h1>', description: 'é‡å¤h1æ ‡ç­¾' },
                    { type: 'correct', html: '<h2>å‰¯æ ‡é¢˜1</h2>', description: 'æ­£ç¡®çš„h2æ ‡ç­¾' },
                    { type: 'pollution', html: '<h1>é‡å¤æ ‡é¢˜</h1>', description: 'é‡å¤h1æ ‡ç­¾' },
                    { type: 'correct', html: '<h3>å°æ ‡é¢˜</h3>', description: 'æ­£ç¡®çš„h3æ ‡ç­¾' },
                    { type: 'pollution', html: '<h1>æ¶æ„æ ‡é¢˜</h1>', description: 'é‡å¤h1æ ‡ç­¾' },
                    { type: 'correct', html: '<h4>å››çº§æ ‡é¢˜</h4>', description: 'æ­£ç¡®çš„h4æ ‡ç­¾' }
                ],
                2: [
                    { type: 'pollution', html: '<div id="h1">ä¼ªè£…æ ‡é¢˜1</div>', description: 'divä¼ªè£…æ ‡é¢˜' },
                    { type: 'correct', html: '<nav>å¯¼èˆªèœå•</nav>', description: 'æ­£ç¡®çš„navæ ‡ç­¾' },
                    { type: 'pollution', html: '<p class="title">ä¼ªè£…æ ‡é¢˜2</p>', description: 'pä¼ªè£…æ ‡é¢˜' },
                    { type: 'correct', html: '<aside>ä¾§è¾¹æ </aside>', description: 'æ­£ç¡®çš„asideæ ‡ç­¾' },
                    { type: 'pollution', html: '<span style="font-size:24px">ä¼ªè£…æ ‡é¢˜3</span>', description: 'spanä¼ªè£…æ ‡é¢˜' },
                    { type: 'correct', html: '<footer>é¡µè„š</footer>', description: 'æ­£ç¡®çš„footeræ ‡ç­¾' }
                ],
                3: [
                    { type: 'pollution', html: '<p><h1>åµŒå¥—é”™è¯¯1</h1></p>', description: 'h1åœ¨på†…åµŒå¥—' },
                    { type: 'correct', html: '<section><h2>æ­£ç¡®åµŒå¥—</h2></section>', description: 'h2åœ¨sectionå†…æ­£ç¡®åµŒå¥—' },
                    { type: 'pollution', html: '<div><h1>åµŒå¥—é”™è¯¯2</h1></div>', description: 'h1åœ¨divå†…åµŒå¥—' },
                    { type: 'correct', html: '<article><h3>æ–‡ç« æ ‡é¢˜</h3></article>', description: 'h3åœ¨articleå†…æ­£ç¡®åµŒå¥—' },
                    { type: 'pollution', html: '<span><h1>åµŒå¥—é”™è¯¯3</h1></span>', description: 'h1åœ¨spanå†…åµŒå¥—' },
                    { type: 'correct', html: '<main><p>ä¸»è¦å†…å®¹</p></main>', description: 'påœ¨mainå†…æ­£ç¡®åµŒå¥—' }
                ]
            },
            hints: {
                1: "å½“å‰è§„åˆ™ï¼šä¸€ä¸ªé¡µé¢åªèƒ½æœ‰ä¸€ä¸ª&lt;h1&gt;æ ‡ç­¾",
                2: "å½“å‰è§„åˆ™ï¼šä¸è¦ç”¨éè¯­ä¹‰åŒ–æ ‡ç­¾ä¼ªè£…æ ‡é¢˜",
                3: "å½“å‰è§„åˆ™ï¼šé¿å…åœ¨æ®µè½å†…åµŒå¥—æ ‡é¢˜æ ‡ç­¾"
            }
        };

        // DOMå…ƒç´ 
        const defenseArea = document.getElementById('defense-area');
        const shieldFill = document.getElementById('shield-fill');
        const scoreDisplay = document.getElementById('score-display');
        const waveIndicator = document.getElementById('wave-indicator');
        const correctTag = document.getElementById('correct-tag');
        const guidePanel = document.getElementById('guide-panel');
        const completionBadge = document.getElementById('completion-badge');
        const currentHint = document.getElementById('current-hint');
        const sceneContent = document.getElementById('scene-content');
        const htmlPreview = document.getElementById('html-preview');
        const defenseBtn = document.getElementById('defense-btn');

        // æ›´æ–°UIæ˜¾ç¤º
        function updateUI() {
            document.getElementById('gold-count').textContent = gameState.goldCoins;
            document.getElementById('progress').textContent = gameState.progress + '%';
            document.getElementById('current-level').textContent = `${gameState.currentLevel}/${gameState.maxLevels}`;
            
            // æ›´æ–°å®ˆå«æˆ˜UI
            shieldFill.style.width = `${gameState.shieldValue}%`;
            scoreDisplay.textContent = `å¾—åˆ†: ${gameState.defenseScore}`;
            
            // æ ¹æ®æŠ¤ç›¾å€¼æ”¹å˜é¢œè‰²
            if (gameState.shieldValue >= 80) {
                shieldFill.style.background = 'linear-gradient(90deg, #00ff00, #00cc00)';
            } else if (gameState.shieldValue >= 50) {
                shieldFill.style.background = 'linear-gradient(90deg, #ffff00, #ffcc00)';
            } else {
                shieldFill.style.background = 'linear-gradient(90deg, #ff0000, #cc0000)';
            }
        }

        // æ›´æ–°HTMLé¢„è§ˆ
        function updatePreview() {
            const code = document.getElementById('html-code').value;
            
            try {
                // åˆ›å»ºä¸€ä¸ªä¸´æ—¶divæ¥å®‰å…¨åœ°æ¸²æŸ“HTML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = code;
                
                // æ¸…ç†é¢„è§ˆåŒºåŸŸ
                htmlPreview.innerHTML = '';
                
                // æå–bodyå†…å®¹è¿›è¡Œé¢„è§ˆ
                const bodyMatch = code.match(/<body[^>]*>([\s\S]*)<\/body>/i);
                if (bodyMatch && bodyMatch[1]) {
                    htmlPreview.innerHTML = bodyMatch[1];
                } else {
                    htmlPreview.innerHTML = '<p style="color: #7f8c8d; text-align: center;">ç¼–å†™HTMLä»£ç åï¼Œé¢„è§ˆå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>';
                }
                
                // æ·»åŠ ä¸€äº›åŸºæœ¬æ ·å¼ä½¿é¢„è§ˆæ›´ç¾è§‚
                const style = document.createElement('style');
                style.textContent = `
                    #html-preview * {
                        box-sizing: border-box;
                    }
                    #html-preview h1 {
                        color: #00ffff;
                        text-shadow: 0 0 10px #00ffff;
                        margin-bottom: 15px;
                    }
                    #html-preview p {
                        color: #b8b8ff;
                        line-height: 1.5;
                    }
                    #html-preview header {
                        background: rgba(111, 0, 255, 0.3);
                        padding: 15px;
                        border-radius: 5px;
                        margin-bottom: 15px;
                        border: 1px solid #6f00ff;
                    }
                `;
                htmlPreview.appendChild(style);
                
            } catch (error) {
                htmlPreview.innerHTML = `<p style="color: #ff0000;">é¢„è§ˆæ¸²æŸ“é”™è¯¯: ${error.message}</p>`;
            }
        }

        // åˆ‡æ¢æ¸¸æˆæ¨¡å¼
        function setupModeSelector() {
            const modeBtns = document.querySelectorAll('.mode-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            modeBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const mode = this.getAttribute('data-mode');
                    
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    modeBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // æ›´æ–°å†…å®¹æ˜¾ç¤º
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(`${mode}-tab`).classList.add('active');
                    
                    // æ›´æ–°æ¸¸æˆçŠ¶æ€
                    gameState.currentMode = mode;
                    
                    // æ ¹æ®æ¨¡å¼æ›´æ–°åœºæ™¯
                    if (mode === 'defense') {
                        sceneContent.innerHTML = `
                            <h3>ğŸ›¡ï¸ è¯­ä¹‰å®ˆå«æˆ˜åœº</h3>
                            <p>å°æ¶é­”çš„è¯­ä¹‰æ±¡æŸ“æ”»å‡»ï¼</p>
                            <p>æ ¹æ®è¯­ä¹‰è§„åˆ™åˆ¤æ–­å“ªäº›æ ‡ç­¾éœ€è¦å‡€åŒ–</p>
                            <p><strong>ç‚¹å‡»æ±¡æŸ“æ ‡ç­¾å‡€åŒ–ï¼Œä¿æŠ¤æ­£ç¡®æ ‡ç­¾</strong></p>
                        `;
                        defenseArea.style.display = 'block';
                        defenseBtn.style.display = 'block';
                    } else {
                        sceneContent.innerHTML = `
                            <h3>æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼</h3>
                            <p>é¡µé¢å…¬ä¸»çš„æ ‡é¢˜è¢«æ¶é¾™å·èµ°äº†ï¼è¯·ä¿®å¤ç½‘é¡µç»“æ„...</p>
                        `;
                        defenseArea.style.display = 'none';
                        defenseBtn.style.display = 'none';
                    }
                });
            });
        }

        // ä»™å¥³å¸®åŠ©ç³»ç»Ÿ
        function getHelp(level) {
            if (gameState.goldCoins < level) {
                alert('é‡‘å¸ä¸è¶³ï¼è¯·å®Œæˆæ›´å¤šä»»åŠ¡æ¥è·å–é‡‘å¸ã€‚');
                return;
            }

            gameState.goldCoins -= level;
            updateUI();

            const response = document.getElementById('fairy-response');
            let helpMessage = '';

            switch(level) {
                case 1:
                    helpMessage = `
                    ğŸ’¡ <strong>è¯­ä¹‰åŒ–æ ‡ç­¾æç¤ºï¼š</strong>
                    <ul>
                        <li>ä½¿ç”¨&lt;h1&gt;ä½œä¸ºä¸»æ ‡é¢˜ï¼Œä¸è¦ç”¨divæˆ–pæ ‡ç­¾æ›¿ä»£</li>
                        <li>å°†&lt;h1&gt;æ”¾åœ¨&lt;header&gt;æ ‡ç­¾å†…</li>
                        <li>ç¡®ä¿&lt;title&gt;å’Œ&lt;h1&gt;å†…å®¹ä¸€è‡´ä¸”åŒ…å«"HTMLé•‡"</li>
                        <li>æ·»åŠ role="main"å’Œaria-labelå±æ€§</li>
                    </ul>
                    `;
                    break;
                case 2:
                    helpMessage = `
                    ğŸ¯ <strong>ä¿®å¤æ€è·¯ï¼š</strong>
                    <ol>
                        <li>ä¿®æ­£&lt;title&gt;æ ‡ç­¾çš„æ‹¼å†™é”™è¯¯</li>
                        <li>åœ¨bodyå†…æ·»åŠ headerå…ƒç´ </li>
                        <li>åœ¨headerå†…æ·»åŠ å¸¦ARIAå±æ€§çš„h1æ ‡é¢˜</li>
                        <li>ç¡®ä¿æ ‡é¢˜å†…å®¹ä¸º"HTMLé•‡æ¬¢è¿ä½ "</li>
                        <li>æµ‹è¯•å±å¹•é˜…è¯»å™¨æ’­æŠ¥æ•ˆæœ</li>
                    </ol>
                    `;
                    break;
                case 3:
                    helpMessage = `
                    ğŸ”§ <strong>å®Œæ•´HTMLä»£ç ç¤ºä¾‹ï¼š</strong>
                    <div class="code-snippet">
&lt;!DOCTYPE html&gt;
&lt;html lang="zh-CN"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;HTMLé•‡æ¬¢è¿ä½ &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;h1 role="main" aria-label="HTMLé•‡æ¬¢è¿ä½ "&gt;HTMLé•‡æ¬¢è¿ä½ &lt;/h1&gt;
    &lt;/header&gt;
    
    &lt;p&gt;æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼è¿™é‡Œæ›¾ç»æœ‰ä¸€ä¸ªæ¼‚äº®çš„æ ‡é¢˜...&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
                    </div>
                    <button class="insert-code-btn" onclick="insertFullCode()">æ’å…¥å®Œæ•´ä»£ç </button>
                    `;
                    break;
            }

            response.innerHTML = helpMessage;
            response.style.display = 'block';
        }

        // æ’å…¥å®Œæ•´ä»£ç 
        function insertFullCode() {
            const fullCode = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTMLé•‡æ¬¢è¿ä½ </title>
</head>
<body>
    <header>
        <h1 role="main" aria-label="HTMLé•‡æ¬¢è¿ä½ ">HTMLé•‡æ¬¢è¿ä½ </h1>
    </header>
    
    <p>æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼è¿™é‡Œæ›¾ç»æœ‰ä¸€ä¸ªæ¼‚äº®çš„æ ‡é¢˜...</p>
</body>
</html>`;
            
            document.getElementById('html-code').value = fullCode;
            updatePreview();
            
            // éšè—ä»™å¥³å“åº”
            document.getElementById('fairy-response').style.display = 'none';
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            showFeedback('å®Œæ•´ä»£ç å·²æ’å…¥åˆ°ç¼–è¾‘å™¨ä¸­ï¼', 'success');
        }

        // æµ‹è¯•ä»£ç 
        function testCode() {
            const code = document.getElementById('html-code').value;
            updatePreview();
            
            try {
                // éªŒè¯ä»£ç 
                const validationItems = document.querySelectorAll('.validation-item');
                
                // 1. æ£€æŸ¥titleæ ‡ç­¾æ‹¼å†™
                const titleSpelling = !code.includes('<<tittle>') && code.includes('<title>');
                validationItems[4].querySelector('.validation-icon').className = 
                    `validation-icon ${titleSpelling ? 'pass' : 'fail'}`;
                validationItems[4].querySelector('.validation-icon').textContent = titleSpelling ? 'âœ“' : 'âŒ';
                
                // 2. æ£€æŸ¥h1æ ‡ç­¾ä½ç½®å’Œç»“æ„
                const h1InHeader = code.includes('<header>') && 
                    code.match(/<header[^>]*>[\s\S]*<h1/g);
                validationItems[0].querySelector('.validation-icon').className = 
                    `validation-icon ${h1InHeader ? 'pass' : 'fail'}`;
                validationItems[0].querySelector('.validation-icon').textContent = h1InHeader ? 'âœ“' : 'âŒ';
                
                // 3. æ£€æŸ¥æ ‡é¢˜å†…å®¹
                const titleMatch = code.match(/<title>([^<]*)<\/title>/);
                const h1Match = code.match(/<h1[^>]*>([^<]*)<\/h1>/);
                const titleContent = titleMatch && titleMatch[1].includes('HTMLé•‡') && 
                    titleMatch[1].length >= 8 && titleMatch[1].length <= 20;
                const h1Content = h1Match && h1Match[1].includes('HTMLé•‡') && 
                    h1Match[1].length >= 8 && h1Match[1].length <= 20;
                validationItems[1].querySelector('.validation-icon').className = 
                    `validation-icon ${titleContent && h1Content ? 'pass' : 'fail'}`;
                validationItems[1].querySelector('.validation-icon').textContent = titleContent && h1Content ? 'âœ“' : 'âŒ';
                
                // 4. æ£€æŸ¥ARIAå±æ€§
                const hasAria = code.includes('role="main"') && code.includes('aria-label=');
                validationItems[2].querySelector('.validation-icon').className = 
                    `validation-icon ${hasAria ? 'pass' : 'fail'}`;
                validationItems[2].querySelector('.validation-icon').textContent = hasAria ? 'âœ“' : 'âŒ';
                
                // 5. æ¨¡æ‹Ÿå±å¹•é˜…è¯»å™¨æµ‹è¯•
                const screenReaderReady = h1InHeader && hasAria && titleContent && h1Content;
                validationItems[3].querySelector('.validation-icon').className = 
                    `validation-icon ${screenReaderReady ? 'pass' : 'fail'}`;
                validationItems[3].querySelector('.validation-icon').textContent = screenReaderReady ? 'âœ“' : 'âŒ';

                // è®¡ç®—è¿›åº¦
                const passedCount = document.querySelectorAll('.validation-icon.pass').length;
                gameState.progress = Math.max(gameState.progress, (passedCount / 5) * 100);
                updateUI();
                
                if (passedCount === 5) {
                    showFeedback('âœ… æ‰€æœ‰éªŒè¯é€šè¿‡ï¼ä»£ç ç»“æ„å®Œç¾ï¼', 'success');
                } else {
                    showFeedback(`é€šè¿‡äº† ${passedCount}/5 é¡¹éªŒè¯ï¼Œè¯·ç»§ç»­å®Œå–„ä»£ç ã€‚`, 'error');
                }
                
            } catch (error) {
                showFeedback(`âŒ å‘ç°é”™è¯¯ï¼š${error.message}`, 'error');
            }
        }

        // æäº¤ä»£ç 
        function submitCode() {
            const code = document.getElementById('html-code').value;
            
            // æœ€ç»ˆéªŒè¯
            const passedCount = document.querySelectorAll('.validation-icon.pass').length;
            
            if (passedCount === 5) {
                gameState.progress = 100;
                updateUI();
                completionBadge.style.display = 'block';
                
                // æ›´æ–°åœºæ™¯ï¼Œæ˜¾ç¤ºå…¬ä¸»è·æ•‘
                sceneContent.innerHTML = `
                    <h3 style="color: #00ff00;">ğŸ‰ æ­å–œï¼æ ‡é¢˜å·²æ‰¾å›ï¼</h3>
                    <p>ä½ æˆåŠŸä¿®å¤äº†HTMLç»“æ„ï¼Œé¡µé¢å…¬ä¸»çš„æ ‡é¢˜æ¢å¤äº†ï¼</p>
                    <p>å°é•‡æ¢å¤äº†å¾€æ—¥çš„å’Œå¹³ä¸ç§©åºã€‚</p>
                `;
                
                // æ›´æ–°è§’è‰²å®¹å™¨ï¼Œæ˜¾ç¤ºèƒœåˆ©åœºæ™¯
                const characterContainer = document.querySelector('.character-container');
                characterContainer.innerHTML = `
                    <div class="dragon" style="filter: drop-shadow(0 0 5px #666); opacity: 0.5;">ğŸ‰</div>
                    <div class="princess" style="filter: drop-shadow(0 0 15px #00ff00);">ğŸ‘¸âœ¨</div>
                `;
                
                showFeedback('ğŸ‰ æ­å–œï¼ä½ æˆåŠŸå®Œæˆäº†HTMLé•‡çš„æŒ‘æˆ˜ï¼', 'success');
                
                setTimeout(() => {
                    alert('ğŸ‰ æ­å–œï¼ä½ æˆåŠŸå®Œæˆäº†HTMLé•‡çš„æŒ‘æˆ˜ï¼\nè·å¾—å¥–åŠ±ï¼šè¯­ä¹‰åŒ–æ ‡ç­¾é€ŸæŸ¥æ‰‹å†Œ\nå‡†å¤‡å‰å¾€CSSè°·...');
                    // è¿™é‡Œå¯ä»¥æ·»åŠ è·³è½¬åˆ°ä¸‹ä¸€å…³çš„é€»è¾‘
                }, 2000);
            } else {
                showFeedback(`è¿˜éœ€è¦å®Œå–„ä»£ç ï¼å½“å‰é€šè¿‡äº† ${passedCount}/5 é¡¹éªŒè¯ã€‚`, 'error');
            }
        }

        // é‡ç½®ä»£ç 
        function resetCode() {
            if (confirm('ç¡®å®šè¦é‡ç½®ä»£ç å—ï¼Ÿ')) {
                document.getElementById('html-code').value = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <<tittle>HTMLé•‡</tittle>
</head>
<body>
    <!-- åœ¨è¿™é‡Œæ·»åŠ æ ‡é¢˜ -->
    
    <p>æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼è¿™é‡Œæ›¾ç»æœ‰ä¸€ä¸ªæ¼‚äº®çš„æ ‡é¢˜...</p>
</body>
</html>`;
                gameState.progress = 0;
                updateUI();
                updatePreview();
                sceneContent.innerHTML = `
                    <h3>æ¬¢è¿æ¥åˆ°HTMLé•‡ï¼</h3>
                    <p>é¡µé¢å…¬ä¸»çš„æ ‡é¢˜è¢«æ¶é¾™å·èµ°äº†ï¼è¯·ä¿®å¤ç½‘é¡µç»“æ„...</p>
                `;
                
                // é‡ç½®è§’è‰²å®¹å™¨
                const characterContainer = document.querySelector('.character-container');
                characterContainer.innerHTML = `
                    <div class="dragon">ğŸ‰</div>
                    <div class="princess">ğŸ‘¸</div>
                `;
                
                // é‡ç½®éªŒè¯é¢æ¿
                const validationIcons = document.querySelectorAll('.validation-icon');
                validationIcons.forEach(icon => {
                    icon.className = 'validation-icon fail';
                    icon.textContent = 'âŒ';
                });
                
                showFeedback('ä»£ç å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°å¼€å§‹æŒ‘æˆ˜ï¼', 'success');
            }
        }

        // æ˜¾ç¤ºåé¦ˆæ¶ˆæ¯
        function showFeedback(message, type) {
            // åˆ›å»ºæˆ–è·å–åé¦ˆå…ƒç´ 
            let feedback = document.getElementById('action-feedback');
            if (!feedback) {
                feedback = document.createElement('div');
                feedback.id = 'action-feedback';
                feedback.className = 'feedback-message';
                document.querySelector('.controls').parentNode.insertBefore(feedback, document.querySelector('.controls'));
            }
            
            feedback.textContent = message;
            feedback.className = 'feedback-message';
            feedback.classList.add(type === 'success' ? 'feedback-success' : 'feedback-error');
            feedback.style.display = 'block';
            
            setTimeout(() => {
                feedback.style.display = 'none';
            }, 3000);
        }

        // è¯­ä¹‰å®ˆå«æˆ˜åŠŸèƒ½
        function startDefense() {
            if (gameState.isDefending) return;
            
            gameState.isDefending = true;
            gameState.currentWave = 1;
            gameState.shieldValue = 100;
            gameState.defenseScore = 0;
            
            updateUI();
            updateHint();
            startWave(1);
            
            showFeedback('ç¬¬ä¸€æ³¢æ”»å‡»å¼€å§‹ï¼è®°ä½ï¼šä¸€ä¸ªé¡µé¢åªèƒ½æœ‰ä¸€ä¸ªh1æ ‡ç­¾ï¼', 'success');
        }

        // å¼€å§‹æ”»å‡»æ³¢
        function startWave(waveNumber) {
            gameState.currentWave = waveNumber;
            updateUI();
            updateHint();
            
            const attacks = gameState.attacks[waveNumber];
            let attackCount = 0;
            
            // æ¸…é™¤ä¹‹å‰çš„æ”»å‡»æ ‡ç­¾
            clearAttackTags();
            
            // å¯åŠ¨æ­£ç¡®æ ‡ç­¾ä¿æŠ¤åŠ¨ç”»
            correctTag.classList.add('protected');
            
            // ç”Ÿæˆæ”»å‡»æ ‡ç­¾
            const attackInterval = setInterval(() => {
                if (attackCount < attacks.length) {
                    createAttackTag(attacks[attackCount]);
                    attackCount++;
                } else {
                    clearInterval(attackInterval);
                    
                    // 6ç§’åæ£€æŸ¥æ˜¯å¦è¿›å…¥ä¸‹ä¸€æ³¢
                    setTimeout(() => {
                        if (gameState.currentWave < gameState.maxWaves) {
                            const waveMessages = [
                                'ç¬¬äºŒæ³¢æ”»å‡»å¼€å§‹ï¼æ³¨æ„ä¼ªè£…æ ‡ç­¾ï¼',
                                'ç¬¬ä¸‰æ³¢æ”»å‡»å¼€å§‹ï¼å°å¿ƒé”™è¯¯åµŒå¥—ï¼'
                            ];
                            startWave(gameState.currentWave + 1);
                            showFeedback(waveMessages[gameState.currentWave - 2], 'success');
                        } else {
                            endDefense();
                        }
                    }, 6000);
                }
            }, 1000);
        }

        // åˆ›å»ºæ”»å‡»æ ‡ç­¾
        function createAttackTag(attackData) {
            const attackTag = document.createElement('div');
            attackTag.className = 'tag-attack';
            attackTag.innerHTML = attackData.html;
            attackTag.style.top = `${Math.random() * 70 + 15}%`;
            attackTag.setAttribute('data-type', attackData.type);
            attackTag.setAttribute('data-description', attackData.description);
            
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶
            attackTag.addEventListener('click', function() {
                const type = this.getAttribute('data-type');
                const description = this.getAttribute('data-description');
                
                if (type === 'pollution') {
                    // æ­£ç¡®ç‚¹å‡»æ±¡æŸ“æ ‡ç­¾
                    this.style.background = 'rgba(0, 255, 0, 0.3)';
                    this.style.borderColor = '#00ff00';
                    setTimeout(() => {
                        if (this.parentNode) this.remove();
                    }, 300);
                    increaseShield(8);
                    gameState.defenseScore += 10;
                    showFeedback(`âœ… æ­£ç¡®å‡€åŒ–ï¼š${description}`, 'success');
                } else {
                    // é”™è¯¯ç‚¹å‡»æ­£ç¡®æ ‡ç­¾
                    this.style.background = 'rgba(255, 0, 0, 0.3)';
                    this.style.borderColor = '#ff0000';
                    setTimeout(() => {
                        if (this.parentNode) this.remove();
                    }, 300);
                    decreaseShield(15);
                    gameState.defenseScore = Math.max(0, gameState.defenseScore - 15);
                    showFeedback(`âŒ é”™è¯¯ï¼è¿™æ˜¯æ­£ç¡®æ ‡ç­¾ï¼š${description}`, 'error');
                }
                updateUI();
            });
            
            defenseArea.appendChild(attackTag);
            
            // 5ç§’åè‡ªåŠ¨æ¶ˆå¤±
            setTimeout(() => {
                if (attackTag.parentNode) {
                    const type = attackTag.getAttribute('data-type');
                    const description = attackTag.getAttribute('data-description');
                    
                    if (type === 'pollution') {
                        // é”™è¿‡æ±¡æŸ“æ ‡ç­¾
                        attackTag.style.background = 'rgba(255, 0, 0, 0.3)';
                        attackTag.style.borderColor = '#ff0000';
                        setTimeout(() => {
                            if (attackTag.parentNode) attackTag.remove();
                        }, 300);
                        decreaseShield(10);
                        showFeedback(`âŒ é”™è¿‡äº†æ±¡æŸ“æ ‡ç­¾ï¼š${description}`, 'error');
                    } else {
                        // æ­£ç¡®å¿½ç•¥æ­£ç¡®æ ‡ç­¾
                        attackTag.style.background = 'rgba(0, 255, 0, 0.3)';
                        attackTag.style.borderColor = '#00ff00';
                        setTimeout(() => {
                            if (attackTag.parentNode) attackTag.remove();
                        }, 300);
                        increaseShield(5);
                        gameState.defenseScore += 5;
                        showFeedback(`âœ… æ­£ç¡®ä¿æŠ¤ï¼š${description}`, 'success');
                    }
                    updateUI();
                }
            }, 5000);
        }

        // æ¸…é™¤æ‰€æœ‰æ”»å‡»æ ‡ç­¾
        function clearAttackTags() {
            const attackTags = document.querySelectorAll('.tag-attack');
            attackTags.forEach(tag => tag.remove());
        }

        // å¢åŠ æŠ¤ç›¾å€¼
        function increaseShield(amount) {
            gameState.shieldValue = Math.min(100, gameState.shieldValue + amount);
        }

        // å‡å°‘æŠ¤ç›¾å€¼
        function decreaseShield(amount) {
            gameState.shieldValue = Math.max(0, gameState.shieldValue - amount);
        }

        // æ›´æ–°æç¤º
        function updateHint() {
            currentHint.innerHTML = gameState.hints[gameState.currentWave];
        }

        // ç»“æŸå®ˆå«æˆ˜
        function endDefense() {
            gameState.isDefending = false;
            clearAttackTags();
            correctTag.classList.remove('protected');
            
            if (gameState.shieldValue >= 80) {
                // å®ˆå«æˆåŠŸ
                completionBadge.style.display = 'block';
                showFeedback(`ğŸ‰ å®ˆå«æˆåŠŸï¼æœ€ç»ˆå¾—åˆ†ï¼š${gameState.defenseScore}`, 'success');
                
                // å¥–åŠ±é‡‘å¸
                gameState.goldCoins += 5;
                updateUI();
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                setTimeout(() => {
                    alert(`ğŸ‰ è¯­ä¹‰å®ˆå«æˆ˜èƒœåˆ©ï¼\n\næœ€ç»ˆå¾—åˆ†ï¼š${gameState.defenseScore}\nè·å¾—å¥–åŠ±ï¼š5é‡‘å¸\n"ä¸€ä¸ªé¡µé¢åªæœ‰ä¸€ä¸ªæœ€é«˜çº§æ ‡é¢˜ï¼Œè¯­ä¹‰ç»“æ„æ‰ç¨³å›ºï¼"`);
                }, 2000);
            } else {
                // å®ˆå«å¤±è´¥
                showFeedback(`æŠ¤ç›¾å€¼ä¸è¶³ï¼ˆ${gameState.shieldValue}%ï¼‰ï¼Œéœ€è¦â‰¥80%æ‰èƒ½é€šå…³`, 'error');
            }
        }

        // åˆå§‹åŒ–
        function init() {
            updateUI();
            updatePreview();
            setupModeSelector();
            
            // æ·»åŠ ä»£ç æ›´æ”¹ç›‘å¬
            document.getElementById('html-code').addEventListener('input', function() {
                updatePreview();
            });
            
            // æ˜¾ç¤ºæ–°æ‰‹æŒ‡å¯¼
            setTimeout(() => {
                showTutorial();
            }, 1000);
        }

        // å¯åŠ¨æ¸¸æˆ
        init();
    </script>
</body>
</html>