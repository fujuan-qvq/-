<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScriptæ¸¯ - èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #8e44ad 0%, #3498db 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0ff;
            position: relative;
            overflow-x: hidden;
        }

        /* èµ›åšæœ‹å…‹ç½‘æ ¼èƒŒæ™¯ */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(rgba(16, 1, 32, 0.7) 1px, transparent 1px),
                linear-gradient(90deg, rgba(16, 1, 32, 0.7) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(16, 1, 32, 0.85);
            border-radius: 15px;
            box-shadow: 
                0 0 20px rgba(255, 204, 0, 0.5),
                0 0 40px rgba(255, 204, 0, 0.3),
                inset 0 0 20px rgba(255, 204, 0, 0.2);
            overflow: hidden;
            border: 1px solid #ffcc00;
            position: relative;
        }

        .game-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 50%, rgba(255, 204, 0, 0.1) 50%),
                linear-gradient(transparent 50%, rgba(255, 204, 0, 0.1) 50%);
            background-size: 10px 10px;
            pointer-events: none;
            z-index: 1;
        }

        .game-header {
            background: linear-gradient(135deg, #ffcc00, #ff9900);
            color: #1a1a1a;
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #ff6600;
            position: relative;
            overflow: hidden;
        }

        .game-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            position: relative;
            z-index: 2;
        }

        .player-stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(255, 204, 0, 0.5);
            box-shadow: 0 0 10px rgba(255, 204, 0, 0.3);
        }

        .game-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            min-height: 700px;
        }

        @media (max-width: 768px) {
            .game-body {
                grid-template-columns: 1fr;
            }
        }

        .scene-container {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #ffcc00;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.4);
            position: relative;
            overflow: hidden;
        }

        .scene-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(255, 204, 0, 0.1) 50%, transparent 51%),
                linear-gradient(transparent 49%, rgba(255, 204, 0, 0.1) 50%, transparent 51%);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 1;
        }

        .pixel-scene {
            background: #0a0014;
            border-radius: 8px;
            padding: 15px;
            min-height: 300px;
            position: relative;
            overflow: hidden;
            border: 1px solid #ff6600;
            box-shadow: inset 0 0 20px rgba(255, 102, 0, 0.3);
        }

        .character-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 20px;
            height: 120px;
        }

        /* ä¿®æ”¹ä¸ºèˆ¹ä½“å’Œèˆªæ ‡ */
        .ship-body {
            font-size: 60px;
            filter: drop-shadow(0 0 10px #ffcc00);
            animation: shipFloat 4s infinite;
        }

        .beacon {
            font-size: 50px;
            filter: drop-shadow(0 0 10px #ff6600);
            animation: beaconPulse 3s infinite;
        }

        /* èˆªæ ‡ç‚¹äº®çŠ¶æ€ */
        .beacon.lit {
            filter: drop-shadow(0 0 15px #ffcc00);
            color: #ffcc00;
            animation: beaconGlow 2s infinite alternate;
        }

        @keyframes shipFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes beaconPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes beaconGlow {
            0% { text-shadow: 0 0 5px #ffcc00, 0 0 10px #ffcc00; }
            100% { text-shadow: 0 0 10px #ffcc00, 0 0 20px #ffcc00, 0 0 30px #ffcc00; }
        }

        /* æ–°æ‰‹å¼•å¯¼æ ·å¼ */
        #tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .tutorial-container {
            max-width: 800px;
            width: 90%;
            background: rgba(16, 1, 32, 0.95);
            border-radius: 15px;
            border: 2px solid #ffcc00;
            box-shadow: 
                0 0 30px rgba(255, 204, 0, 0.7),
                inset 0 0 20px rgba(255, 204, 0, 0.3);
            overflow: hidden;
            position: relative;
        }

        .tutorial-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(255, 204, 0, 0.1) 50%, transparent 51%),
                linear-gradient(transparent 49%, rgba(255, 204, 0, 0.1) 50%, transparent 51%);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: 1;
        }

        .tutorial-content {
            position: relative;
            z-index: 2;
            padding: 30px;
        }

        .tutorial-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 204, 0, 0.5);
        }

        .tutorial-header h2 {
            margin: 0;
            font-size: 1.8em;
            color: #ffcc00;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.7);
        }

        .tutorial-skip {
            background: rgba(255, 0, 0, 0.3);
            color: #ff6666;
            border: 1px solid #ff6666;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 0.9em;
        }

        .tutorial-skip:hover {
            background: rgba(255, 0, 0, 0.5);
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            transform: translateY(-2px);
        }

        .tutorial-body {
            min-height: 320px;
            margin-bottom: 25px;
        }

        .tutorial-step {
            display: none;
        }

        .tutorial-step.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tutorial-step h3 {
            color: #ffcc00;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.7);
            font-size: 1.4em;
        }

        .tutorial-step p, .tutorial-step li {
            color: #b8b8ff;
            line-height: 1.6;
            margin-bottom: 12px;
            font-size: 1em;
        }

        .tutorial-step ul, .tutorial-step ol {
            padding-left: 25px;
            margin: 18px 0;
        }

        .tutorial-step li {
            margin-bottom: 10px;
        }

        .tutorial-step strong {
            color: #ff9900;
        }

        .tutorial-controls {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 20px;
        }

        .tutorial-controls .btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 1em;
        }

        .btn-warning {
            background: #ff9900;
            color: #1a1a1a;
            box-shadow: 0 0 15px rgba(255, 153, 0, 0.5);
        }

        .btn-primary {
            background: #ffcc00;
            color: #1a1a1a;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.5);
        }

        .btn-success {
            background: #ff6600;
            color: white;
            box-shadow: 0 0 15px rgba(255, 102, 0, 0.5);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
        }

        .tutorial-progress {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            color: #ffcc00;
        }

        .progress-dots {
            display: flex;
            gap: 10px;
        }

        .progress-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #4a2c6d;
            border: 2px solid #ffcc00;
            transition: all 0.3s;
            cursor: pointer;
        }

        .progress-dot.active {
            background: #ffcc00;
            box-shadow: 0 0 10px #ffcc00;
            transform: scale(1.2);
        }

        .code-highlight {
            background: rgba(255, 204, 0, 0.2);
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #ffcc00;
            border: 1px solid rgba(255, 204, 0, 0.3);
            font-size: 0.9em;
        }

        .feature-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 20px 0;
        }

        .feature-item {
            background: rgba(74, 44, 109, 0.5);
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #ffcc00;
            font-size: 0.9em;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .feature-list {
                grid-template-columns: 1fr;
            }
            
            .tutorial-container {
                width: 95%;
                margin: 10px;
            }
            
            .tutorial-content {
                padding: 20px;
            }
        }

        /* å…¶ä½™åŸæœ‰æ ·å¼ä¿æŒä¸å˜... */
        .pixel-art {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 2px;
            margin-bottom: 15px;
        }

        .pixel {
            width: 20px;
            height: 20px;
            background: #4a2c6d;
            border-radius: 2px;
            transition: all 0.3s;
        }

        .pixel.active {
            background: #ffcc00;
            box-shadow: 0 0 10px #ffcc00;
        }

        .interactive-demo {
            background: linear-gradient(135deg, #ffcc00, #ff9900);
            width: 120px;
            height: 80px;
            margin: 10px auto;
            position: relative;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a1a1a;
            font-weight: bold;
            font-size: 0.8em;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .interactive-demo:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 204, 0, 0.9);
        }

        .task-container {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #ff6600;
            box-shadow: 0 0 15px rgba(255, 102, 0, 0.3);
        }

        .task-title {
            color: #ffcc00;
            margin-bottom: 10px;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(255, 204, 0, 0.5);
            padding-bottom: 8px;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.7);
        }

        .task-description {
            background: rgba(74, 44, 109, 0.5);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 204, 0, 0.3);
            font-size: 0.95em;
        }

        .task-steps {
            margin: 10px 0;
            padding-left: 18px;
            font-size: 0.9em;
        }

        .task-steps li {
            margin: 6px 0;
            color: #b8b8ff;
        }

        .code-editor {
            background: #0a0014;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            color: #ffcc00;
            border: 1px solid #ffcc00;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.3);
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #b8b8ff;
            font-size: 0.9em;
        }

        textarea.code-area {
            width: 100%;
            height: 400px;
            background: #050010;
            border: 1px solid #ff9900;
            border-radius: 5px;
            padding: 15px;
            color: #ffcc00;
            font-family: 'Courier New', monospace;
            resize: vertical;
            font-size: 14px;
            line-height: 1.5;
            box-shadow: inset 0 0 10px rgba(255, 153, 0, 0.3);
        }

        .fairy-assistant {
            background: linear-gradient(135deg, #ffcc00, #ff9900);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: #1a1a1a;
            border: 1px solid #ffeeaa;
            box-shadow: 0 0 15px rgba(255, 238, 170, 0.5);
            position: relative;
            overflow: hidden;
        }

        .fairy-assistant::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.2) 0%, transparent 50%);
            pointer-events: none;
        }

        .fairy-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }

        .fairy-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ffeeaa, #ffcc00);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #4a2c6d;
            box-shadow: 0 0 15px #ffeeaa;
            font-size: 1.2em;
        }

        .help-levels {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }

        .help-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            color: #1a1a1a;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .help-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .help-btn:hover::before {
            left: 100%;
        }

        .help-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .help-btn.level-1 { 
            border-left: 3px solid #aaffaa;
            box-shadow: 0 0 10px rgba(170, 255, 170, 0.5);
        }
        .help-btn.level-2 { 
            border-left: 3px solid #ffffaa;
            box-shadow: 0 0 10px rgba(255, 255, 170, 0.5);
        }
        .help-btn.level-3 { 
            border-left: 3px solid #ffaaaa;
            box-shadow: 0 0 10px rgba(255, 170, 170, 0.5);
        }

        .fairy-response {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9em;
            display: none;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 2;
        }

        .code-snippet {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            line-height: 1.4;
            white-space: pre-wrap;
            color: #ffeeaa;
            border: 1px solid rgba(255, 238, 170, 0.3);
        }

        .insert-code-btn {
            background: linear-gradient(135deg, #ffcc00, #ff9900);
            color: #1a1a1a;
            border: none;
            border-radius: 3px;
            padding: 5px 10px;
            margin-top: 8px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
        }

        .insert-code-btn:hover {
            background: linear-gradient(135deg, #ffd633, #ffad33);
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.8);
            transform: translateY(-2px);
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: #ffcc00;
            color: #1a1a1a;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.5);
        }

        .btn-success {
            background: #ff6600;
            color: white;
            box-shadow: 0 0 15px rgba(255, 102, 0, 0.5);
        }

        .btn-warning {
            background: #ff9900;
            color: #1a1a1a;
            box-shadow: 0 0 15px rgba(255, 153, 0, 0.5);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .completion-badge {
            background: linear-gradient(135deg, #ff6600, #cc5200);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            text-align: center;
            margin-top: 15px;
            display: none;
            animation: pulse 2s infinite;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(255, 102, 0, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 15px rgba(255, 102, 0, 0.5); }
            50% { transform: scale(1.05); box-shadow: 0 0 25px rgba(255, 102, 0, 0.8); }
            100% { transform: scale(1); box-shadow: 0 0 15px rgba(255, 102, 0, 0.5); }
        }

        .gold-coin {
            color: #ffcc00;
            font-weight: bold;
            text-shadow: 0 0 10px #ffcc00;
        }

        .feedback-message {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            display: none;
            font-weight: bold;
        }

        .feedback-success {
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            border: 1px solid #ffcc00;
            box-shadow: 0 0 10px rgba(255, 204, 0, 0.3);
        }

        .feedback-error {
            background: rgba(255, 0, 0, 0.2);
            color: #ff0000;
            border: 1px solid #ff0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
        }

        .scene-content {
            color: #b8b8ff;
            text-align: center;
            padding: 20px;
        }

        .js-preview {
            background: rgba(10, 0, 20, 0.7);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            min-height: 150px;
            border: 1px solid #ffcc00;
            color: #b8b8ff;
            text-align: left;
            font-size: 0.9em;
            overflow: auto;
            box-shadow: inset 0 0 10px rgba(255, 204, 0, 0.3);
        }

        /* éœ“è™¹æ–‡å­—æ•ˆæœ */
        .neon-text {
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 15px #ffcc00,
                0 0 20px #ffcc00,
                0 0 25px #ffcc00;
            animation: neon-flicker 2s infinite alternate;
        }

        @keyframes neon-flicker {
            0%, 18%, 22%, 25%, 53%, 57%, 100% {
                text-shadow: 
                    0 0 5px #fff,
                    0 0 10px #fff,
                    0 0 15px #ffcc00,
                    0 0 20px #ffcc00,
                    0 0 25px #ffcc00;
            }
            20%, 24%, 55% {
                text-shadow: none;
            }
        }

        /* èµ›åšæœ‹å…‹æ‰«æçº¿æ•ˆæœ */
        .scanlines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 0, 0, 0.1) 51%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 2;
        }

        .fairy-sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 10px white;
            animation: sparkle 2s infinite;
            z-index: 1;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }

        .interactive-area {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .interactive-element {
            width: 70px;
            height: 50px;
            background: rgba(255, 204, 0, 0.3);
            border: 1px solid #ffcc00;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .interactive-element:hover {
            background: rgba(255, 204, 0, 0.5);
            transform: scale(1.05);
        }

        .console-output {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #ff9900;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            height: 80px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.8em;
            color: #ffcc00;
        }

        /* é˜²å¾¡æŒ‘æˆ˜æ ·å¼ - ä¿®æ”¹ä¸ºèˆªæ ‡ç‚¹äº® */
        .defense-challenge {
            background: rgba(16, 1, 32, 0.9);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #ffcc00;
            box-shadow: 0 0 15px rgba(255, 204, 0, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .defense-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            color: #ffcc00;
            font-size: 1.2em;
        }
        
        /* èˆªæ ‡æ˜¾ç¤ºç¾åŒ– */
        .beacon-display {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            background: rgba(10, 0, 20, 0.7);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #ffcc00;
            box-shadow: 0 0 10px rgba(255, 204, 0, 0.3);
        }
        
        .beacon-icon {
            font-size: 2em;
            margin-right: 15px;
            filter: drop-shadow(0 0 5px #ffcc00);
            animation: beaconGlow 2s infinite alternate;
        }
        
        @keyframes beaconGlow {
            0% { transform: scale(1); filter: drop-shadow(0 0 5px #ffcc00); }
            100% { transform: scale(1.05); filter: drop-shadow(0 0 10px #ffcc00); }
        }
        
        .beacon-info {
            flex: 1;
        }
        
        .beacon-label {
            font-size: 0.9em;
            color: #b8b8ff;
            margin-bottom: 5px;
        }
        
        .beacon-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.7);
        }
        
        .beacon-bar-container {
            width: 100%;
            height: 20px;
            background: rgba(255, 0, 0, 0.2);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #ff6600;
            margin-top: 10px;
            position: relative;
        }
        
        .beacon-bar {
            height: 100%;
            background: linear-gradient(90deg, #ffcc00, #ff9900);
            width: 40%;
            transition: width 0.5s ease-out;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .beacon-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: beaconShine 2s infinite;
        }
        
        @keyframes beaconShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .beacon-status {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8em;
            font-weight: bold;
            color: #1a1a1a;
            text-shadow: 0 0 5px rgba(255, 204, 0, 0.7);
        }
        
        .wave-indicator {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
        }
        
        .wave-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #4a2c6d;
            border: 1px solid #ffcc00;
            transition: all 0.3s;
        }
        
        .wave-dot.active {
            background: #ffcc00;
            box-shadow: 0 0 10px #ffcc00;
        }
        
        .script-attack {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid #ff6600;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            color: #ffcc00;
            min-height: 150px;
            position: relative;
            display: none;
        }
        
        .script-attack.active {
            display: block;
            animation: attackSlideIn 0.5s forwards;
        }
        
        @keyframes attackSlideIn {
            0% { transform: translateX(100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .script-content {
            white-space: pre-wrap;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .script-threat {
            background: rgba(255, 0, 0, 0.2);
            padding: 5px;
            border-radius: 3px;
            color: #ff9999;
        }
        
        .defense-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .defense-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            flex: 1;
            max-width: 150px;
        }
        
        .defense-btn.fix {
            background: #ff9900;
            color: #1a1a1a;
            box-shadow: 0 0 10px rgba(255, 153, 0, 0.5);
        }
        
        .defense-btn.ignore {
            background: #4a2c6d;
            color: #b8b8ff;
            box-shadow: 0 0 10px rgba(74, 44, 109, 0.5);
        }
        
        .timer {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffcc00;
            text-align: center;
            margin: 10px 0;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.7);
        }
        
        .defense-result {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
            font-weight: bold;
        }
        
        .defense-success {
            background: rgba(0, 255, 0, 0.2);
            color: #aaffaa;
            border: 1px solid #aaffaa;
            box-shadow: 0 0 15px rgba(170, 255, 170, 0.5);
        }
        
        .defense-failure {
            background: rgba(255, 0, 0, 0.2);
            color: #ffaaaa;
            border: 1px solid #ffaaaa;
            box-shadow: 0 0 15px rgba(255, 170, 170, 0.5);
        }
        
        .highlight-code {
            background: rgba(255, 204, 0, 0.2);
            padding: 2px 5px;
            border-radius: 3px;
            color: #ffcc00;
            animation: highlightPulse 1.5s infinite;
        }
        
        @keyframes highlightPulse {
            0%, 100% { background: rgba(255, 204, 0, 0.2); }
            50% { background: rgba(255, 204, 0, 0.5); }
        }
        
        .defense-guide {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid #ffcc00;
            display: none;
        }
        
        .guide-title {
            color: #ffcc00;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .guide-rule {
            margin: 8px 0;
            padding-left: 15px;
            border-left: 3px solid #ffcc00;
        }

        /* éªŒè¯é¢æ¿æ ·å¼ */
        .validation-panel {
            background: rgba(16, 1, 32, 0.7);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid #ffcc00;
        }
        
        .validation-title {
            color: #ffcc00;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .validation-item {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background: rgba(74, 44, 109, 0.5);
            display: flex;
            align-items: center;
        }
        
        .validation-check {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4a2c6d;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ffcc00;
        }
        
        .validation-check.valid {
            background: #aaffaa;
            color: #1a1a1a;
        }
        
        .validation-check.invalid {
            background: #ffaaaa;
            color: #1a1a1a;
        }
        
        .validation-text {
            flex: 1;
        }

        /* é€‰é¡¹å¡æ ·å¼ */
        .tab-container {
            margin-bottom: 20px;
        }
        
        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ffcc00;
        }
        
        .tab-button {
            padding: 10px 20px;
            background: rgba(16, 1, 32, 0.7);
            border: none;
            border-bottom: 3px solid transparent;
            color: #b8b8ff;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .tab-button.active {
            color: #ffcc00;
            border-bottom: 3px solid #ffcc00;
            background: rgba(255, 204, 0, 0.1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }

        /* åœºæ™¯åˆ‡æ¢æ ·å¼ */
        .scene-js {
            display: block;
        }
        
        .scene-html {
            display: none;
        }
        
        /* èˆªæ ‡ç‚¹äº®çŠ¶æ€ */
        .beacon-progress {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
        }
        
        .beacon-light {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #4a2c6d;
            border: 2px solid #ffcc00;
            transition: all 0.3s;
        }
        
        .beacon-light.lit {
            background: #ffcc00;
            box-shadow: 0 0 15px #ffcc00;
            animation: beaconPulse 2s infinite;
        }
        
        /* å°èˆ¹åŠ¨ç”»åŒºåŸŸ */
        .ship-animation-area {
            position: relative;
            height: 100px;
            margin: 20px 0;
            border-radius: 8px;
            background: rgba(10, 0, 20, 0.5);
            border: 1px solid rgba(255, 204, 0, 0.3);
            overflow: hidden;
        }
        
        .ship-animation {
            position: absolute;
            font-size: 40px;
            transition: all 2s ease-in-out;
            z-index: 10;
        }
        
        .ship-success {
            left: 0;
            transform: translateX(0);
        }
        
        .ship-crossing {
            left: 100%;
            transform: translateX(-100%);
        }
        
        .ship-explosion {
            font-size: 50px;
            animation: explode 0.5s forwards;
        }
        
        .ship-sunk {
            font-size: 30px;
            opacity: 0.7;
        }
        
        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.8; }
            100% { transform: scale(0.5); opacity: 0; }
        }
        
        .water-effect {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to top, rgba(52, 152, 219, 0.7), transparent);
            z-index: 5;
        }
        
        .wave {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 10px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25" fill="%233498db"/><path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" opacity=".5" fill="%233498db"/><path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="%233498db"/></svg>');
            background-size: 1200px 100%;
            animation: wave 12s linear infinite;
        }
        
        @keyframes wave {
            0% { background-position-x: 0; }
            100% { background-position-x: 1200px; }
        }
        
        .success-sparkles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20;
        }
        
        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ffcc00;
            border-radius: 50%;
            box-shadow: 0 0 10px #ffcc00;
            animation: sparkleFloat 2s ease-out forwards;
        }
        
        @keyframes sparkleFloat {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-100px) scale(0); opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- æ–°å¢æ–°æ‰‹å¼•å¯¼é®ç½©å±‚ -->
    <div id="tutorial-overlay">
        <div class="tutorial-container">
            <div class="tutorial-content">
                <div class="tutorial-header">
                    <h2>âš“ JavaScriptæ¸¯æ–°æ‰‹æŒ‡å¯¼</h2>
                    <button class="tutorial-skip" onclick="skipTutorial()">è·³è¿‡æŒ‡å¯¼</button>
                </div>
                <div class="tutorial-body">
                    <div class="tutorial-step active" id="tutorial-step-1">
                        <h3>æ¬¢è¿æ¥åˆ°JavaScriptæ¸¯ï¼</h3>
                        <p>è¿™æ˜¯ä½ å­¦ä¹ JavaScriptäº¤äº’ç¼–ç¨‹çš„å†’é™©æ¸¯å£ã€‚ä½ å°†é€šè¿‡ä¿®å¤äº¤äº’åŠŸèƒ½å’Œç‚¹äº®èˆªæ ‡æ¥æŒæ¡JavaScriptæ ¸å¿ƒæ¦‚å¿µã€‚</p>
                        <p>æ¸¯å£åˆ†ä¸ºä¸‰ä¸ªä¸»è¦åŒºåŸŸï¼š</p>
                        <ul>
                            <li><strong>ä¸»çº¿ä»»åŠ¡</strong> - ä¿®å¤JavaScriptäº¤äº’åŠŸèƒ½</li>
                            <li><strong>èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜</strong> - è¯†åˆ«å’Œä¿®å¤æœ‰é—®é¢˜çš„ä»£ç </li>
                            <li><strong>éªŒè¯é¢æ¿</strong> - æ£€æŸ¥ä½ çš„ä»£ç æ˜¯å¦ç¬¦åˆæœ€ä½³å®è·µ</li>
                        </ul>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-2">
                        <h3>æ¸¸æˆç•Œé¢ä»‹ç»</h3>
                        <p>å·¦ä¾§æ˜¯<strong>äº¤äº’æ¼”ç¤ºåŒº</strong>ï¼Œæ˜¾ç¤ºJavaScriptæ‰§è¡Œæ•ˆæœå’Œèˆªæ ‡çŠ¶æ€ã€‚</p>
                        <p>å³ä¾§æ˜¯<strong>ä»£ç ç¼–è¾‘åŒº</strong>ï¼ŒåŒ…å«ä»»åŠ¡è¯´æ˜ã€JavaScriptç¼–è¾‘å™¨å’Œæ§åˆ¶æŒ‰é’®ã€‚</p>
                        <p>å³ä¸Šè§’æ˜¾ç¤ºä½ çš„<strong>æ¸¸æˆè¿›åº¦å’Œé‡‘å¸æ•°é‡</strong>ã€‚</p>
                        <div class="feature-list">
                            <div class="feature-item">ğŸ’¡ äº¤äº’æ¼”ç¤º - å®æ—¶æŸ¥çœ‹ä»£ç æ•ˆæœ</div>
                            <div class="feature-item">âš“ èˆªæ ‡çŠ¶æ€ - æ˜¾ç¤ºæŒ‘æˆ˜è¿›åº¦</div>
                            <div class="feature-item">ğŸ“œ ä»£ç ç¼–è¾‘å™¨ - ç¼–å†™JavaScriptä»£ç </div>
                            <div class="feature-item">ğŸ® æ§åˆ¶é¢æ¿ - æµ‹è¯•å’Œæäº¤ä»£ç </div>
                        </div>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-3">
                        <h3>ä¸»çº¿ä»»åŠ¡æ¨¡å¼</h3>
                        <p>åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œä½ éœ€è¦ä¿®å¤JavaScriptäº¤äº’åŠŸèƒ½ï¼š</p>
                        <ol>
                            <li>å®ç°<strong>äº‹ä»¶ç›‘å¬</strong> - å¤„ç†ç”¨æˆ·äº¤äº’</li>
                            <li>ä½¿ç”¨<strong>æ•°ç»„æ–¹æ³•</strong> - mapã€filterã€forEachç­‰</li>
                            <li>åˆ›å»º<strong>åŠ¨æ€å†…å®¹</strong> - æ›´æ–°DOMå…ƒç´ </li>
                            <li>å®ç°<strong>è¡¨å•éªŒè¯</strong> - éªŒè¯ç”¨æˆ·è¾“å…¥</li>
                            <li>æ·»åŠ <strong>åŠ¨ç”»æ•ˆæœ</strong> - å¢å¼ºç”¨æˆ·ä½“éªŒ</li>
                        </ol>
                        <p>ä½¿ç”¨<span class="code-highlight">æµ‹è¯•ä»£ç </span>æŒ‰é’®æ£€æŸ¥åŠŸèƒ½ï¼Œ<span class="code-highlight">å®ŒæˆæŒ‘æˆ˜</span>æäº¤ä»»åŠ¡ã€‚</p>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-4">
                        <h3>èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜</h3>
                        <p>åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œä½ éœ€è¦è¯†åˆ«å’Œä¿®å¤æœ‰é—®é¢˜çš„JavaScriptä»£ç ï¼š</p>
                        <ul>
                            <li>é˜…è¯»å‡ºç°çš„<strong>ä»£ç ç‰‡æ®µ</strong></li>
                            <li>åˆ¤æ–­ä»£ç æ˜¯å¦å­˜åœ¨<strong>é—®é¢˜æˆ–å¨èƒ</strong></li>
                            <li>é€‰æ‹©<strong>ä¿®å¤ä»£ç </strong>æˆ–<strong>å¿½ç•¥ä»£ç </strong></li>
                            <li>ä¿æŒ<strong>èˆªæ ‡çŠ¶æ€â‰¥80%</strong>æ‰èƒ½é€šå…³</li>
                        </ul>
                        <p>è®°ä½æ¯ä¸ªæ³¢æ¬¡çš„ä»£ç è§„åˆ™ï¼Œæ­£ç¡®åˆ¤æ–­å“ªäº›ä»£ç éœ€è¦ä¿®å¤ã€‚</p>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-5">
                        <h3>JavaScriptæ ¸å¿ƒæ¦‚å¿µ</h3>
                        <p>åœ¨JavaScriptæ¸¯ä¸­ï¼Œä½ å°†å­¦ä¹ ä»¥ä¸‹é‡è¦æ¦‚å¿µï¼š</p>
                        <div class="feature-list">
                            <div class="feature-item"><strong>äº‹ä»¶å¤„ç†</strong> - addEventListener, äº‹ä»¶å¯¹è±¡</div>
                            <div class="feature-item"><strong>DOMæ“ä½œ</strong> - è·å–å…ƒç´ , ä¿®æ”¹å†…å®¹, æ ·å¼æ“ä½œ</div>
                            <div class="feature-item"><strong>æ•°ç»„æ–¹æ³•</strong> - map, filter, reduce, forEach</div>
                            <div class="feature-item"><strong>å‡½æ•°ç¼–ç¨‹</strong> - å‡½æ•°å®šä¹‰, å‚æ•°ä¼ é€’, è¿”å›å€¼</div>
                            <div class="feature-item"><strong>å¼‚æ­¥ç¼–ç¨‹</strong> - setTimeout, äº‹ä»¶å¾ªç¯åŸºç¡€</div>
                            <div class="feature-item"><strong>ä»£ç è°ƒè¯•</strong> - console.log, é”™è¯¯å¤„ç†</div>
                        </div>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-6">
                        <h3>ä»™å¥³å¸®åŠ©ç³»ç»Ÿ</h3>
                        <p>å½“ä½ é‡åˆ°å›°éš¾æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»™å¥³å¸®åŠ©ç³»ç»Ÿï¼š</p>
                        <ul>
                            <li><strong>çº¿ç´¢æç¤º</strong> (1é‡‘å¸) - è·å¾—è§£å†³é—®é¢˜çš„å…³é”®çº¿ç´¢</li>
                            <li><strong>æ€è·¯æŒ‡å¯¼</strong> (2é‡‘å¸) - è·å¾—è¯¦ç»†çš„è§£å†³æ€è·¯</li>
                            <li><strong>å®Œæ•´ä»£ç </strong> (3é‡‘å¸) - è·å¾—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆ</li>
                        </ul>
                        <p>é€šè¿‡å®Œæˆä»»åŠ¡å’Œèˆªæ ‡æŒ‘æˆ˜å¯ä»¥è·å¾—æ›´å¤šé‡‘å¸ã€‚</p>
                    </div>
                    <div class="tutorial-step" id="tutorial-step-7">
                        <h3>å¼€å§‹JavaScriptå†’é™©ï¼</h3>
                        <p>ç°åœ¨ä½ å·²ç»äº†è§£äº†JavaScriptæ¸¯çš„åŸºæœ¬ç©æ³•ï¼Œå¯ä»¥å¼€å§‹ä½ çš„ç¼–ç¨‹å†’é™©äº†ï¼</p>
                        <p>è®°ä½ï¼šJavaScriptæ˜¯ç°ä»£ç½‘é¡µäº¤äº’çš„æ ¸å¿ƒï¼ŒæŒæ¡å®ƒå°†è®©ä½ èƒ½å¤Ÿåˆ›å»ºåŠ¨æ€ã€å“åº”å¼çš„ç”¨æˆ·ä½“éªŒã€‚</p>
                        <p>ç¥ä½ åœ¨JavaScriptæ¸¯çš„ç¼–ç¨‹ä¹‹æ—…æ„‰å¿«ï¼</p>
                        <div style="text-align: center; margin-top: 20px;">
                            <div style="font-size: 3em;">âš“âœ¨</div>
                            <p><strong>å‡†å¤‡å¥½ç‚¹äº®æ‰€æœ‰èˆªæ ‡äº†å—ï¼Ÿ</strong></p>
                        </div>
                    </div>
                </div>
                <div class="tutorial-progress">
                    <span>æ­¥éª¤</span>
                    <div class="progress-dots">
                        <div class="progress-dot active" id="dot-1" onclick="goToTutorialStep(1)"></div>
                        <div class="progress-dot" id="dot-2" onclick="goToTutorialStep(2)"></div>
                        <div class="progress-dot" id="dot-3" onclick="goToTutorialStep(3)"></div>
                        <div class="progress-dot" id="dot-4" onclick="goToTutorialStep(4)"></div>
                        <div class="progress-dot" id="dot-5" onclick="goToTutorialStep(5)"></div>
                        <div class="progress-dot" id="dot-6" onclick="goToTutorialStep(6)"></div>
                        <div class="progress-dot" id="dot-7" onclick="goToTutorialStep(7)"></div>
                    </div>
                </div>
                <div class="tutorial-controls">
                    <button class="btn btn-warning" id="tutorial-prev" onclick="prevTutorialStep()" style="display: none;">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-primary" id="tutorial-next" onclick="nextTutorialStep()">ä¸‹ä¸€æ­¥</button>
                    <button class="btn btn-success" id="tutorial-finish" onclick="finishTutorial()" style="display: none;">å¼€å§‹ç¼–ç¨‹</button>
                </div>
            </div>
        </div>
    </div>

    <!-- åŸæœ‰æ¸¸æˆå®¹å™¨ -->
    <div class="game-container">
        <div class="scanlines"></div>
        <div class="game-header">
            <div class="header-content">
                <h1 class="neon-text">âš“ JavaScriptæ¸¯</h1>
                <div class="player-stats">
                    <div class="stat">å…³å¡: 3/3</div>
                    <div class="stat">é‡‘å¸: <span class="gold-coin" id="gold-count">5</span> ğŸª™</div>
                    <div class="stat">è¿›åº¦: <span id="progress">0%</span></div>
                </div>
            </div>
        </div>

        <div class="game-body">
            <!-- å·¦ä¾§ï¼šæ¸¸æˆåœºæ™¯ -->
            <div class="scene-container">
                <!-- JavaScriptæ¸¯åœºæ™¯ -->
                <div class="scene-js" id="js-scene">
                    <h2>âš“ JavaScriptæ¸¯</h2>
                    <div class="pixel-scene">
                        <!-- ä¿®æ”¹ä¸ºèˆ¹ä½“å’Œèˆªæ ‡ -->
                        <div class="character-container">
                            <div class="ship-body">â›µ</div>
                            <div class="beacon" id="main-beacon">ğŸ’¡</div>
                        </div>
                        <div class="pixel-art">
                            <div class="pixel"></div><div class="pixel"></div><div class="pixel active"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div>
                        </div>
                        <div class="interactive-demo" id="interactive-demo">ç‚¹å‡»æˆ‘!</div>
                        <div class="scene-content">
                            <h3>æ¬¢è¿æ¥åˆ°JavaScriptæ¸¯ï¼</h3>
                            <p>æ¸¯å£çš„äº¤äº’ç³»ç»Ÿå‡ºç°äº†æ•…éšœï¼ä½¿ç”¨JavaScriptä¿®å¤åŠŸèƒ½é—®é¢˜...</p>
                        </div>
                        <div class="interactive-area">
                            <div class="interactive-element" id="element-1">å…ƒç´ 1</div>
                            <div class="interactive-element" id="element-2">å…ƒç´ 2</div>
                            <div class="interactive-element" id="element-3">å…ƒç´ 3</div>
                            <div class="interactive-element" id="element-4">å…ƒç´ 4</div>
                        </div>
                        <div class="console-output" id="console-output">
                            > æ§åˆ¶å°è¾“å‡ºåŒºåŸŸ<br>
                            > ç­‰å¾…JavaScriptä»£ç æ‰§è¡Œ...
                        </div>
                        <div class="js-preview" id="js-preview">
                            <!-- JavaScripté¢„è§ˆå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                        </div>
                    </div>
                </div>

                <!-- HTMLé•‡åœºæ™¯ -->
                <div class="scene-html" id="html-scene">
                    <h2>JavaScriptæ¸¯</h2>
                    <div class="pixel-scene">
                        <!-- ä¿®æ”¹ä¸ºèˆ¹ä½“å’Œèˆªæ ‡ -->
                        <div class="character-container">
                            <div class="ship-body">â›µ</div>
                            <div class="beacon" id="html-beacon">ğŸ’¡</div>
                        </div>
                        <div class="scene-content">
                            <h3>ä¿å«å°èˆ¹</h3>
                            <p>"åŒ–èº«èˆªèˆ¹é¢†èˆªå‘˜ï¼"</p>
                            <p>åœ¨ä¿¡æ¯æµ·åŸŸä¸­æŠµå¾¡æš—ç¤è¿·é›¾çš„ä¾µèš€ï¼Œä¾æ®èˆªæµ·è§„åˆ™è¯†åˆ«å±é™©æ°´åŸŸå¹¶æ¸…é™¤éšœç¢</p>
                            <p>ç‚¹äº®å®‰å…¨èˆªæ ‡ï¼Œå®ˆæŠ¤èˆªé“ç•…é€šã€‚</p>
                            <div class="score-display">å¾—åˆ†ï¼š<span id="semantic-score">0</span></div>
                        </div>
                        <div class="semantic-attack" id="semantic-attack">
                            <div class="semantic-content" id="semantic-content">
                                <!-- è¯­ä¹‰æ”»å‡»å†…å®¹å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šä»»åŠ¡å’Œä»£ç ç¼–è¾‘ -->
            <div class="task-container">
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="js-task" data-scene="js-scene">ä¸»çº¿ä»»åŠ¡</button>
                        <button class="tab-button" data-tab="html-task" data-scene="html-scene">èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜</button>
                        <button class="tab-button" data-tab="validation" data-scene="js-scene">éªŒè¯é¢æ¿</button>
                    </div>
                    <div class="tab-content active" id="js-task">
                        <h2 class="task-title">ğŸ“ ä»»åŠ¡ç›®æ ‡</h2>
                        <div class="task-description">
                            <p>JavaScriptæ¸¯çš„äº¤äº’åŠŸèƒ½å‡ºç°äº†æ•…éšœï¼è¯·ä½¿ç”¨JavaScriptä¿®å¤ä»¥ä¸‹åŠŸèƒ½é—®é¢˜ï¼š</p>
                            <ul class="task-steps">
                                <li>å®ç°äº‹ä»¶ç›‘å¬å’ŒDOMæ“ä½œ</li>
                                <li>ä½¿ç”¨æ•°ç»„æ–¹æ³•å¤„ç†æ•°æ®</li>
                                <li>åˆ›å»ºåŠ¨æ€å†…å®¹æ›´æ–°</li>
                                <li>å®ç°ç®€å•çš„è¡¨å•éªŒè¯</li>
                                <li>å¤„ç†ç”¨æˆ·äº¤äº’å’ŒåŠ¨ç”»</li>
                            </ul>
                        </div>

                        <div class="code-editor">
                            <div class="editor-header">
                                <span>ğŸ“œ script.js</span>
                                <span>JavaScriptä»£ç </span>
                            </div>
                            <textarea class="code-area" id="js-code" placeholder="åœ¨è¿™é‡Œç¼–å†™ä½ çš„JavaScriptä»£ç ...">
// JavaScriptæ¸¯äº¤äº’æŒ‘æˆ˜

// ä»»åŠ¡1: å®ç°ç‚¹å‡»äº‹ä»¶å¤„ç†
document.getElementById('interactive-demo').addEventListener('click', function() {
    // åœ¨è¿™é‡Œæ·»åŠ ç‚¹å‡»äº‹ä»¶çš„å¤„ç†ä»£ç 
    console.log('äº¤äº’å…ƒç´ è¢«ç‚¹å‡»äº†ï¼');
});

// ä»»åŠ¡2: å®ç°é¼ æ ‡æ‚¬åœäº‹ä»¶
document.getElementById('interactive-demo').addEventListener('mouseover', function() {
    // åœ¨è¿™é‡Œæ·»åŠ é¼ æ ‡æ‚¬åœäº‹ä»¶çš„å¤„ç†ä»£ç 
});

document.getElementById('interactive-demo').addEventListener('mouseout', function() {
    // åœ¨è¿™é‡Œæ·»åŠ é¼ æ ‡ç¦»å¼€äº‹ä»¶çš„å¤„ç†ä»£ç 
});

// ä»»åŠ¡3: ä½¿ç”¨æ•°ç»„æ–¹æ³•
const items = ['å®å‰‘', 'è¯æ°´', 'é‡‘å¸', 'åœ°å›¾', 'é’¥åŒ™'];

// ä½¿ç”¨æ•°ç»„æ–¹æ³•å¤„ç†ç‰©å“
function processItems() {
    // åœ¨è¿™é‡Œæ·»åŠ æ•°ç»„æ–¹æ³•çš„ä»£ç 
    console.log('å¤„ç†ç‰©å“æ•°ç»„:', items);
}

// ä»»åŠ¡4: åŠ¨æ€å†…å®¹æ›´æ–°
function updateContent() {
    // åœ¨è¿™é‡Œæ·»åŠ åŠ¨æ€æ›´æ–°å†…å®¹çš„ä»£ç 
    const output = document.getElementById('console-output');
    output.innerHTML += '> å†…å®¹å·²æ›´æ–°<br>';
}

// ä»»åŠ¡5: è¡¨å•éªŒè¯å‡½æ•°
function validateForm() {
    // åœ¨è¿™é‡Œæ·»åŠ è¡¨å•éªŒè¯çš„ä»£ç 
    console.log('è¡¨å•éªŒè¯åŠŸèƒ½å·²è°ƒç”¨');
    return true;
}

// åˆå§‹åŒ–å‡½æ•°
function initJS() {
    console.log('JavaScriptæ¸¯åˆå§‹åŒ–å®Œæˆ');
    // åœ¨è¿™é‡Œæ·»åŠ åˆå§‹åŒ–ä»£ç 
}</textarea>
                        </div>

                        <div class="fairy-assistant">
                            <div class="fairy-header">
                                <div class="fairy-avatar">ğŸ§šâ€â™€ï¸</div>
                                <h3>ä»™å¥³ä¸‹å‡¡</h3>
                            </div>
                            <p>ğŸ§šâ€â™€ï¸ é‡åˆ°å›°éš¾å—ï¼Ÿè¯·ä½ æ”¯ä»˜é‡‘å¸ç»™æˆ‘</p>
                            <div class="help-levels">
                                <button class="help-btn level-1" onclick="getHelp(1)">
                                    ğŸ’¡ çº¿ç´¢æç¤º (1ğŸª™)
                                </button>
                                <button class="help-btn level-2" onclick="getHelp(2)">
                                    ğŸ¯ æ€è·¯æŒ‡å¯¼ (2ğŸª™)
                                </button>
                                <button class="help-btn level-3" onclick="getHelp(3)">
                                    ğŸ”§ å®Œæ•´ä»£ç  (3ğŸª™)
                                </button>
                            </div>
                            <div class="fairy-response" id="fairy-response">
                                <!-- ä»™å¥³å›å¤å†…å®¹ -->
                            </div>
                        </div>

                        <div class="controls">
                            <button class="btn btn-warning" onclick="resetCode()">ğŸ”„ é‡ç½®ä»£ç </button>
                            <button class="btn btn-primary" onclick="testCode()">ğŸ§ª æµ‹è¯•ä»£ç </button>
                            <button class="btn btn-success" onclick="submitCode()">ğŸš€ å®ŒæˆæŒ‘æˆ˜</button>
                        </div>

                        <div class="completion-badge" id="completion-badge">
                            ğŸ‰ æ­å–œå®Œæˆæ‰€æœ‰æŒ‘æˆ˜ï¼ä½ å·²æˆä¸ºå‰ç«¯å¤§å¸ˆï¼
                        </div>
                    </div>
                    
                    <div class="tab-content" id="html-task">
                        <h2 class="task-title">ğŸ“ èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜</h2>
                        <div class="task-description">
                            <p>JavaScriptæ¸¯çš„èˆªæ ‡ç³»ç»Ÿå‡ºç°äº†æ•…éšœï¼è¯·ç‚¹äº®èˆªæ ‡ï¼š</p>
                            <ul class="task-steps">
                                <li>ç¬¬ä¸€æ³¢: ä¿®å¤äº‹ä»¶ç»‘å®š</li>
                                <li>ç¬¬äºŒæ³¢: ä¼˜åŒ–æ•°æ®å¤„ç†</li>
                                <li>ç¬¬ä¸‰æ³¢: æå‡DOMæ“ä½œæ•ˆç‡</li>
                                <li>ç‚¹äº®æ‰€æœ‰èˆªæ ‡æ‰èƒ½é€šå…³</li>
                            </ul>
                        </div>
                        
                        <div class="defense-challenge">
                            <div class="defense-header">
                                <span>ğŸ’¡ èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜</span>
                            </div>
                            
                            <!-- ä¿®æ”¹ä¸ºèˆªæ ‡æ˜¾ç¤º -->
                            <div class="beacon-display">
                                <div class="beacon-icon">ğŸ’¡</div>
                                <div class="beacon-info">
                                    <div class="beacon-label">èˆªæ ‡çŠ¶æ€</div>
                                    <div class="beacon-value" id="beacon-status">40%</div>
                                </div>
                                <div class="beacon-bar-container">
                                    <div class="beacon-bar" id="beacon-fill" style="width: 40%;">
                                        <div class="beacon-status">40%</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- èˆªæ ‡ç‚¹äº®è¿›åº¦ -->
                            <div class="beacon-progress">
                                <div class="beacon-light" id="beacon-1"></div>
                                <div class="beacon-light" id="beacon-2"></div>
                                <div class="beacon-light" id="beacon-3"></div>
                                <div class="beacon-light" id="beacon-4"></div>
                                <div class="beacon-light" id="beacon-5"></div>
                            </div>
                            
                            <!-- å°èˆ¹åŠ¨ç”»åŒºåŸŸ -->
                            <div class="ship-animation-area">
                                <div class="water-effect"></div>
                                <div class="wave"></div>
                                <div class="ship-animation ship-success" id="ship-animation">â›µ</div>
                            </div>
                            
                            <div class="wave-indicator">
                                <div class="wave-dot" id="beacon-wave-1"></div>
                                <div class="wave-dot" id="beacon-wave-2"></div>
                                <div class="wave-dot" id="beacon-wave-3"></div>
                            </div>
                            
                            <div class="timer" id="beacon-timer">5</div>
                            
                            <div class="script-attack" id="beacon-script-attack">
                                <div class="script-content" id="beacon-script-content"></div>
                                <div class="defense-controls">
                                    <button class="defense-btn fix" id="beacon-fix-btn">ä¿®å¤ä»£ç </button>
                                    <button class="defense-btn ignore" id="beacon-ignore-btn">å¿½ç•¥ä»£ç </button>
                                </div>
                            </div>
                            
                            <div class="defense-result" id="beacon-defense-result"></div>
                            
                            <div class="controls">
                                <button class="btn btn-warning" id="start-beacon-defense">å¼€å§‹ç‚¹äº®</button>
                                <button class="btn btn-primary" id="beacon-show-guide">ç‚¹äº®æŒ‡å—</button>
                                <button class="btn btn-success" id="beacon-restart-defense" style="display: none;">é‡æ–°ç‚¹äº®</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="validation">
                        <h2 class="task-title">ğŸ“ éªŒè¯é¢æ¿</h2>
                        
                        <div class="validation-panel">
                            <div class="validation-title">JavaScriptæœ€ä½³å®è·µ</div>
                            <div class="validation-item">
                                <div class="validation-check" id="check-event">!</div>
                                <div class="validation-text">äº‹ä»¶ç›‘å¬ï¼šä¼˜å…ˆä½¿ç”¨ addEventListener</div>
                            </div>
                            <div class="validation-item">
                                <div class="validation-check" id="check-data">!</div>
                                <div class="validation-text">æ•°æ®å¤„ç†ï¼šå–„ç”¨ map/filter/reduce</div>
                            </div>
                            <div class="validation-item">
                                <div class="validation-check" id="check-dom">!</div>
                                <div class="validation-text">åŠ¨æ€æ›´æ–°ï¼šé¿å…é¢‘ç¹æ“ä½œ innerHTML</div>
                            </div>
                            <div class="validation-item">
                                <div class="validation-check" id="check-form">!</div>
                                <div class="validation-text">è¡¨å•éªŒè¯ï¼šå®æ—¶æ ¡éªŒ + é”™è¯¯æç¤º</div>
                            </div>
                            <div class="validation-item">
                                <div class="validation-check" id="check-animation">!</div>
                                <div class="validation-text">åŠ¨ç”»ä¼˜åŒ–ï¼šä½¿ç”¨ requestAnimationFrame æˆ– transition</div>
                            </div>
                        </div>
                        
                        <div class="fairy-assistant">
                            <div class="fairy-header">
                                <div class="fairy-avatar">ğŸ§šâ€â™€ï¸</div>
                                <h3>ä»™å¥³ä¸‹å‡¡</h3>
                            </div>
                            <p>ğŸ§šâ€â™€ï¸ è¯·é€‰æ‹©å¸®åŠ©ç±»å‹ï¼š</p>
                            <div class="help-levels">
                                <button class="help-btn level-1" onclick="getValidationHelp(1)">
                                    ğŸ’¡ åˆ é™¤æŒ‡å¯¼ (1ğŸª™)
                                </button>
                                <button class="help-btn level-2" onclick="getValidationHelp(2)">
                                    ğŸ¯ é˜²å¾¡æŒ‡å¯¼ (2ğŸª™)
                                </button>
                                <button class="help-btn level-3" onclick="getValidationHelp(3)">
                                    ğŸ”§ é‡ç½®ä»£ç  (3ğŸª™)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ–°æ‰‹æŒ‡å¯¼çŠ¶æ€
        const tutorialState = {
            currentStep: 1,
            totalSteps: 7,
            completed: false
        };

        // æ˜¾ç¤ºæ–°æ‰‹æŒ‡å¯¼
        function showTutorial() {
            // æ£€æŸ¥æ˜¯å¦å·²ç»å®Œæˆè¿‡æŒ‡å¯¼
            const tutorialCompleted = localStorage.getItem('jsHarborTutorialCompleted');
            
            if (tutorialCompleted === 'true') {
                return; // å¦‚æœå·²ç»å®Œæˆè¿‡ï¼Œåˆ™ä¸æ˜¾ç¤º
            }
            
            document.getElementById('tutorial-overlay').style.display = 'flex';
            updateTutorialStep();
        }

        // æ›´æ–°æ–°æ‰‹æŒ‡å¯¼æ­¥éª¤
        function updateTutorialStep() {
            // éšè—æ‰€æœ‰æ­¥éª¤
            for (let i = 1; i <= tutorialState.totalSteps; i++) {
                document.getElementById(`tutorial-step-${i}`).classList.remove('active');
            }
            
            // æ˜¾ç¤ºå½“å‰æ­¥éª¤
            document.getElementById(`tutorial-step-${tutorialState.currentStep}`).classList.add('active');
            
            // æ›´æ–°è¿›åº¦ç‚¹
            for (let i = 1; i <= tutorialState.totalSteps; i++) {
                const dot = document.getElementById(`dot-${i}`);
                if (i === tutorialState.currentStep) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            }
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const prevBtn = document.getElementById('tutorial-prev');
            const nextBtn = document.getElementById('tutorial-next');
            const finishBtn = document.getElementById('tutorial-finish');
            
            if (tutorialState.currentStep === 1) {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'block';
                finishBtn.style.display = 'none';
            } else if (tutorialState.currentStep === tutorialState.totalSteps) {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'none';
                finishBtn.style.display = 'block';
            } else {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'block';
                finishBtn.style.display = 'none';
            }
        }

        // è·³è½¬åˆ°æŒ‡å®šæ­¥éª¤
        function goToTutorialStep(step) {
            tutorialState.currentStep = step;
            updateTutorialStep();
        }

        // ä¸‹ä¸€æ­¥
        function nextTutorialStep() {
            if (tutorialState.currentStep < tutorialState.totalSteps) {
                tutorialState.currentStep++;
                updateTutorialStep();
            }
        }

        // ä¸Šä¸€æ­¥
        function prevTutorialStep() {
            if (tutorialState.currentStep > 1) {
                tutorialState.currentStep--;
                updateTutorialStep();
            }
        }

        // å®ŒæˆæŒ‡å¯¼
        function finishTutorial() {
            document.getElementById('tutorial-overlay').style.display = 'none';
            tutorialState.completed = true;
            
            // å°†å®ŒæˆçŠ¶æ€ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('jsHarborTutorialCompleted', 'true');
            
            // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
            showFeedback('ğŸ‰ æ¬¢è¿æ¥åˆ°JavaScriptæ¸¯ï¼å¼€å§‹ä½ çš„ç¼–ç¨‹å†’é™©å§ï¼', 'success');
            
            // æ·»åŠ ä¸€äº›åˆå§‹ç‰¹æ•ˆ
            createSparkles();
            lightBeacon('main-beacon');
        }

        // è·³è¿‡æŒ‡å¯¼
        function skipTutorial() {
            if (confirm('ç¡®å®šè¦è·³è¿‡æ–°æ‰‹æŒ‡å¯¼å—ï¼Ÿä½ å¯ä»¥åœ¨è®¾ç½®ä¸­é‡æ–°æŸ¥çœ‹æŒ‡å¯¼ã€‚')) {
                finishTutorial();
            }
        }

        // åŸæœ‰çš„æ¸¸æˆçŠ¶æ€å’Œå‡½æ•°
        let goldCoins = 5;
        let progress = 0;

        // åˆ›å»ºä»™å¥³é—ªçƒæ•ˆæœ
        function createSparkles() {
            const fairyAssistant = document.querySelector('.fairy-assistant');
            for (let i = 0; i < 5; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'fairy-sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                fairyAssistant.appendChild(sparkle);
            }
        }

        // æ›´æ–°UIæ˜¾ç¤º
        function updateUI() {
            document.getElementById('gold-count').textContent = goldCoins;
            document.getElementById('progress').textContent = progress + '%';
        }

        // æ›´æ–°æ§åˆ¶å°è¾“å‡º
        function updateConsole(message) {
            const consoleOutput = document.getElementById('console-output');
            consoleOutput.innerHTML += `> ${message}<br>`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        // ç‚¹äº®èˆªæ ‡
        function lightBeacon(beaconId) {
            const beacon = document.getElementById(beaconId);
            beacon.classList.add('lit');
        }

        // ç†„ç­èˆªæ ‡
        function dimBeacon(beaconId) {
            const beacon = document.getElementById(beaconId);
            beacon.classList.remove('lit');
        }

        // æ‰§è¡ŒJavaScriptä»£ç 
        function executeJSCode() {
            const code = document.getElementById('js-code').value;
            const preview = document.getElementById('js-preview');
            
            try {
                // æ¸…ç©ºé¢„è§ˆåŒºåŸŸ
                preview.innerHTML = '';
                
                // åˆ›å»ºç¤ºä¾‹HTMLç»“æ„
                const htmlStructure = `
                    <div class="demo-container">
                        <h4>JavaScriptäº¤äº’æ¼”ç¤º</h4>
                        <p>ä»£ç æ‰§è¡Œç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
                        <button id="demo-button" style="background: #ffcc00; color: #1a1a1a; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; margin: 5px;">æµ‹è¯•æŒ‰é’®</button>
                        <div id="demo-output" style="margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 4px;"></div>
                    </div>
                `;
                
                preview.innerHTML = htmlStructure;
                
                // æ‰§è¡ŒJavaScriptä»£ç 
                eval(code);
                
                // åˆå§‹åŒ–JS
                if (typeof initJS === 'function') {
                    initJS();
                    updateConsole('JavaScriptåˆå§‹åŒ–å®Œæˆ');
                }
                
                // ä¸ºæ¼”ç¤ºæŒ‰é’®æ·»åŠ äº‹ä»¶
                const demoButton = document.getElementById('demo-button');
                if (demoButton) {
                    demoButton.addEventListener('click', function() {
                        const demoOutput = document.getElementById('demo-output');
                        demoOutput.innerHTML = 'æŒ‰é’®ç‚¹å‡»äº‹ä»¶å·²è§¦å‘ï¼';
                        updateConsole('æ¼”ç¤ºæŒ‰é’®è¢«ç‚¹å‡»');
                    });
                }
                
                return true;
            } catch (error) {
                updateConsole(`é”™è¯¯: ${error.message}`);
                return false;
            }
        }

        // ä»™å¥³å¸®åŠ©ç³»ç»Ÿ
        function getHelp(level) {
            if (goldCoins < level) {
                alert('é‡‘å¸ä¸è¶³ï¼è¯·å®Œæˆæ›´å¤šä»»åŠ¡æ¥è·å–é‡‘å¸ã€‚');
                return;
            }

            goldCoins -= level;
            updateUI();

            const response = document.getElementById('fairy-response');
            let helpMessage = '';

            switch(level) {
                case 1:
                    helpMessage = `
                    ğŸ’¡ <strong>JavaScriptæç¤ºï¼š</strong>
                    <ul>
                        <li>äº‹ä»¶ç›‘å¬: addEventListener('click', function)</li>
                        <li>DOMæ“ä½œ: getElementById, innerHTML, classList</li>
                        <li>æ•°ç»„æ–¹æ³•: filter, map, forEach, reduce</li>
                        <li>å‡½æ•°å®šä¹‰: function name() { } æˆ–ç®­å¤´å‡½æ•°</li>
                        <li>æ§åˆ¶å°è¾“å‡º: console.log()</li>
                    </ul>
                    `;
                    break;
                case 2:
                    helpMessage = `
                    ğŸ¯ <strong>ç¼–ç¨‹æ€è·¯ï¼š</strong>
                    <ol>
                        <li>ä¸ºäº¤äº’å…ƒç´ æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨</li>
                        <li>ä½¿ç”¨æ•°ç»„æ–¹æ³•å¤„ç†æ•°æ®é›†åˆ</li>
                        <li>åˆ›å»ºå‡½æ•°æ¥åŠ¨æ€æ›´æ–°é¡µé¢å†…å®¹</li>
                        <li>å®ç°è¡¨å•éªŒè¯é€»è¾‘</li>
                        <li>æ·»åŠ é¼ æ ‡æ‚¬åœæ•ˆæœå¢å¼ºäº¤äº’æ€§</li>
                    </ol>
                    `;
                    break;
                case 3:
                    helpMessage = `
                    ğŸ”§ <strong>å®Œæ•´JavaScriptä»£ç ç¤ºä¾‹ï¼š</strong>
                    <div class="code-snippet">
// JavaScriptæ¸¯äº¤äº’æŒ‘æˆ˜

// ä»»åŠ¡1: å®ç°ç‚¹å‡»äº‹ä»¶å¤„ç†
document.getElementById('interactive-demo').addEventListener('click', function() {
    console.log('äº¤äº’å…ƒç´ è¢«ç‚¹å‡»äº†ï¼');
    this.style.backgroundColor = '#ff6600';
    this.textContent = 'ç‚¹å‡»æˆåŠŸï¼';
    updateConsole('äº¤äº’å…ƒç´ è¢«ç‚¹å‡»');
});

// ä»»åŠ¡2: å®ç°é¼ æ ‡æ‚¬åœäº‹ä»¶
document.getElementById('interactive-demo').addEventListener('mouseover', function() {
    this.style.transform = 'scale(1.1)';
    this.style.boxShadow = '0 0 20px #ffcc00';
});

document.getElementById('interactive-demo').addEventListener('mouseout', function() {
    this.style.transform = 'scale(1)';
    this.style.boxShadow = '0 0 15px rgba(255, 204, 0, 0.7)';
});

// ä»»åŠ¡3: ä½¿ç”¨æ•°ç»„æ–¹æ³•
const items = ['å®å‰‘', 'è¯æ°´', 'é‡‘å¸', 'åœ°å›¾', 'é’¥åŒ™'];

// ä½¿ç”¨æ•°ç»„æ–¹æ³•å¤„ç†ç‰©å“
function processItems() {
    // è¿‡æ»¤å‡ºé•¿åº¦å¤§äº2çš„ç‰©å“
    const filteredItems = items.filter(item => item.length > 2);
    
    // æ˜ å°„ä¸ºå¸¦ç¼–å·çš„ç‰©å“
    const numberedItems = filteredItems.map((item, index) => \`\${index + 1}. \${item}\`);
    
    console.log('å¤„ç†åçš„ç‰©å“:', numberedItems);
    updateConsole('ç‰©å“å¤„ç†å®Œæˆ: ' + numberedItems.join(', '));
    
    return filteredItems;
}

// ä»»åŠ¡4: åŠ¨æ€å†…å®¹æ›´æ–°
function updateContent() {
    const output = document.getElementById('console-output');
    output.innerHTML += '> åŠ¨æ€å†…å®¹å·²æ›´æ–°<br>';
    
    // æ›´æ–°äº¤äº’å…ƒç´ æ–‡æœ¬
    const interactiveElements = document.querySelectorAll('.interactive-element');
    interactiveElements.forEach((element, index) => {
        element.textContent = \`æ›´æ–° \${index + 1}\`;
    });
}

// ä»»åŠ¡5: è¡¨å•éªŒè¯å‡½æ•°
function validateForm() {
    // æ¨¡æ‹Ÿè¡¨å•éªŒè¯
    const username = 'testUser';
    const email = 'test@example.com';
    
    if (!username || username.length < 3) {
        console.log('ç”¨æˆ·åæ— æ•ˆ');
        return false;
    }
    
    if (!email || !email.includes('@')) {
        console.log('é‚®ç®±åœ°å€æ— æ•ˆ');
        return false;
    }
    
    console.log('è¡¨å•éªŒè¯æˆåŠŸ');
    updateConsole('è¡¨å•éªŒè¯é€šè¿‡');
    return true;
}

// åˆå§‹åŒ–å‡½æ•°
function initJS() {
    console.log('JavaScriptæ¸¯åˆå§‹åŒ–å®Œæˆ');
    updateConsole('ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
    
    // ä¸ºæ‰€æœ‰äº¤äº’å…ƒç´ æ·»åŠ ç‚¹å‡»äº‹ä»¶
    const interactiveElements = document.querySelectorAll('.interactive-element');
    interactiveElements.forEach(element => {
        element.addEventListener('click', function() {
            this.style.backgroundColor = '#ff6600';
            this.style.color = 'white';
            updateConsole(\`\${this.textContent} è¢«ç‚¹å‡»\`);
        });
    });
}
                    </div>
                    <button class="insert-code-btn" onclick="insertFullCode()">æ’å…¥å®Œæ•´ä»£ç </button>
                    `;
                    break;
            }

            response.innerHTML = helpMessage;
            response.style.display = 'block';
            
            // æ·»åŠ ä»™å¥³ç‰¹æ•ˆ
            createSparkles();
        }

        // æ’å…¥å®Œæ•´ä»£ç 
        function insertFullCode() {
            const fullCode = `// JavaScriptæ¸¯äº¤äº’æŒ‘æˆ˜

// ä»»åŠ¡1: å®ç°ç‚¹å‡»äº‹ä»¶å¤„ç†
document.getElementById('interactive-demo').addEventListener('click', function() {
    console.log('äº¤äº’å…ƒç´ è¢«ç‚¹å‡»äº†ï¼');
    this.style.backgroundColor = '#ff6600';
    this.textContent = 'ç‚¹å‡»æˆåŠŸï¼';
    updateConsole('äº¤äº’å…ƒç´ è¢«ç‚¹å‡»');
});

// ä»»åŠ¡2: å®ç°é¼ æ ‡æ‚¬åœäº‹ä»¶
document.getElementById('interactive-demo').addEventListener('mouseover', function() {
    this.style.transform = 'scale(1.1)';
    this.style.boxShadow = '0 0 20px #ffcc00';
});

document.getElementById('interactive-demo').addEventListener('mouseout', function() {
    this.style.transform = 'scale(1)';
    this.style.boxShadow = '0 0 15px rgba(255, 204, 0, 0.7)';
});

// ä»»åŠ¡3: ä½¿ç”¨æ•°ç»„æ–¹æ³•
const items = ['å®å‰‘', 'è¯æ°´', 'é‡‘å¸', 'åœ°å›¾', 'é’¥åŒ™'];

// ä½¿ç”¨æ•°ç»„æ–¹æ³•å¤„ç†ç‰©å“
function processItems() {
    // è¿‡æ»¤å‡ºé•¿åº¦å¤§äº2çš„ç‰©å“
    const filteredItems = items.filter(item => item.length > 2);
    
    // æ˜ å°„ä¸ºå¸¦ç¼–å·çš„ç‰©å“
    const numberedItems = filteredItems.map((item, index) => \`\${index + 1}. \${item}\`);
    
    console.log('å¤„ç†åçš„ç‰©å“:', numberedItems);
    updateConsole('ç‰©å“å¤„ç†å®Œæˆ: ' + numberedItems.join(', '));
    
    return filteredItems;
}

// ä»»åŠ¡4: åŠ¨æ€å†…å®¹æ›´æ–°
function updateContent() {
    const output = document.getElementById('console-output');
    output.innerHTML += '> åŠ¨æ€å†…å®¹å·²æ›´æ–°<br>';
    
    // æ›´æ–°äº¤äº’å…ƒç´ æ–‡æœ¬
    const interactiveElements = document.querySelectorAll('.interactive-element');
    interactiveElements.forEach((element, index) => {
        element.textContent = \`æ›´æ–° \${index + 1}\`;
    });
}

// ä»»åŠ¡5: è¡¨å•éªŒè¯å‡½æ•°
function validateForm() {
    // æ¨¡æ‹Ÿè¡¨å•éªŒè¯
    const username = 'testUser';
    const email = 'test@example.com';
    
    if (!username || username.length < 3) {
        console.log('ç”¨æˆ·åæ— æ•ˆ');
        return false;
    }
    
    if (!email || !email.includes('@')) {
        console.log('é‚®ç®±åœ°å€æ— æ•ˆ');
        return false;
    }
    
    console.log('è¡¨å•éªŒè¯æˆåŠŸ');
    updateConsole('è¡¨å•éªŒè¯é€šè¿‡');
    return true;
}

// åˆå§‹åŒ–å‡½æ•°
function initJS() {
    console.log('JavaScriptæ¸¯åˆå§‹åŒ–å®Œæˆ');
    updateConsole('ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
    
    // ä¸ºæ‰€æœ‰äº¤äº’å…ƒç´ æ·»åŠ ç‚¹å‡»äº‹ä»¶
    const interactiveElements = document.querySelectorAll('.interactive-element');
    interactiveElements.forEach(element => {
        element.addEventListener('click', function() {
            this.style.backgroundColor = '#ff6600';
            this.style.color = 'white';
            updateConsole(\`\${this.textContent} è¢«ç‚¹å‡»\`);
        });
    });
}`;
            
            document.getElementById('js-code').value = fullCode;
            executeJSCode();
            
            // éšè—ä»™å¥³å“åº”
            document.getElementById('fairy-response').style.display = 'none';
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            showFeedback('å®Œæ•´ä»£ç å·²æ’å…¥åˆ°ç¼–è¾‘å™¨ä¸­ï¼', 'success');
        }

        // æµ‹è¯•ä»£ç 
        function testCode() {
            if (!executeJSCode()) {
                showFeedback('JavaScriptä»£ç æœ‰è¯­æ³•é”™è¯¯ï¼Œè¯·æ£€æŸ¥', 'error');
                return;
            }
            
            try {
                // éªŒè¯JavaScriptåŠŸèƒ½
                let score = 0;
                const features = [
                    { test: () => typeof processItems === 'function', points: 20, name: 'æ•°ç»„æ–¹æ³•' },
                    { test: () => typeof validateForm === 'function', points: 20, name: 'è¡¨å•éªŒè¯' },
                    { test: () => typeof updateContent === 'function', points: 20, name: 'åŠ¨æ€æ›´æ–°' },
                    { test: () => document.getElementById('interactive-demo').onclick !== null, points: 20, name: 'äº‹ä»¶å¤„ç†' },
                    { test: () => typeof initJS === 'function', points: 20, name: 'åˆå§‹åŒ–å‡½æ•°' }
                ];
                
                features.forEach(feature => {
                    try {
                        if (feature.test()) {
                            score += feature.points;
                        }
                    } catch (e) {
                        // å¿½ç•¥æµ‹è¯•é”™è¯¯
                    }
                });
                
                progress = Math.max(progress, score);
                updateUI();
                
                if (score >= 60) {
                    // æ›´æ–°åœºæ™¯é¢„è§ˆ
                    const sceneContent = document.querySelector('.scene-content');
                    sceneContent.innerHTML = `
                        <h3>âœ… ä»£ç éªŒè¯é€šè¿‡ï¼</h3>
                        <p>JavaScriptåŠŸèƒ½åŸºæœ¬æ­£ç¡®ï¼Œäº¤äº’ç³»ç»Ÿå¼€å§‹æ¢å¤...</p>
                        <p>èˆªæ ‡æ­£åœ¨ç‚¹äº®ï¼</p>
                    `;
                    // ç‚¹äº®ä¸»èˆªæ ‡
                    lightBeacon('main-beacon');
                    showFeedback('ä»£ç éªŒè¯é€šè¿‡ï¼JavaScriptåŠŸèƒ½æ­£ç¡®ã€‚', 'success');
                } else {
                    showFeedback(`ä»£ç è¿˜éœ€å®Œå–„ï¼Œå½“å‰æ£€æµ‹åˆ° ${score}% çš„å…³é”®åŠŸèƒ½`, 'error');
                }
                
            } catch (error) {
                showFeedback(`âŒ å‘ç°é”™è¯¯ï¼š${error.message}`, 'error');
            }
        }

        // æäº¤ä»£ç 
        function submitCode() {
            const code = document.getElementById('js-code').value;
            
            // ç»¼åˆéªŒè¯
            const requiredFeatures = [
                'addEventListener',
                'function',
                'console.log',
                'getElementById',
                'querySelectorAll'
            ];
            
            let featureCount = 0;
            requiredFeatures.forEach(feature => {
                if (code.includes(feature)) featureCount++;
            });

            if (featureCount >= 3 && progress >= 60) {
                progress = 100;
                updateUI();
                document.getElementById('completion-badge').style.display = 'block';
                
                // æ›´æ–°åœºæ™¯ï¼Œæ˜¾ç¤ºèƒœåˆ©
                const sceneContent = document.querySelector('.scene-content');
                sceneContent.innerHTML = `
                    <h3 style="color: #ffcc00;">ğŸ‰ æ­å–œï¼JavaScriptæ¸¯æ¢å¤ç§©åºï¼</h3>
                    <p>ä½ æˆåŠŸä¿®å¤äº†æ‰€æœ‰äº¤äº’åŠŸèƒ½ï¼Œæ¸¯å£æ¢å¤äº†æ­£å¸¸è¿è½¬ï¼</p>
                    <p>æ‰€æœ‰èˆªæ ‡å·²ç‚¹äº®ï¼</p>
                `;
                
                // æ›´æ–°è§’è‰²å®¹å™¨ï¼Œæ˜¾ç¤ºèƒœåˆ©åœºæ™¯
                const characterContainer = document.querySelector('.character-container');
                characterContainer.innerHTML = `
                    <div class="ship-body" style="filter: drop-shadow(0 0 15px #ffcc00);">â›µâœ¨</div>
                    <div class="beacon lit" style="filter: drop-shadow(0 0 15px #ffcc00);">ğŸ’¡ğŸŒŸ</div>
                `;
                
                showFeedback('ğŸ‰ æ­å–œï¼ä½ æˆåŠŸå®Œæˆäº†æ‰€æœ‰æŒ‘æˆ˜ï¼', 'success');
                
                setTimeout(() => {
                    alert('ğŸ‰ æ­å–œï¼ä½ æˆåŠŸå®Œæˆäº†æ‰€æœ‰å‰ç«¯å¼€å‘æŒ‘æˆ˜ï¼\nä½ å·²æˆä¸ºä¸€ååˆæ ¼çš„å‰ç«¯å¼€å‘è€…ï¼');
                    // è¿™é‡Œå¯ä»¥æ·»åŠ æ¸¸æˆå®Œæˆçš„é€»è¾‘
                }, 2000);
            } else {
                showFeedback(`è¿˜éœ€è¦å®Œå–„ä»£ç ï¼å½“å‰è¿›åº¦: ${progress}%\nç¡®ä¿å®ç°ä¸»è¦JavaScriptåŠŸèƒ½ã€‚`, 'error');
            }
        }

        // é‡ç½®ä»£ç 
        function resetCode() {
            if (confirm('ç¡®å®šè¦é‡ç½®JavaScriptä»£ç å—ï¼Ÿ')) {
                document.getElementById('js-code').value = `// JavaScriptæ¸¯äº¤äº’æŒ‘æˆ˜

// ä»»åŠ¡1: å®ç°ç‚¹å‡»äº‹ä»¶å¤„ç†
document.getElementById('interactive-demo').addEventListener('click', function() {
    // åœ¨è¿™é‡Œæ·»åŠ ç‚¹å‡»äº‹ä»¶çš„å¤„ç†ä»£ç 
});

// ä»»åŠ¡2: å®ç°é¼ æ ‡æ‚¬åœäº‹ä»¶
document.getElementById('interactive-demo').addEventListener('mouseover', function() {
    // åœ¨è¿™é‡Œæ·»åŠ é¼ æ ‡æ‚¬åœäº‹ä»¶çš„å¤„ç†ä»£ç 
});

document.getElementById('interactive-demo').addEventListener('mouseout', function() {
    // åœ¨è¿™é‡Œæ·»åŠ é¼ æ ‡ç¦»å¼€äº‹ä»¶çš„å¤„ç†ä»£ç 
});

// ä»»åŠ¡3: ä½¿ç”¨æ•°ç»„æ–¹æ³•
const items = ['å®å‰‘', 'è¯æ°´', 'é‡‘å¸', 'åœ°å›¾', 'é’¥åŒ™'];

// ä½¿ç”¨æ•°ç»„æ–¹æ³•å¤„ç†ç‰©å“
function processItems() {
    // åœ¨è¿™é‡Œæ·»åŠ æ•°ç»„æ–¹æ³•çš„ä»£ç 
}

// ä»»åŠ¡4: åŠ¨æ€å†…å®¹æ›´æ–°
function updateContent() {
    // åœ¨è¿™é‡Œæ·»åŠ åŠ¨æ€æ›´æ–°å†…å®¹çš„ä»£ç 
}

// ä»»åŠ¡5: è¡¨å•éªŒè¯å‡½æ•°
function validateForm() {
    // åœ¨è¿™é‡Œæ·»åŠ è¡¨å•éªŒè¯çš„ä»£ç 
}

// åˆå§‹åŒ–å‡½æ•°
function initJS() {
    // åœ¨è¿™é‡Œæ·»åŠ åˆå§‹åŒ–ä»£ç 
}`;
                progress = 0;
                updateUI();
                executeJSCode();
                document.querySelector('.scene-content').innerHTML = `
                    <h3>æ¬¢è¿æ¥åˆ°JavaScriptæ¸¯ï¼</h3>
                    <p>æ¸¯å£çš„äº¤äº’ç³»ç»Ÿå‡ºç°äº†æ•…éšœï¼ä½¿ç”¨JavaScriptä¿®å¤åŠŸèƒ½é—®é¢˜...</p>
                `;
                
                // é‡ç½®æ§åˆ¶å°
                document.getElementById('console-output').innerHTML = '> æ§åˆ¶å°è¾“å‡ºåŒºåŸŸ<br>> ç­‰å¾…JavaScriptä»£ç æ‰§è¡Œ...';
                
                // é‡ç½®è§’è‰²å®¹å™¨
                const characterContainer = document.querySelector('.character-container');
                characterContainer.innerHTML = `
                    <div class="ship-body">â›µ</div>
                    <div class="beacon" id="main-beacon">ğŸ’¡</div>
                `;
                
                // ç†„ç­èˆªæ ‡
                dimBeacon('main-beacon');
                
                showFeedback('ä»£ç å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°å¼€å§‹æŒ‘æˆ˜ï¼', 'success');
            }
        }

        // æ˜¾ç¤ºåé¦ˆæ¶ˆæ¯
        function showFeedback(message, type) {
            // åˆ›å»ºæˆ–è·å–åé¦ˆå…ƒç´ 
            let feedback = document.getElementById('action-feedback');
            if (!feedback) {
                feedback = document.createElement('div');
                feedback.id = 'action-feedback';
                feedback.className = 'feedback-message';
                document.querySelector('.controls').parentNode.insertBefore(feedback, document.querySelector('.controls'));
            }
            
            feedback.textContent = message;
            feedback.className = 'feedback-message';
            feedback.classList.add(type === 'success' ? 'feedback-success' : 'feedback-error');
            feedback.style.display = 'block';
            
            setTimeout(() => {
                feedback.style.display = 'none';
            }, 3000);
        }

        // èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜å˜é‡
        let beaconStatus = 40; // åˆå§‹å€¼è®¾ä¸º40%
        let beaconWave = 0;
        let beaconTimer;
        let isBeaconActive = false;
        let beaconCurrentScript;
        
        // æ”»å‡»è„šæœ¬å®šä¹‰
        const attackScripts = [
            // ç¬¬ä¸€æ³¢ï¼šæ— æ•ˆäº‹ä»¶ç»‘å®š
            {
                code: `// ç¬¬ä¸€æ³¢æ”»å‡»ï¼šæ— æ•ˆäº‹ä»¶ç»‘å®š
document.getElementById("wrong-btn").addEventListener("click", function() {
    console.log("æŒ‰é’®è¢«ç‚¹å‡»");
});`,
                isThreat: true,
                threatType: "æ— æ•ˆäº‹ä»¶ç»‘å®š",
                description: "å°è¯•ç»‘å®šåˆ°ä¸å­˜åœ¨çš„å…ƒç´ "
            },
            {
                code: `// ç¬¬ä¸€æ³¢æ”»å‡»ï¼šæ­£ç¡®äº‹ä»¶ç»‘å®š
document.getElementById("interactive-demo").addEventListener("click", function() {
    this.style.backgroundColor = "#ff6600";
});`,
                isThreat: false,
                threatType: "æ­£ç¡®äº‹ä»¶ç»‘å®š",
                description: "æ­£ç¡®çš„äº‹ä»¶ç»‘å®šä»£ç "
            },
            // ç¬¬äºŒæ³¢ï¼šé”™è¯¯æ•°æ®å¤„ç†
            {
                code: `// ç¬¬äºŒæ³¢æ”»å‡»ï¼šé”™è¯¯æ•°æ®å¤„ç†
const numbers = [1, 2, 3, 4, 5];
for (let i = 0; i < numbers.length; i++) {
    numbers[i] = numbers[i] * 2;
}`,
                isThreat: true,
                threatType: "é”™è¯¯æ•°æ®å¤„ç†",
                description: "ä½¿ç”¨forå¾ªç¯è€Œéæ•°ç»„æ–¹æ³•"
            },
            {
                code: `// ç¬¬äºŒæ³¢æ”»å‡»ï¼šæ­£ç¡®æ•°æ®å¤„ç†
const numbers = [1, 2, 3, 4, 5];
const doubled = numbers.map(num => num * 2);`,
                isThreat: false,
                threatType: "æ­£ç¡®æ•°æ®å¤„ç†",
                description: "ä½¿ç”¨mapæ–¹æ³•å¤„ç†æ•°ç»„"
            },
            // ç¬¬ä¸‰æ³¢ï¼šé¢‘ç¹DOMæ“ä½œ
            {
                code: `// ç¬¬ä¸‰æ³¢æ”»å‡»ï¼šé¢‘ç¹DOMæ“ä½œ
const container = document.getElementById("container");
for (let i = 0; i < 10; i++) {
    container.innerHTML += "<div>é¡¹ç›® " + i + "</div>";
}`,
                isThreat: true,
                threatType: "é¢‘ç¹DOMæ“ä½œ",
                description: "åœ¨å¾ªç¯ä¸­é¢‘ç¹æ“ä½œinnerHTML"
            },
            {
                code: `// ç¬¬ä¸‰æ³¢æ”»å‡»ï¼šæ­£ç¡®DOMæ“ä½œ
const container = document.getElementById("container");
const items = [];
for (let i = 0; i < 10; i++) {
    items.push("<div>é¡¹ç›® " + i + "</div>");
}
container.innerHTML = items.join("");`,
                isThreat: false,
                threatType: "æ­£ç¡®DOMæ“ä½œ",
                description: "æ‰¹é‡æ›´æ–°innerHTML"
            }
        ];
        
        // åˆå§‹åŒ–èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜
        function initBeaconBattle() {
            document.getElementById('start-beacon-defense').addEventListener('click', startBeaconDefense);
            document.getElementById('beacon-show-guide').addEventListener('click', showBeaconGuide);
            document.getElementById('beacon-restart-defense').addEventListener('click', restartBeaconDefense);
            document.getElementById('beacon-fix-btn').addEventListener('click', () => handleBeaconDefenseAction(true));
            document.getElementById('beacon-ignore-btn').addEventListener('click', () => handleBeaconDefenseAction(false));
            
            // åˆå§‹åŒ–èˆªæ ‡æ˜¾ç¤º
            updateBeaconUI();
        }
        
        // å¼€å§‹èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜
        function startBeaconDefense() {
            beaconStatus = 100;
            beaconWave = 0;
            updateBeaconUI();
            
            document.getElementById('start-beacon-defense').style.display = 'none';
            document.getElementById('beacon-restart-defense').style.display = 'none';
            document.getElementById('beacon-show-guide').style.display = 'none';
            document.getElementById('beacon-defense-result').style.display = 'none';
            
            // é‡ç½®å°èˆ¹åŠ¨ç”»
            const shipAnimation = document.getElementById('ship-animation');
            shipAnimation.className = 'ship-animation ship-success';
            shipAnimation.textContent = 'â›µ';
            
            startNextBeaconWave();
        }
        
        // å¼€å§‹ä¸‹ä¸€æ³¢èˆªæ ‡æ”»å‡»
        function startNextBeaconWave() {
            beaconWave++;
            updateBeaconWaveIndicator();
            
            if (beaconWave > 3) {
                endBeaconDefense();
                return;
            }
            
            // éšæœºé€‰æ‹©å½“å‰æ³¢çš„æ”»å‡»è„šæœ¬
            const waveScripts = attackScripts.filter(script => {
                if (beaconWave === 1) return script.threatType.includes("äº‹ä»¶ç»‘å®š");
                if (beaconWave === 2) return script.threatType.includes("æ•°æ®å¤„ç†");
                if (beaconWave === 3) return script.threatType.includes("DOMæ“ä½œ");
                return false;
            });
            
            beaconCurrentScript = waveScripts[Math.floor(Math.random() * waveScripts.length)];
            displayBeaconScript(beaconCurrentScript);
            
            // å¼€å§‹å€’è®¡æ—¶
            startBeaconTimer();
        }
        
        // æ˜¾ç¤ºèˆªæ ‡æ”»å‡»
        function displayBeaconScript(script) {
            const scriptAttack = document.getElementById('beacon-script-attack');
            const scriptContent = document.getElementById('beacon-script-content');
            
            scriptContent.innerHTML = script.code;
            scriptAttack.classList.add('active');
            
            // å¦‚æœæ˜¯å¨èƒï¼Œæ·»åŠ å¨èƒæ ‡è®°
            if (script.isThreat) {
                scriptContent.innerHTML = script.code.replace(
                    script.threatType, 
                    `<span class="script-threat">${script.threatType}</span>`
                );
            }
        }
        
        // å¼€å§‹èˆªæ ‡è®¡æ—¶å™¨
        function startBeaconTimer() {
            isBeaconActive = true;
            let beaconTimerValue = 5;
            updateBeaconTimerDisplay(beaconTimerValue);
            
            beaconTimer = setInterval(() => {
                beaconTimerValue--;
                updateBeaconTimerDisplay(beaconTimerValue);
                
                if (beaconTimerValue <= 0) {
                    clearInterval(beaconTimer);
                    handleBeaconTimeout();
                }
            }, 1000);
        }
        
        // å¤„ç†èˆªæ ‡é˜²å¾¡åŠ¨ä½œ
        function handleBeaconDefenseAction(isFix) {
            if (!isBeaconActive) return;
            
            clearInterval(beaconTimer);
            isBeaconActive = false;
            
            const isCorrect = (isFix && beaconCurrentScript.isThreat) || (!isFix && !beaconCurrentScript.isThreat);
            
            if (isCorrect) {
                // æ­£ç¡®æ“ä½œ
                if (beaconCurrentScript.isThreat) {
                    showBeaconResult("æˆåŠŸä¿®å¤å¨èƒï¼èˆªæ ‡çŠ¶æ€ä¿æŒä¸å˜", "defense-success");
                } else {
                    showBeaconResult("æ­£ç¡®ä¿ç•™ä»£ç ï¼èˆªæ ‡çŠ¶æ€ä¿æŒä¸å˜", "defense-success");
                }
            } else {
                // é”™è¯¯æ“ä½œ
                beaconStatus -= 20;
                updateBeaconUI();
                
                if (beaconCurrentScript.isThreat) {
                    showBeaconResult(`é”™è¯¯ï¼æ”¾è¿‡å¨èƒï¼š${beaconCurrentScript.description}ï¼Œèˆªæ ‡çŠ¶æ€-20%`, "defense-failure");
                } else {
                    showBeaconResult(`é”™è¯¯ï¼è¯¯åˆ æ­£ç¡®ä»£ç ï¼š${beaconCurrentScript.description}ï¼Œèˆªæ ‡çŠ¶æ€-20%`, "defense-failure");
                }
            }
            
            // å»¶è¿Ÿåè¿›å…¥ä¸‹ä¸€æ³¢
            setTimeout(() => {
                document.getElementById('beacon-script-attack').classList.remove('active');
                document.getElementById('beacon-defense-result').style.display = 'none';
                startNextBeaconWave();
            }, 2000);
        }
        
        // å¤„ç†èˆªæ ‡è¶…æ—¶
        function handleBeaconTimeout() {
            isBeaconActive = false;
            
            if (beaconCurrentScript.isThreat) {
                beaconStatus -= 20;
                updateBeaconUI();
                showBeaconResult(`è¶…æ—¶ï¼æ”¾è¿‡å¨èƒï¼š${beaconCurrentScript.description}ï¼Œèˆªæ ‡çŠ¶æ€-20%`, "defense-failure");
            } else {
                showBeaconResult("è¶…æ—¶ï¼æ­£ç¡®ä»£ç æœªå—å½±å“", "defense-success");
            }
            
            // å»¶è¿Ÿåè¿›å…¥ä¸‹ä¸€æ³¢
            setTimeout(() => {
                document.getElementById('beacon-script-attack').classList.remove('active');
                document.getElementById('beacon-defense-result').style.display = 'none';
                startNextBeaconWave();
            }, 2000);
        }
        
        // ç»“æŸèˆªæ ‡ç‚¹äº®æŒ‘æˆ˜
        function endBeaconDefense() {
            document.getElementById('start-beacon-defense').style.display = 'none';
            document.getElementById('beacon-restart-defense').style.display = 'inline-block';
            document.getElementById('beacon-show-guide').style.display = 'inline-block';
            
            if (beaconStatus >= 80) {
                showBeaconResult("ğŸ‰ ç‚¹äº®æˆåŠŸï¼å°èˆ¹å®‰å…¨æ¸¡å²¸ï¼", "defense-success");
                
                // ç‚¹äº®æ‰€æœ‰èˆªæ ‡
                for (let i = 1; i <= 5; i++) {
                    lightBeacon(`beacon-${i}`);
                }
                
                // ç‚¹äº®HTMLåœºæ™¯çš„èˆªæ ‡
                lightBeacon('html-beacon');
                
                // æ’­æ”¾å°èˆ¹æˆåŠŸåŠ¨ç”»
                playShipSuccessAnimation();
                
                // æ›´æ–°éªŒè¯é¢æ¿
                updateValidationPanel(true);
            } else {
                showBeaconResult(`ğŸ’” ç‚¹äº®å¤±è´¥ï¼èˆªæ ‡çŠ¶æ€ä»…å‰©${beaconStatus}%ï¼Œå°èˆ¹æ²‰æ²¡ï¼`, "defense-failure");
                
                // ç†„ç­æ‰€æœ‰èˆªæ ‡
                for (let i = 1; i <= 5; i++) {
                    dimBeacon(`beacon-${i}`);
                }
                
                // æ’­æ”¾å°èˆ¹å¤±è´¥åŠ¨ç”»
                playShipFailureAnimation();
            }
        }
        
        // æ’­æ”¾å°èˆ¹æˆåŠŸåŠ¨ç”»
        function playShipSuccessAnimation() {
            const shipAnimation = document.getElementById('ship-animation');
            
            // æ·»åŠ æˆåŠŸé—ªçƒæ•ˆæœ
            createSuccessSparkles();
            
            // å°èˆ¹ç§»åŠ¨åŠ¨ç”»
            setTimeout(() => {
                shipAnimation.classList.remove('ship-success');
                shipAnimation.classList.add('ship-crossing');
                
                // æ·»åŠ èƒœåˆ©ç‰¹æ•ˆ
                setTimeout(() => {
                    shipAnimation.textContent = 'â›µâœ¨';
                    shipAnimation.style.filter = 'drop-shadow(0 0 15px #ffcc00)';
                }, 1000);
            }, 500);
        }
        
        // æ’­æ”¾å°èˆ¹å¤±è´¥åŠ¨ç”»
        function playShipFailureAnimation() {
            const shipAnimation = document.getElementById('ship-animation');
            
            // å°èˆ¹çˆ†ç‚¸åŠ¨ç”»
            shipAnimation.classList.add('ship-explosion');
            shipAnimation.textContent = 'ğŸ’¥';
            
            // çˆ†ç‚¸åå˜æˆæ°´
            setTimeout(() => {
                shipAnimation.classList.remove('ship-explosion');
                shipAnimation.classList.add('ship-sunk');
                shipAnimation.textContent = 'ğŸ’§';
            }, 500);
        }
        
        // åˆ›å»ºæˆåŠŸé—ªçƒæ•ˆæœ
        function createSuccessSparkles() {
            const animationArea = document.querySelector('.ship-animation-area');
            const sparklesContainer = document.createElement('div');
            sparklesContainer.className = 'success-sparkles';
            animationArea.appendChild(sparklesContainer);
            
            for (let i = 0; i < 20; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                sparklesContainer.appendChild(sparkle);
            }
            
            // æ¸…ç†é—ªçƒæ•ˆæœ
            setTimeout(() => {
                sparklesContainer.remove();
            }, 3000);
        }
        
        // é‡æ–°å¼€å§‹èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜
        function restartBeaconDefense() {
            document.getElementById('beacon-defense-result').style.display = 'none';
            startBeaconDefense();
        }
        
        // æ˜¾ç¤ºèˆªæ ‡å¸®åŠ©
        function showBeaconGuide() {
            const guide = document.createElement('div');
            guide.className = 'defense-guide';
            guide.innerHTML = `
                <div class="guide-title">ğŸ’¡ ç‚¹äº®æŒ‡å—</div>
                <div class="guide-rule">äº‹ä»¶ç›‘å¬ï¼šä¼˜å…ˆä½¿ç”¨ addEventListener</div>
                <div class="guide-rule">æ•°æ®å¤„ç†ï¼šå–„ç”¨ map/filter/reduce</div>
                <div class="guide-rule">åŠ¨æ€æ›´æ–°ï¼šé¿å…é¢‘ç¹æ“ä½œ innerHTML</div>
                <div class="guide-rule">è¡¨å•éªŒè¯ï¼šå®æ—¶æ ¡éªŒ + é”™è¯¯æç¤º</div>
                <div class="guide-rule">åŠ¨ç”»ä¼˜åŒ–ï¼šä½¿ç”¨ requestAnimationFrame æˆ– transition</div>
            `;
            
            // å¦‚æœå·²ç»å­˜åœ¨æŒ‡å—ï¼Œåˆ™ç§»é™¤
            const existingGuide = document.querySelector('#html-task .defense-guide');
            if (existingGuide) {
                existingGuide.remove();
            }
            
            document.querySelector('#html-task .defense-challenge').appendChild(guide);
            guide.style.display = 'block';
        }
        
        // æ›´æ–°èˆªæ ‡ç‚¹äº®æŒ‘æˆ˜UI
        function updateBeaconUI() {
            document.getElementById('beacon-status').textContent = `${beaconStatus}%`;
            document.getElementById('beacon-fill').style.width = `${beaconStatus}%`;
            document.querySelector('.beacon-status').textContent = `${beaconStatus}%`;
            
            // æ ¹æ®èˆªæ ‡çŠ¶æ€æ”¹å˜é¢œè‰²
            const beaconBar = document.getElementById('beacon-fill');
            if (beaconStatus >= 80) {
                beaconBar.style.background = 'linear-gradient(90deg, #aaffaa, #88ff88)';
            } else if (beaconStatus >= 50) {
                beaconBar.style.background = 'linear-gradient(90deg, #ffcc00, #ff9900)';
            } else {
                beaconBar.style.background = 'linear-gradient(90deg, #ff6600, #ff3300)';
            }
            
            // æ›´æ–°èˆªæ ‡ç‚¹äº®çŠ¶æ€
            const litCount = Math.floor(beaconStatus / 20);
            for (let i = 1; i <= 5; i++) {
                const beacon = document.getElementById(`beacon-${i}`);
                if (i <= litCount) {
                    beacon.classList.add('lit');
                } else {
                    beacon.classList.remove('lit');
                }
            }
        }
        
        // æ›´æ–°èˆªæ ‡æ³¢æ¬¡æŒ‡ç¤ºå™¨
        function updateBeaconWaveIndicator() {
            for (let i = 1; i <= 3; i++) {
                const dot = document.getElementById(`beacon-wave-${i}`);
                if (i <= beaconWave) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            }
        }
        
        // æ›´æ–°èˆªæ ‡è®¡æ—¶å™¨æ˜¾ç¤º
        function updateBeaconTimerDisplay(value) {
            document.getElementById('beacon-timer').textContent = value;
        }
        
        // æ˜¾ç¤ºèˆªæ ‡ç‚¹äº®æŒ‘æˆ˜ç»“æœ
        function showBeaconResult(message, className) {
            const result = document.getElementById('beacon-defense-result');
            result.textContent = message;
            result.className = `defense-result ${className}`;
            result.style.display = 'block';
        }
        
        // éªŒè¯é¢æ¿å¸®åŠ©ç³»ç»Ÿ
        function getValidationHelp(level) {
            if (goldCoins < level) {
                alert('é‡‘å¸ä¸è¶³ï¼è¯·å®Œæˆæ›´å¤šä»»åŠ¡æ¥è·å–é‡‘å¸ã€‚');
                return;
            }

            goldCoins -= level;
            updateUI();

            let helpMessage = '';

            switch(level) {
                case 1:
                    helpMessage = "åˆ é™¤æŒ‡å¯¼ï¼š\n- åˆ é™¤æ— æ•ˆçš„äº‹ä»¶ç»‘å®š\n- åˆ é™¤é”™è¯¯çš„DOMæ“ä½œ\n- åˆ é™¤ä¸åˆé€‚çš„æ•°ç»„å¤„ç†æ–¹æ³•";
                    break;
                case 2:
                    helpMessage = "é˜²å¾¡æŒ‡å¯¼ï¼š\n- ä¼˜å…ˆä½¿ç”¨addEventListener\n- å–„ç”¨map/filter/reduce\n- é¿å…é¢‘ç¹æ“ä½œinnerHTML\n- å®ç°å®æ—¶è¡¨å•éªŒè¯\n- ä½¿ç”¨requestAnimationFrameä¼˜åŒ–åŠ¨ç”»";
                    break;
                case 3:
                    helpMessage = "é‡ç½®ä»£ç ï¼š\nå°†é‡ç½®æ‰€æœ‰é˜²å¾¡æŒ‘æˆ˜è¿›åº¦";
                    restartBeaconDefense();
                    break;
            }

            alert(helpMessage);
        }
        
        // æ›´æ–°éªŒè¯é¢æ¿
        function updateValidationPanel(isSuccess) {
            const checks = ['check-event', 'check-data', 'check-dom', 'check-form', 'check-animation'];
            
            checks.forEach(checkId => {
                const check = document.getElementById(checkId);
                check.textContent = isSuccess ? 'âœ“' : 'âœ—';
                check.className = `validation-check ${isSuccess ? 'valid' : 'invalid'}`;
            });
        }

        // é€‰é¡¹å¡åŠŸèƒ½ - ä¿®æ”¹ä»¥æ”¯æŒåœºæ™¯åˆ‡æ¢
        function initTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    const sceneId = button.getAttribute('data-scene');
                    
                    // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                    
                    // æ·»åŠ å½“å‰æ´»åŠ¨çŠ¶æ€
                    button.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                    
                    // åˆ‡æ¢åœºæ™¯
                    if (sceneId) {
                        // éšè—æ‰€æœ‰åœºæ™¯
                        document.querySelectorAll('.scene-js, .scene-html').forEach(scene => {
                            scene.style.display = 'none';
                        });
                        
                        // æ˜¾ç¤ºå¯¹åº”åœºæ™¯
                        document.getElementById(sceneId).style.display = 'block';
                    }
                });
            });
        }

        // åˆå§‹åŒ–
        function init() {
            updateUI();
            executeJSCode();
            createSparkles();
            initBeaconBattle();
            initTabs();
            
            // æ·»åŠ ä»£ç æ›´æ”¹ç›‘å¬
            document.getElementById('js-code').addEventListener('input', function() {
                executeJSCode();
            });
            
            // æ˜¾ç¤ºæ–°æ‰‹æŒ‡å¯¼
            setTimeout(() => {
                showTutorial();
            }, 500);
        }

        // å¯åŠ¨æ¸¸æˆ
        init();
    </script>
</body>
</html>